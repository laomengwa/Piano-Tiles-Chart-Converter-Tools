<!DOCTYPE html>
<html oncontextmenu="return false" ; onselectstart="return false" id="esc" ondrop="drop(event)" ondragover="allowDrop(event)">

<head>
	<meta charset="utf-8" name="viewport"
		content="width=device-width,initial-scale=1,maximum-scale=1.0,minimum-scale=1,user-scalable=no">

	<title>钢琴块谱面转换器</title>

</head>

<body style="text-align:center;cursor:default;width:100%;overflow:hidden;" class="container" id="bodyid">
	<progress class="progress" id="progress" value="0" max="100" onclick="progressoff()"></progress>
	<b class="progress1" id="progress3" onclick="progressoff()">已完成 <b id="progress1">0</b> %，用时 <b id="progress2">0</b>
		秒。</b>
	<div class="top">
		<button onclick="menu()" id="id16" class="button3" tabindex="-1">
			☰
		</button>
		<b id="title">谱面转换器 0.2.3-Dev (<b id="detectos"></b>,<b id="explorer"></b>)</b>
		<button class="button10" onclick="next()" id="id22" tabindex="-1">
			▶
		</button>
	</div>
	<div class="mute"></div>
	<div class="slidemute" id="id3" onclick="menu()"></div>
	<div class="slide" style="overflow-y:auto" id="id1">
		<div class="diva" style="text-align:left">
			<div class="logo">
				<h1 style="text-align:center;color:#000000">钢琴块谱面转换</h1>
			</div>
			<div class="divb" tabindex="-1" id="move1">
				BPM
				<textarea onkeydown="if(event.keyCode==13){return false;}" class="button8" tabindex="-1" id="bpm"
					autofocus="autofocus" placeholder="格式：“120;120,120,120,“" onclick="lock();fb1=1;"></textarea>
			</div>
			<div class="divb" onkeydown="if(event.keyCode==13){return false;}" tabindex="-1" id="move2">
				基础节拍
				<textarea class="button6" tabindex="-1" id="beats" autofocus="autofocus" placeholder="格式：“0.5;0.5;0.5;“"
					onclick="lock();fb1=2;"></textarea>
			</div>
			<div class="divb" onkeydown="if(event.keyCode==13){return false;}" tabindex="-1" id="move3">加速度<textarea
					autofocus="autofocus" class="button7" id="acc" tabindex="-1" onclick="lock();fb1=3;"></textarea>
			</div>
			<div class="divb" tabindex="-1" id="move4">
				请选择游戏
				<select id="games" class="button2" tabindex="-1" onchange="key_select()">

					<option value="mak" class="button2">
						Malody Key

					</option>

					<option value="mas" class="button1">
						Malody Slide

					</option>

					<option value="om" class="button2">
						osu!mania

					</option>

				</select>

			</div>

			<div class="divb" tabindex="-1" id="move5">

				轨道数量

				<select id="key" class="button2" tabindex="-1">
				</select>
			</div>
			<div class="divb" tabindex="-1" id="move6">
				<div class='checkbox'>
					<input type="checkbox" id="continue" tabindex="-1">
					<label for='continue'>纵连</label>
				</div>
			</div>
			<div class="divb" tabindex="-1" id="move7">
				<div class='checkbox'>
					<input type="checkbox" id="manual" tabindex="-1">
					<label for='manual'>手动填写BPM和基础节拍</label>
				</div>
			</div>
			<div class="divb" onclick="note()" style="cursor:pointer" tabindex="-1" id="move8">
				音符按键玩法设置
			</div>
			<a class="divb" id="move9" target="_blank" href="https://space.bilibili.com/46345895"
				tabindex="-1">程序有BUG？反馈</a>
			<div class="divb" id="move10" style="cursor:pointer" onclick="about()" tabindex="-1">关于</div>
			<div class="divb" style="cursor:pointer" id="isFull" onclick="isFull()" tabindex="-1">全屏</div>
			<div style="text-align:left;cursor:pointer" id="move11" class="divb" onclick="id0()" tabindex="-1">语言设置
			</div>
			<a class="divb" tabindex="-1" id="move12" style="text-align:left;" target="_blank"
				href="https://github.com/laomengwa/mengwa113">皮肤下载</a>
			<p style="text-align:center;cursor:default"><span style="color:#fff;">喵喵喵(=・ω・=)</span></p>
		</div>
	</div>
	<p>
		<input class="button1" type="file" id="file" tabindex="-1" accept=".json,.mid,.midi,.kar,.sty,.krx,.rmi">

		<button class="button1" onclick="Function2()" id="id20" tabindex="-1">转换</button>

	</p>

	<textarea onkeydown="if(event.keyCode==13){return false;}" class="button" rows="10" cols="30" id="input"
		onclick="lock();fa1=1;fc1=2;" placeholder="选择文件转换后以显示……" tabindex="-1"></textarea>

	<textarea onkeydown="if(event.keyCode==13){return false;}" class="button" rows="10" cols="30" id="result"
		onclick="lock();fa1=2;fd1=2;" placeholder="输出结果将在此显示……" tabindex="-1"></textarea>

	<p>
	<div class="warning_5"><b id="warning_sound">♮正常</b></div>
	<button class="button1" onclick="next()" id="id21" tabindex="-1">下一步操作</button>
	</p>
	<noscript>
		<strong style="color:red">
			警告：此浏览器不支持JavaScript，该脚本无法运行！请检查当前浏览器是否启用JavaScript，然后重试！
		</strong>
	</noscript>
	<div class="mask" id='mask' style="opacity: 0.5;"></div>
	<div class="box1" id='note' style="left: 10%; top: 10%;">
		<div class="icon">⚙</div>
		<div class="icon1"><b>音符按键玩法设置</b></div>
		<div class="boxoff" id="boxoff1" onclick="hidder()" tabindex="-1">×</div>
		<div class="mute1"></div>
		<div class="container1" style="text-align: left;overflow-y:auto;">
			<p style="color:#555">设置游戏玩法的启用方式：</p>
			<div class='checkbox'>
				<input type="checkbox" id="note1" checked="checked" tabindex="-1"><label for='note1'>长按（代号：6）</label>
			</div>
			<div class='checkbox'>
				<input type="checkbox" id="note2" checked="checked" tabindex="-1"><label for='note2'>双黑（代号：5）</label>
			</div>
			<div class='checkbox'>
				<input type="checkbox" id="note3" checked="checked" tabindex="-1"><label for='note3'>滑动（代号：8）</label>
			</div>
			<div class='checkbox'>
				<input type="checkbox" id="note4" checked="checked" tabindex="-1"><label for='note4'>滑动（代号：7）</label>
			</div>
			<div class='checkbox'>
				<input type="checkbox" id="note5" checked="checked" tabindex="-1"><label for='note5'>长按+黑块（代号：9）</label>
			</div>
			<div class='checkbox'>
				<input type="checkbox" id="note6" checked="checked" tabindex="-1"><label
					for='note6'>双长按+橙色块/黑块（代号：10）</label>
			</div>
			<div class='checkbox'>
				<input type="checkbox" id="note7" checked="checked" tabindex="-1"><label for='note7'>橙色块（代号：3）</label>
			</div>
			<div class="icon2">⚙</div>
			<div class="icon3">Malody Slide 模式的音符宽度</div><br>
			<p><textarea onkeydown="if(event.keyCode==13){return false;}" class="button9" tabindex="-1" id="notewidth"
					autofocus="autofocus" placeholder="格式例如：“64-128“" onclick="lock();fh1=8;">64</textarea></p>
			<p>
			<div class='checkbox'>
				<input type="checkbox" id="sound" checked="checked" tabindex="-1"><label for='sound'>启用音符音频输出</label>
			</div>
			<br>
			<div class='checkbox'>
				<input type="checkbox" id="reverse" tabindex="-1"><label for='reverse'>歌曲逆向播放</label>
			</div>
			<button class="button1" id="soundup" onclick="soundup()" tabindex="-1">升调</button>
			<button class="button1" id="sounddown" onclick="sounddown()" tabindex="-1">降调</button>
			<b id="soundshow">正常</b><br>
			输出的音量大小<input tabindex="-1" id="vol" class="vol" type="range" min="0" max="100" value="100"
				oninput="vol2()"><b id="volshow"></b>
			<br>
			<div class='checkbox'>
				<input type="checkbox" id="note8" tabindex="-1"><label for='note8'>双黑音符位置随机摆放</label>
			</div>
			<div class='checkbox'>
				<input type="checkbox" id="note9" tabindex="-1"><label for='note9'>取消双黑楼梯式摆放</label>
			</div>
			<p style="color:#555">
				注：代号为8的玩法在原游戏中为折叠滑块，仅对 Malody Slide 模式有效；代号为10的玩法在原游戏为爆裂块；代号为7的玩法在原游戏为单向斜滑块，在非 Malody Slide
				模式下为长按玩法；代号为3的玩法在原游戏中为狂戳块，仅对 Malody Slide 模式有效。注意，对游戏无效的音符玩法一律不启用。<br>
			<div class="button4" id="ok1" onclick="hidder()" style="text-align: center;" tabindex="-1">确定</div>
		</div>
	</div>
	<div class="box" id='lang' style="left: 20%; top: 25%;">
		<div class="icon">⚙</div>
		<div class="icon1"><b>语言设置</b></div>
		<div class="boxoff" id="boxoff3" onclick="hidder()" tabindex="-1">×</div>
		<div class="mute1"></div>
		<div class="container1" style="text-align: left;overflow-y:auto;">
			<p style="color:#555">请选择：</p>
			<div id="zh_cn" class="button5" onclick="zh_tran('s')" style="text-align: left;" tabindex="-1">🇨🇳简体中文
			</div>
			<div id="zh_tw" class="button5" onclick="zh_tran('t')"
				style="text-align: left;border-radius: 5px 5px 0px 0px;" tabindex="-1">🇨🇳繁體中文</div>
		</div>
		<div class="button4" id="ok3" onclick="hidder()" style="text-align: center;" tabindex="-1">确定</div>
	</div>
	<div class="box" id='select' style="left: 20%; top: 25%">
		<div class="icon">?</div>
		<div class="icon1"><b>小程序歌曲选择</b></div>
		<div class="boxoff" id="boxoff4" onclick="hidder()" tabindex="-1">×</div>
		<div class="mute1"></div>
		<div class="container1" style="text-align: left;overflow-y:auto;height:1200%">
			<p style="color:#555">选择你想转换的歌曲（选择完毕后关闭窗口即可）：</p>
			<div id="songselect"></div>
		</div>
		<div class="button4" onclick="hidder()" style="text-align: center;" tabindex="-1" id="boxoff6">关闭</div>
	</div>
	<div class="box" id='next' style="left: 20%; top: 25%">
		<div class="icon">⚙</div>
		<div class="icon1"><b>下一步的操作</b></div>
		<div class="boxoff" id="boxoff5" onclick="hidder()">×</div>
		<div class="mute1"></div>
		<div class="container1" style="text-align: left;overflow-y:auto;border-radius: 0%;">
			<p style="color:#555"><b>来完善歌曲的信息（也可以不用全部填写）：</b></p>
			<p style="color:#555">歌曲名：<textarea onkeydown="if(event.keyCode==13){return false;}" class="button9"
					id="notewidth" autofocus="autofocus" placeholder="请输入："></textarea></p>
			<p style="color:#555">标题原文：<textarea onkeydown="if(event.keyCode==13){return false;}" class="button9"
					id="notewidth" autofocus="autofocus" placeholder="请输入："></textarea></p>
			<p style="color:#555">艺术家：<textarea onkeydown="if(event.keyCode==13){return false;}" class="button9"
					id="notewidth" autofocus="autofocus" placeholder="请输入："></textarea></p>
			<p style="color:#555">艺术家原文：<textarea onkeydown="if(event.keyCode==13){return false;}" class="button9"
					id="notewidth" autofocus="autofocus" placeholder="请输入："></textarea></p>
			<p style="color:#555">谱面作者：<textarea onkeydown="if(event.keyCode==13){return false;}" class="button9"
					id="notewidth" autofocus="autofocus" placeholder="请输入："></textarea></p>
			<p style="color:#555">谱面版本/难度：<textarea onkeydown="if(event.keyCode==13){return false;}" class="button9"
					id="notewidth" autofocus="autofocus" placeholder="请输入："></textarea></p>
			<p style="color:#555">osu!歌曲标签：<textarea onkeydown="if(event.keyCode==13){return false;}" class="button9"
					id="notewidth" autofocus="autofocus" placeholder="请输入："></textarea></p>
			<p style="color:#555">背景图片：<textarea onkeydown="if(event.keyCode==13){return false;}" class="button9"
				id="notewidth" autofocus="autofocus" placeholder="输入图片文件名就行，非必填："></textarea></p>
			<p style="color:#555">背景音乐：<textarea onkeydown="if(event.keyCode==13){return false;}" class="button9"
				id="notewidth" autofocus="autofocus" placeholder="输入音频文件名就行，非必填："></textarea></p>
		</div>
		<div class="button12" id="ok5" onclick="hidder();setTimeout(function(){view_window();},100);"
			style="text-align: center;">谱面预览</div>
		<div class="button11" id="ok5" onclick="outputfile()" style="text-align: center;">导出</div>
	</div>
	<div class="box" id='view_window' style="left: 20%; top: 25%" ondblclick="window_max();";>
		<div class="icon">⚙</div>
		<div class="icon1"><b>谱面预览</b></div>
		<div class="boxmax" id="boxmax2" onclick="window_max();">□</div>
		<div class="boxoff" id="boxoff5" onclick="hidder()">×</div>
		<div class="mute1"></div>
		<div class="container1" style="text-align: left;overflow-y:auto;border-radius: 0%;">
			<div id="view" style="width: 256px;height:456px;border:1px solid #555;"></div>
		</div>
	</div>
	<div class="box" id='box' style="left: 20%; top: 25%;">
		<div class="icon">?</div>
		<div class="icon1"><b>关于</b></div>
		<div class="boxoff" id="boxoff2" onclick="hidder()" tabindex="-1">×</div>
		<div class="mute1"></div>
		<div class="container1" style="text-align:left;overflow-y:auto;cursor:default;color:#555">
			<p>
				该脚本可使 Piano Tiles 的音乐曲谱文件转换成其他音乐游戏可以读取的曲谱格式。<br />脚本适用的音乐游戏有： OSU!Mania,Malody<br />感谢 Runoob 网站、CSDN
				网站、W3School 网站以及Mozilla MDN 文档对该脚本的页面布局作为参考。<br />小提示：你可以通过鼠标拖动窗口，通过手势控制菜单栏的展开。<br />Script Version:
				0.2.3 (Dev)<br />Copyright by mengwa.<br />
				<b>浏览器属性信息：</b><b id=explore></b>
			</p>
			<noscript>
				<strong style="color:red">
					警告：此浏览器不支持JavaScript，该脚本无法运行！请检查当前浏览器是否启用JavaScript，然后重试！
				</strong>
			</noscript>
			<div class="button4" id="ok2" onclick="hidder()" tabindex="-1" style="text-align: center;">确定</div>
		</div>
	</div>
	<div class="warning" id="warning"
		onclick="document.getElementById('warning').style.animation='warning_2 0.1s';document.getElementById('warning').style.width='0%';document.getElementById('warning').style.height='0px';document.getElementById('warning').style.left='50%';warning.innerHTML = '';warnoff();fk1=false;">
	</div>
</body>

</html>
<style>
	.button {
		resize: none;
		background-color: #f4f5f7;
		border: 1px solid #e9eaec;
		font: 14px -apple-system, BlinkMacSystemFont, Helvetica Neue, Helvetica, Arial, PingFang SC, Hiragino Sans GB, Microsoft YaHei, sans-serif;
		overflow: auto;
		border-radius: 4px;
		color: #555;
		padding: 5px 10px;
		font-size: 12px;
	}

	.button8 {
		resize: none;
		background-color: #f4f5f7;
		border: 1px solid #e9eaec;
		font: 14px -apple-system, BlinkMacSystemFont, Helvetica Neue, Helvetica, Arial, PingFang SC, Hiragino Sans GB, Microsoft YaHei, sans-serif;
		overflow: auto;
		border-radius: 4px;
		color: #555;
		padding: 5px 10px;
		font-size: 12px;
		height: 12px;
		width: 160px;
	}

	.button9 {
		resize: none;
		background-color: #ddd;
		border: 2px solid #999;
		font: 14px -apple-system, BlinkMacSystemFont, Helvetica Neue, Helvetica, Arial, PingFang SC, Hiragino Sans GB, Microsoft YaHei, sans-serif;
		overflow: auto;
		border-radius: 4px;
		color: #555;
		padding: 5px 10px;
		font-size: 12px;
		height: 12px;
	}

	.button6 {
		resize: none;
		background-color: #f4f5f7;
		border: 1px solid #e9eaec;
		font: 14px -apple-system, BlinkMacSystemFont, Helvetica Neue, Helvetica, Arial, PingFang SC, Hiragino Sans GB, Microsoft YaHei, sans-serif;
		overflow: auto;
		border-radius: 4px;
		color: #555;
		padding: 5px 10px;
		font-size: 12px;
		height: 12px;
		width: 134px;
	}

	.button7 {
		resize: none;
		background-color: #f4f5f7;
		border: 1px solid #e9eaec;
		font: 14px -apple-system, BlinkMacSystemFont, Helvetica Neue, Helvetica, Arial, PingFang SC, Hiragino Sans GB, Microsoft YaHei, sans-serif;
		overflow: auto;
		border-radius: 4px;
		color: #555;
		padding: 5px 10px;
		font-size: 12px;
		height: 12px;
		width: 152px;
	}

	.button1 {
		resize: none;
		background-color: #FB7299;
		border: 1px solid #e9eaec;
		font: 14px -apple-system, BlinkMacSystemFont, Helvetica Neue, Helvetica, Arial, PingFang SC, Hiragino Sans GB, Microsoft YaHei, sans-serif;
		overflow: auto;
		border-radius: 4px;
		color: #fff;
		padding: 5px 10px;
		font-size: 12px;
		cursor: pointer;
	}

	.button2 {
		resize: none;
		background-color: #00a1d6;
		border: 1px solid #e9eaec;
		font: 14px -apple-system, BlinkMacSystemFont, Helvetica Neue, Helvetica, Arial, PingFang SC, Hiragino Sans GB, Microsoft YaHei, sans-serif;
		overflow: auto;
		border-radius: 4px;
		color: #fff;
		padding: 5px 10px;
		font-size: 12px;
		cursor: pointer;
	}

	.container {
		background: #76b9f8;
		font: 14px -apple-system, BlinkMacSystemFont, Helvetica Neue, Helvetica, Arial, PingFang SC, Hiragino Sans GB, Microsoft YaHei, sans-serif;
	}

	.button3 {
		overflow: hidden;
		resize: none;
		background-color: #FB7299;
		border: 1px solid #ffffff;
		font: 14px -apple-system, BlinkMacSystemFont, Helvetica Neue, Helvetica, Arial, PingFang SC, Hiragino Sans GB, Microsoft YaHei, sans-serif;
		border-radius: 4px;
		color: #fff;
		padding: 5px 10px;
		font-size: 32px;
		cursor: pointer;
		width: 50px;
		height: 50px;
	}

	.button3:hover {
		background-color: #72fbbb;
	}

	.button10 {
		overflow: hidden;
		position: absolute;
		resize: none;
		background-color: #FB7299;
		border: 1px solid #ffffff;
		font: 14px -apple-system, BlinkMacSystemFont, Helvetica Neue, Helvetica, Arial, PingFang SC, Hiragino Sans GB, Microsoft YaHei, sans-serif;
		right: 0px;
		top: 0px;
		border-radius: 4px;
		color: #fff;
		padding: 5px 10px;
		font-size: 25px;
		cursor: pointer;
		width: 50px;
		height: 50px;
	}

	.button10:hover {
		background-color: #72fbbb;
	}

	.top {
		text-align: left;
		background: #FB7299;
		top: 0;
		position: fixed;
		right: 0;
		left: 0;
	}

	.slide {
		position: fixed;
		left: -250px;
		width: 250px;
		height: 100%;
		background: #ffffff;
	}

	.slidemute {
		position: fixed;
		left: 250px;
		width: 0px;
		height: 100%;
		transition: width 0s;
	}

	@keyframes board_1 {
		0% {
			left: -250px;
			top: 50px;
		}

		100% {
			left: 0px;
			top: 50px;
		}
	}

	@keyframes board_0 {
		0% {
			left: 0px;
			top: 50px;
		}

		100% {
			left: -250px;
			top: 50px;
		}
	}

	.mute {
		width: 0px;
		height: 42px;
	}

	.mute1 {
		width: 60%;
		height: 31px;
	}

	.diva {
		list-style-type: none;
		margin: 0;
		padding: 0;
	}

	.divb {
		display: block;
		color: #000;
		padding: 8px 16px;
		text-decoration: none;
		border-radius: 5px;
		border-bottom: 1px solid #fff;
		border-top: 1px solid #fff;
		background-color: #66ccff;
	}

	.logo {
		display: block;
		color: #000;
		padding: 8px 16px;
		text-decoration: none;
		border-radius: 5px;
		border-bottom: 1px solid #fff;
		border-top: 1px solid #fff;
		background-color: #FB7299;
	}

	.divb:hover {
		background-color: #aaddff;
		color: #FB7299;
	}

	.box {
		position: absolute;
		background: #fff;
		border-radius: 5px 5px 0px 0px;
		border-bottom: 1px solid #aaa;
	}

	.box1 {
		position: absolute;
		background: #fff;
		border-radius: 5px 5px 0px 0px;
		border-bottom: 1px solid #aaa;
	}

	@keyframes board_3 {
		0% {
			width: 0%;
			left: 50%;
			top: 50%;
		}

		100% {
			width: 60%;
			left: 20%;
			top: 25%;
		}
	}

	@keyframes board_4 {
		0% {
			width: 60%;
			left: 20%;
			top: 25%;
		}

		100% {
			width: 0%;
			left: 50%;
			top: 50%;
		}
	}

	@keyframes board_5 {
		0% {
			width: 0%;
			left: 50%;
			top: 50%;
		}

		100% {
			width: 80%;
			left: 10%;
			top: 25%;
		}
	}

	@keyframes board_6 {
		0% {
			width: 80%;
			left: 10%;
			top: 25%;
		}

		100% {
			width: 0%;
			left: 50%;
			top: 50%;
		}
	}

	.mask {
		position: fixed;
		left: 0px;
		top: 0px;
		background: #000;
		width: 100%;
		height: 100%;
	}

	.container1 {
		background-color: #fff;
		width: 100%;
		height: auto;
		border-radius: 0px 0px 5px 5px;
		color: #555;
		cursor: default;
	}

	.boxoff {
		position: absolute;
		width: 40px;
		height: 30px;
		border-radius: 0px 5px 0px 0px;
		background: #fff;
		color: #555;
		right: 0px;
		top: 0px;
		text-align: center;
		font-size: 25px;
		cursor: pointer;
	}

	.boxmax {
		position: absolute;
		width: 40px;
		height: 30px;
		background: #fff;
		color: #555;
		right: 40px;
		top: 0px;
		text-align: center;
		font-size: 25px;
		cursor: pointer;
	}

	.boxmax1 {
		position: absolute;
		right: 10px;
		top: -2px;
		z-index: 0;
	}

	.button4 {
		background-color: #fff;
		border-top: 1px solid #aaa;
		overflow: auto;
		border-radius: 0px 0px 5px 5px;
		color: #555;
		padding: 5px 10px;
		font-size: 16px;
		height: 26px;
		cursor: pointer;
	}

	.button4:hover {
		background-color: #FB7299;
		color: #fff;
	}

	.button11 {
		position: absolute;
		background-color: #fff;
		border-top: 1px solid #aaa;
		border-left: 1px solid #aaa;
		border-radius: 0px 0px 5px 0px;
		color: #555;
		padding: 5px 10px;
		font-size: 16px;
		height: 26px;
		width: 50%;
		right: 0%;
		cursor: pointer;
	}

	.button11:hover {
		background-color: #FB7299;
		color: #fff;
	}

	.button12 {
		position: absolute;
		background-color: #fff;
		border-top: 1px solid #aaa;
		border-radius: 0px 0px 0px 5px;
		color: #555;
		padding: 5px 10px;
		font-size: 16px;
		height: 26px;
		width: 50%;
		left: 0%;
		z-index: 1;
		cursor: pointer;
	}

	.button12:hover {
		background-color: #FB7299;
		color: #fff;
	}

	.button5 {
		background-color: #fff;
		border-top: 1px solid #aaa;
		border-left: 1px solid #aaa;
		border-right: 1px solid #aaa;
		border-radius: 5px;
		color: #555;
		font-size: 16px;
		height: 30px;
		cursor: pointer;
	}

	.button5:hover {
		background-color: #76b9f8;
		color: #fff;
	}

	.boxoff:hover {
		background-color: #FB7299;
		color: #fff;
	}

	.boxmax:hover {
		background-color: #00a1d6;
		color: #fff;
	}

	.icon {
		position: absolute;
		width: 20px;
		height: 20px;
		border-radius: 50px;
		background: #76b9f8;
		color: #fff;
		left: 5px;
		top: 5px;
		text-align: center;
		font-size: 18px;
	}

	.icon1 {
		position: absolute;
		color: #555;
		left: 27px;
		top: 3px;
		text-align: center;
		font-size: 15px;
	}

	.icon2 {
		position: absolute;
		width: 17px;
		height: 17px;
		border-radius: 2px;
		background: #00a1d6;
		color: #fff;
		left: 3px;
		top: 240px;
		border: 2px solid #555;
		text-align: center;
		font-size: 18px;
	}

	.icon3 {
		position: absolute;
		color: #555;
		left: 27px;
		top: 240px;
		text-align: center;
		font-size: 15px;
	}

	.checkbox {
		position: relative;
		height: 24px;
	}

	.checkbox input[type='checkbox'] {
		position: absolute;
		left: 0;
		top: 0;
		width: 20px;
		height: 20px;
	}

	.checkbox label {
		position: absolute;
		left: 30px;
		top: 0;
		height: 20px;
		line-height: 20px;
	}

	.checkbox label:before {
		content: '';
		position: absolute;
		left: -26px;
		top: 3px;
		width: 16px;
		height: 16px;
		border: 2px solid #555;
		border-radius: 2px;
		transition: all 0.1s ease;
		-webkit-transition: all 0.1s ease;
		-moz-transition: all 0.1s ease;
	}

	.checkbox label:after {
		content: '';
		position: absolute;
		left: -20px;
		top: 6px;
		width: 5px;
		height: 10px;
		border: 0;
		transform: rotate(45deg);
		-webkit-transform: rotate(45deg);
		-moz-transform: rotate(45deg);
		-ms-transform: rotate(45deg);
		transition: all 0.1s ease;
		-webkit-transition: all 0.1s ease;
		-moz-transition: all 0.1s ease;
	}

	.checkbox input[type='checkbox']:checked+label:before {
		background: #FB7299;
		border: 2px solid #555;
	}

	.checkbox input[type='checkbox']:checked+label:after {
		background: #FB7299;
		border-right: 3px solid #fff;
		border-bottom: 3px solid #fff;
	}

	.warning {
		display: none;
		position: absolute;
		background-color: #fffd;
		border-radius: 5px;
		color: #555;
		padding: 5px 10px;
		left: 50%;
		bottom: 10%;
		width: 0%;
		height: 0px;
	}

	.warning_5 {
		position: absolute;
		background-color: #fffd;
		border-radius: 5px;
		color: #555;
		padding: 5px 10px;
		z-index: -1;
		width: 50px;
		right: 50%;
		margin-right: 50px;
		height: 16px;
	}

	@keyframes warning_1 {
		0% {
			width: 0%;
			height: 0px;
			left: 50%;
		}

		100% {
			width: 60%;
			height: auto;
			left: 20%;
		}
	}

	@keyframes warning_2 {
		0% {
			width: 60%;
			height: auto;
			left: 20%;
		}

		100% {
			width: 0%;
			height: 0px;
			left: 50%;
		}
	}

	@keyframes warning_3 {
		0% {
			width: 60%;
			height: 20px;
			left: 20%;
		}

		100% {
			width: 0%;
			height: 0px;
			left: 50%;
		}
	}

	@keyframes warning_4 {
		0% {
			width: 0%;
			height: 0px;
			left: 50%;
		}

		100% {
			width: 60%;
			height: 20px;
			left: 20%;
		}
	}

	.vol[type="range"] {
		height: 5px;
		border-radius: 3px;
		position: relative;
		-webkit-appearance: none !important;
		outline: none;
		border: 1px solid #ddd;
	}

	.vol[type=range]::-webkit-slider-thumb {
		-webkit-appearance: none;
		width: 10px;
		height: 20px;
		border-radius: 3px;
		background: #fb7299;
	}

	.vol[type=range]::-moz-range-thumb {
		-webkit-appearance: none;
		width: 10px;
		height: 20px;
		border-radius: 3px;
		background: #fb7299;
	}

	.progress {
		position: absolute;
		display: none;
		border-radius: 5px;
		width: 60%;
		bottom: 20%;
		left: 20%;
		height: 20px;
		border: 2px solid #555;
	}

	.progress1 {
		position: absolute;
		display: none;
		text-align: center;
		bottom: 20%;
		margin-left: -5%;
		font-size: 14px;
		color: #000;
	}

	/*针对chrome浏览器*/
	.progress::-webkit-progress-bar {
		border-radius: 5px;
		background-color: #fff;
	}

	.progress::-webkit-progress-value {
		border-radius: 5px;
		background-color: #fb7299;
	}

	/*针对firefox浏览器*/
	.progress::-moz-progress-bar {
		border-radius: 5px;
		background-color: #fb7299;
	}
</style>
<script>
	function allowDrop(ev) {
          ev.preventDefault();
        }
    function drop(ev) {
          ev.preventDefault();
          document.getElementById("file").files=ev.dataTransfer.files;
        }
	// 简繁转换脚本来自于：https://www.cnblogs.com/zsh-blogs/p/10503227.html
	var zh_default = 'n';
	var zh_choose = 'n';
	var zh_expires = 7;
	var zh_class = 'zh_click';
	var zh_style_active = 'font-weight:bold; color:green;';
	var zh_style_inactive = 'color:blue;';
	var zh_browserLang = '';
	var zh_langReg_t = /^zh-tw|zh-hk$/i;
	var zh_langReg_s = /^zh-cn$/i;
	var zh_s = '确于将号皑蔼碍爱翱袄奥坝罢摆败颁办绊帮绑镑谤剥饱宝报鲍辈贝钡狈备惫绷笔毕毙闭边编贬变辩辫鳖瘪濒滨宾摈饼拨钵铂驳卜补参蚕残惭惨灿苍舱仓沧厕侧册测层诧搀掺蝉馋谗缠铲产阐颤场尝长偿肠厂畅钞车彻尘陈衬撑称惩诚骋痴迟驰耻齿炽冲虫宠畴踌筹绸丑橱厨锄雏础储触处传疮闯创锤纯绰辞词赐聪葱囱从丛凑窜错达带贷担单郸掸胆惮诞弹当挡党荡档捣岛祷导盗灯邓敌涤递缔点垫电淀钓调迭谍叠钉顶锭订东动栋冻斗犊独读赌镀锻断缎兑队对吨顿钝夺鹅额讹恶饿儿尔饵贰发罚阀珐矾钒烦范贩饭访纺飞废费纷坟奋愤粪丰枫锋风疯冯缝讽凤肤辐抚辅赋复负讣妇缚该钙盖干赶秆赣冈刚钢纲岗皋镐搁鸽阁铬个给龚宫巩贡钩沟构购够蛊顾剐关观馆惯贯广规硅归龟闺轨诡柜贵刽辊滚锅国过骇韩汉阂鹤贺横轰鸿红后壶护沪户哗华画划话怀坏欢环还缓换唤痪焕涣黄谎挥辉毁贿秽会烩汇讳诲绘荤浑伙获货祸击机积饥讥鸡绩缉极辑级挤几蓟剂济计记际继纪夹荚颊贾钾价驾歼监坚笺间艰缄茧检碱硷拣捡简俭减荐槛鉴践贱见键舰剑饯渐溅涧浆蒋桨奖讲酱胶浇骄娇搅铰矫侥脚饺缴绞轿较秸阶节茎惊经颈静镜径痉竞净纠厩旧驹举据锯惧剧鹃绢杰洁结诫届紧锦仅谨进晋烬尽劲荆觉决诀绝钧军骏开凯颗壳课垦恳抠库裤夸块侩宽矿旷况亏岿窥馈溃扩阔蜡腊莱来赖蓝栏拦篮阑兰澜谰揽览懒缆烂滥捞劳涝乐镭垒类泪篱离里鲤礼丽厉励砾历沥隶俩联莲连镰怜涟帘敛脸链恋炼练粮凉两辆谅疗辽镣猎临邻鳞凛赁龄铃凌灵岭领馏刘龙聋咙笼垄拢陇楼娄搂篓芦卢颅庐炉掳卤虏鲁赂禄录陆驴吕铝侣屡缕虑滤绿峦挛孪滦乱抡轮伦仑沦纶论萝罗逻锣箩骡骆络妈玛码蚂马骂吗买麦卖迈脉瞒馒蛮满谩猫锚铆贸么霉没镁门闷们锰梦谜弥觅绵缅庙灭悯闽鸣铭谬谋亩钠纳难挠脑恼闹馁腻撵捻酿鸟聂啮镊镍柠狞宁拧泞钮纽脓浓农疟诺欧鸥殴呕沤盘庞国爱赔喷鹏骗飘频贫苹凭评泼颇扑铺朴谱脐齐骑岂启气弃讫牵扦钎铅迁签谦钱钳潜浅谴堑枪呛墙蔷强抢锹桥乔侨翘窍窃钦亲轻氢倾顷请庆琼穷趋区躯驱龋颧权劝却鹊让饶扰绕热韧认纫荣绒软锐闰润洒萨鳃赛伞丧骚扫涩杀纱筛晒闪陕赡缮伤赏烧绍赊摄慑设绅审婶肾渗声绳胜圣师狮湿诗尸时蚀实识驶势释饰视试寿兽枢输书赎属术树竖数帅双谁税顺说硕烁丝饲耸怂颂讼诵擞苏诉肃虽绥岁孙损笋缩琐锁獭挞抬摊贪瘫滩坛谭谈叹汤烫涛绦腾誊锑题体屉条贴铁厅听烃铜统头图涂团颓蜕脱鸵驮驼椭洼袜弯湾顽万网韦违围为潍维苇伟伪纬谓卫温闻纹稳问瓮挝蜗涡窝呜钨乌诬无芜吴坞雾务误锡牺袭习铣戏细虾辖峡侠狭厦锨鲜纤咸贤衔闲显险现献县馅羡宪线厢镶乡详响项萧销晓啸蝎协挟携胁谐写泻谢锌衅兴汹锈绣虚嘘须许绪续轩悬选癣绚学勋询寻驯训讯逊压鸦鸭哑亚讶阉烟盐严颜阎艳厌砚彦谚验鸯杨扬疡阳痒养样瑶摇尧遥窑谣药爷页业叶医铱颐遗仪彝蚁艺亿忆义诣议谊译异绎荫阴银饮樱婴鹰应缨莹萤营荧蝇颖哟拥佣痈踊咏涌优忧邮铀犹游诱舆鱼渔娱与屿语吁御狱誉预驭鸳渊辕园员圆缘远愿约跃钥岳粤悦阅云郧匀陨运蕴酝晕韵杂灾载攒暂赞赃脏凿枣灶责择则泽贼赠扎札轧铡闸诈斋债毡盏斩辗崭栈战绽张涨帐账胀赵蛰辙锗这贞针侦诊镇阵挣睁狰帧郑证织职执纸挚掷帜质钟终种肿众诌轴皱昼骤猪诸诛烛瞩嘱贮铸筑驻专砖转赚桩庄装妆壮状锥赘坠缀谆浊兹资渍踪综总纵邹诅组钻致钟么为只凶准启板里雳余链泄';
	var zh_t = '確於將號皚藹礙愛翺襖奧壩罷擺敗頒辦絆幫綁鎊謗剝飽寶報鮑輩貝鋇狽備憊繃筆畢斃閉邊編貶變辯辮鼈癟瀕濱賓擯餅撥缽鉑駁蔔補參蠶殘慚慘燦蒼艙倉滄廁側冊測層詫攙摻蟬饞讒纏鏟産闡顫場嘗長償腸廠暢鈔車徹塵陳襯撐稱懲誠騁癡遲馳恥齒熾沖蟲寵疇躊籌綢醜櫥廚鋤雛礎儲觸處傳瘡闖創錘純綽辭詞賜聰蔥囪從叢湊竄錯達帶貸擔單鄲撣膽憚誕彈當擋黨蕩檔搗島禱導盜燈鄧敵滌遞締點墊電澱釣調叠諜疊釘頂錠訂東動棟凍鬥犢獨讀賭鍍鍛斷緞兌隊對噸頓鈍奪鵝額訛惡餓兒爾餌貳發罰閥琺礬釩煩範販飯訪紡飛廢費紛墳奮憤糞豐楓鋒風瘋馮縫諷鳳膚輻撫輔賦複負訃婦縛該鈣蓋幹趕稈贛岡剛鋼綱崗臯鎬擱鴿閣鉻個給龔宮鞏貢鈎溝構購夠蠱顧剮關觀館慣貫廣規矽歸龜閨軌詭櫃貴劊輥滾鍋國過駭韓漢閡鶴賀橫轟鴻紅後壺護滬戶嘩華畫劃話懷壞歡環還緩換喚瘓煥渙黃謊揮輝毀賄穢會燴彙諱誨繪葷渾夥獲貨禍擊機積饑譏雞績緝極輯級擠幾薊劑濟計記際繼紀夾莢頰賈鉀價駕殲監堅箋間艱緘繭檢堿鹼揀撿簡儉減薦檻鑒踐賤見鍵艦劍餞漸濺澗漿蔣槳獎講醬膠澆驕嬌攪鉸矯僥腳餃繳絞轎較稭階節莖驚經頸靜鏡徑痙競淨糾廄舊駒舉據鋸懼劇鵑絹傑潔結誡屆緊錦僅謹進晉燼盡勁荊覺決訣絕鈞軍駿開凱顆殼課墾懇摳庫褲誇塊儈寬礦曠況虧巋窺饋潰擴闊蠟臘萊來賴藍欄攔籃闌蘭瀾讕攬覽懶纜爛濫撈勞澇樂鐳壘類淚籬離裏鯉禮麗厲勵礫曆瀝隸倆聯蓮連鐮憐漣簾斂臉鏈戀煉練糧涼兩輛諒療遼鐐獵臨鄰鱗凜賃齡鈴淩靈嶺領餾劉龍聾嚨籠壟攏隴樓婁摟簍蘆盧顱廬爐擄鹵虜魯賂祿錄陸驢呂鋁侶屢縷慮濾綠巒攣孿灤亂掄輪倫侖淪綸論蘿羅邏鑼籮騾駱絡媽瑪碼螞馬罵嗎買麥賣邁脈瞞饅蠻滿謾貓錨鉚貿麽黴沒鎂門悶們錳夢謎彌覓綿緬廟滅憫閩鳴銘謬謀畝鈉納難撓腦惱鬧餒膩攆撚釀鳥聶齧鑷鎳檸獰甯擰濘鈕紐膿濃農瘧諾歐鷗毆嘔漚盤龐國愛賠噴鵬騙飄頻貧蘋憑評潑頗撲鋪樸譜臍齊騎豈啓氣棄訖牽扡釺鉛遷簽謙錢鉗潛淺譴塹槍嗆牆薔強搶鍬橋喬僑翹竅竊欽親輕氫傾頃請慶瓊窮趨區軀驅齲顴權勸卻鵲讓饒擾繞熱韌認紉榮絨軟銳閏潤灑薩鰓賽傘喪騷掃澀殺紗篩曬閃陝贍繕傷賞燒紹賒攝懾設紳審嬸腎滲聲繩勝聖師獅濕詩屍時蝕實識駛勢釋飾視試壽獸樞輸書贖屬術樹豎數帥雙誰稅順說碩爍絲飼聳慫頌訟誦擻蘇訴肅雖綏歲孫損筍縮瑣鎖獺撻擡攤貪癱灘壇譚談歎湯燙濤縧騰謄銻題體屜條貼鐵廳聽烴銅統頭圖塗團頹蛻脫鴕馱駝橢窪襪彎灣頑萬網韋違圍為濰維葦偉僞緯謂衛溫聞紋穩問甕撾蝸渦窩嗚鎢烏誣無蕪吳塢霧務誤錫犧襲習銑戲細蝦轄峽俠狹廈鍁鮮纖鹹賢銜閑顯險現獻縣餡羨憲線廂鑲鄉詳響項蕭銷曉嘯蠍協挾攜脅諧寫瀉謝鋅釁興洶鏽繡虛噓須許緒續軒懸選癬絢學勳詢尋馴訓訊遜壓鴉鴨啞亞訝閹煙鹽嚴顔閻豔厭硯彥諺驗鴦楊揚瘍陽癢養樣瑤搖堯遙窯謠藥爺頁業葉醫銥頤遺儀彜蟻藝億憶義詣議誼譯異繹蔭陰銀飲櫻嬰鷹應纓瑩螢營熒蠅穎喲擁傭癰踴詠湧優憂郵鈾猶遊誘輿魚漁娛與嶼語籲禦獄譽預馭鴛淵轅園員圓緣遠願約躍鑰嶽粵悅閱雲鄖勻隕運蘊醞暈韻雜災載攢暫贊贓髒鑿棗竈責擇則澤賊贈紮劄軋鍘閘詐齋債氈盞斬輾嶄棧戰綻張漲帳賬脹趙蟄轍鍺這貞針偵診鎮陣掙睜猙幀鄭證織職執紙摯擲幟質鍾終種腫衆謅軸皺晝驟豬諸誅燭矚囑貯鑄築駐專磚轉賺樁莊裝妝壯狀錐贅墜綴諄濁茲資漬蹤綜總縱鄒詛組鑽緻鐘麼為隻兇準啟闆裡靂餘鍊洩';
	String.prototype.tran = function () {
		var s1, s2;
		if (zh_choose == 't') {
			s1 = zh_s;
			s2 = zh_t;
			document.getElementById("input").setAttribute("placeholder", "選擇文件轉換後以顯示……");
			document.getElementById("result").setAttribute("placeholder", "輸出結果將在此顯示……");
		} else if (zh_choose == 's') {
			s1 = zh_t;
			s2 = zh_s;
			document.getElementById("input").setAttribute("placeholder", "选择文件转换后以显示……");
			document.getElementById("result").setAttribute("placeholder", "输出结果将在此显示……");
		} else {
			return this;
		}
		var a = '';
		var l = this.length;
		for (var i = 0; i < this.length; i++) {
			var c = this.charAt(i);
			var p = s1.indexOf(c)
			a += p < 0 ? c : s2.charAt(p);
		}
		return a;
	}
	function setCookie(name, value) {
		var argv = setCookie.arguments;
		var argc = setCookie.arguments.length;
		var expires = (argc > 2) ? argv[2] : null;
		if (expires != null) {
			var LargeExpDate = new Date();
			LargeExpDate.setTime(LargeExpDate.getTime() + (expires * 1000 * 3600 * 24));
		}
		document.cookie = name + "=" + escape(value) + ((expires == null) ? "" : ("; expires=" + LargeExpDate.toGMTString()));
	}
	function getCookie(Name) {
		var search = Name + "="
		if (document.cookie.length > 0) {
			offset = document.cookie.indexOf(search);
			if (offset != -1) {
				offset += search.length;
				end = document.cookie.indexOf(";", offset);
				if (end == -1) end = document.cookie.length;
				return unescape(document.cookie.substring(offset, end));
			} else {
				return '';
			}
		}
	}
	function zh_tranBody(obj) {
		var o = (typeof (obj) == "object") ? obj.childNodes : document.body.childNodes;
		for (var i = 0; i < o.length; i++) {
			var c = o.item(i);
			if ('||BR|HR|TEXTAREA|SCRIPT|'.indexOf("|" + c.tagName + "|") > 0) continue;
			if (c.className == zh_class) {
				if (c.id == zh_class + '_' + zh_choose) {
					c.setAttribute('style', zh_style_active);
					c.style.cssText = zh_style_active;
				} else {
					c.setAttribute('style', zh_style_inactive);
					c.style.cssText = zh_style_inactive;
				}
				continue;
			}
			if (c.title != '' && c.title != null) c.title = c.title.tran();
			if (c.alt != '' && c.alt != null) c.alt = c.alt.tran();
			if (c.nodeType == 3) {
				c.data = c.data.tran();
			} else {
				zh_tranBody(c);
			}
		}
	}
	function zh_tran(go) {
		if (go) zh_choose = go;
		setCookie('zh_choose', zh_choose, zh_expires);
		if (go == 'n') {
			window.location.reload();
		} else {
			zh_tranBody();
		}
	}
	var userLang = navigator.language || navigator.userLanguage;
	if (userLang == "zh-TW" || userLang == "zh-HK" || userLang == "zh-MO") {
		zh_tran('t');
	}
	key_select();
	document.getElementById('id1').style.animation = 'board_0 0s';
	document.getElementById('mask').style.display = "none";
	document.getElementById('box').style.display = "none";
	document.getElementById('lang').style.display = "none";
	document.getElementById('note').style.display = "none";
	document.getElementById('select').style.display = "none";
	document.getElementById('next').style.display = "none";
	document.getElementById('view_window').style.display = "none";
	var id2 = 1;
	if (typeof FileReader == "undefined") {
		alert('警告！此浏览器不支持FileReader接口，请更新或使用 Chrome、Chromium、Firefox、Edge、Safari、Opera、Brave 等现代浏览器打开HTML文件！已禁用此浏览器访问此脚本！');
		document.location("about:blank");
		a.setAttribute("disabled", "disabled")
	}
	var clock = 0;
	var timerstart = false;
	//计时器
	function timer() {
		if (timerstart == true) {
			setTimeout(function () { timer(); clock++; progress2.innerHTML = clock / 10; }, 100);
		}
	}
	//小程序选择框的窗口光标选择器
	function fl2() {
		document.onkeydown = keyDownselect;
		var fl3 = 0;
		function keyDownselect() {
			if (event.keyCode == 38) {
				fl3 = fl3 - 1;
				if (fl3 < -1) {
					fl3 = -1;
				}
				if (fl3 == -1) {
					document.getElementById("boxoff4").focus();
					document.getElementById('boxoff4').style.backgroundColor = "#FB7299";
					document.getElementById('boxoff4').style.color = "#fff";
					document.getElementById("select_song_0").style.backgroundColor = "#fff";
					document.getElementById("select_song_0").style.color = "#555";
				} else {
					document.getElementById("select_song_" + fl3).focus();
					document.getElementById("select_song_" + fl3).style.backgroundColor = "#76b9f8";
					document.getElementById("select_song_" + fl3).style.color = "#fff";
					if (fl3 != songselect2 - 1) {
						document.getElementById("select_song_" + (fl3 + 1)).style.backgroundColor = "#fff";
						document.getElementById("select_song_" + (fl3 + 1)).style.color = "#555";
					} else {
						document.getElementById('boxoff6').style.backgroundColor = "#fff";
						document.getElementById('boxoff6').style.color = "#555";
						document.getElementById("select_song_" + fl3).style.backgroundColor = "#76b9f8";
						document.getElementById("select_song_" + fl3).style.color = "#fff";
					}
					document.getElementById("boxoff4").style.backgroundColor = "#fff";
					document.getElementById("boxoff4").style.color = "#555";
					if (fl3 != 0) {
						document.getElementById("select_song_" + (fl3 - 1)).style.backgroundColor = "#fff";
						document.getElementById("select_song_" + (fl3 - 1)).style.color = "#555";
					}
				}
			}
			if (event.keyCode == 40) {
				fl3 = fl3 + 1;
				if (fl3 > songselect2) {
					fl3 = songselect2;
				}
				document.getElementById("boxoff4").style.backgroundColor = "#fff";
				document.getElementById("boxoff4").style.color = "#555";
				if (fl3 != songselect2) {
					document.getElementById("select_song_" + fl3).focus();
					document.getElementById("select_song_" + fl3).style.backgroundColor = "#76b9f8";
					document.getElementById("select_song_" + fl3).style.color = "#fff";
				} else {
					document.getElementById("boxoff6").focus();
					document.getElementById("select_song_" + (songselect2 - 1)).style.backgroundColor = "#fff";
					document.getElementById("select_song_" + (songselect2 - 1)).style.color = "#555";
					document.getElementById('boxoff6').style.backgroundColor = "#FB7299";
					document.getElementById('boxoff6').style.color = "#fff";
				}
				if (fl3 != 0) {
					document.getElementById("select_song_" + (fl3 - 1)).style.backgroundColor = "#fff";
					document.getElementById("select_song_" + (fl3 - 1)).style.color = "#555";
				}
			}
			if (event.keyCode == 13) {
				if (fl3 == -1 || fl3 == songselect2) {
					fl3 = -1;
					document.getElementById("boxoff4").style.backgroundColor = "#fff";
					document.getElementById("boxoff4").style.color = "#555";
					document.getElementById("boxoff6").style.backgroundColor = "#fff";
					document.getElementById("boxoff6").style.color = "#555";
					hidder();
				} else {
					file_f = file_i[fl3].content;
					file_j = file_f.baseBpm;
					file_f = file_f.musics;
					file_d = file_f.length;
					continue_music();
				}
			}
		}
	}
	//小程序歌曲选项
	function test1() {
		var o = document.createElement('div');
		o.className = "button5"
		o.tabIndex = "-1"
		o.id = "select_song_" + songselect2;
		o.innerHTML = file_i[songselect2].name;
		document.getElementById("songselect").appendChild(o);
		o.setAttribute("onclick", 'file_f=file_i[' + songselect2 + '].content;file_j=file_f.baseBpm;file_f=file_f.musics;file_d=file_f.length;continue_music();');
		o = null;
	}
	function continue_music() {
		var c = "", file_h = "", b = "";
		//主音轨读取
		for (file_d_a = 0; file_d_a < file_d; file_d_a++) {
			file_g = file_f[file_d_a].bpm + ",";
			file_h = file_h + file_g;
			file_k = file_f[file_d_a].baseBeats + ",";
			b = b + file_k;
			a = file_f[file_d_a].scores[0];
			a = a.toString();
			a_check = a.lastIndexOf("");
			//为没有逗号结尾的片段添加逗号
			a = a + ","
			while (a.indexOf(",,") > -1 || a.indexOf(";,") > -1 || a.indexOf(",;") > -1 || a.indexOf(";;") > -1) {
				a = a.replace(",,", ",");
				a = a.replace(",;", ",");
				a = a.replace(";,", ",");
				a = a.replace(";;", ",");
			}
			c = c + a + '`';
		}
		//自动填写BPM与基础节拍
		if (document.getElementById('manual').checked == false) {
			document.getElementById("beats").innerHTML = b;
			document.getElementById("bpm").innerHTML = file_j + ";" + file_h;
		}
		c = c.split('`');
		c.splice(c.length - 1, 1);
		c_a = c;
		var bpm_b = "", sound_num = "";
		for (file_d_a = 0; file_d_a < file_d; file_d_a++) {
			if (file_d_a == 0) {
				a = c[0];
				a_a = a;
				//获取BPM的位置
				startchange1();
				g = g_g;
				aa = g.lastIndexOf(",") + 1;
				ab = g.lastIndexOf("");
				ac = g.slice(aa, ab);
				bpm_a = ac;
			} else {
				a_a = a_a + c[file_d_a];
				a = a_a;
				startchange1();
				g = g_g;
				aa = g.lastIndexOf(",") + 1;
				ab = g.lastIndexOf("");
				ac = g.slice(aa, ab);
				bpm_a = ac;
			}
			sound_num_test = file_f[file_d_a].scores.length;
			sound_num = sound_num + "," + sound_num_test;
			bpm_b = bpm_b + "," + bpm_a;
		}
		//获取音轨数量
		sound_num = sound_num.replace(",", "");
		sound_num = sound_num.split(',');
		sound_num.sort();
		sound_num_1 = sound_num.length - 1;
		sound_num = sound_num[sound_num_1];
		sound_num = parseFloat(sound_num);
		bpm_b = bpm_b.replace(`,`, ``);
		bpm_b = bpm_b.split(',');
		a = a_a;
		filesound = a;
		startchange();
		a = c;
		var b = "", file_h = "";
		for (sound_num_1 = 1; sound_num_1 < sound_num; sound_num_1++) {
			for (file_d_a = 0; file_d_a < file_d; file_d_a++) {
				a = file_f[file_d_a].scores[sound_num_1];
				if (typeof (a) != "undefined") {
					a_check = a.lastIndexOf("");
					a = a + ","
				}
				b = b + a;
				var song_text = "";
				//发现音轨数量不齐时的调整（测试）
				if (b.indexOf("undefined") > -1) {
					bpm_c = parseFloat(bpm_b[file_d_a]);
					bpm_d = parseFloat(bpm_b[file_d_a - 1]);
					bpm_e = bpm_c - bpm_d;
					bpm_f = bpm_e / 256;
					bpm_h_a = parseInt(bpm_f);
					bpm_e = bpm_e - (256 * bpm_h_a);
					bpm_f = bpm_e / 128;
					bpm_i_a = parseInt(bpm_f);
					bpm_e = bpm_e - (128 * bpm_i_a);
					bpm_f = bpm_e / 64;
					bpm_j_a = parseInt(bpm_f);
					bpm_e = bpm_e - (64 * bpm_j_a);
					bpm_f = bpm_e / 32;
					bpm_k_a = parseInt(bpm_f);
					bpm_e = bpm_e - (32 * bpm_k_a);
					bpm_f = bpm_e / 16;
					bpm_l_a = parseInt(bpm_f);
					bpm_e = bpm_e - (16 * bpm_l_a);
					bpm_f = bpm_e / 8;
					bpm_m_a = parseInt(bpm_f);
					bpm_e = bpm_e - (8 * bpm_m_a);
					bpm_f = bpm_e / 4;
					bpm_n_a = parseInt(bpm_f);
					bpm_e = bpm_e - (128 * bpm_n_a);
					bpm_f = bpm_e / 2;
					bpm_o_a = parseInt(bpm_f);
					bpm_e = bpm_e - (2 * bpm_o_a);
					bpm_f = bpm_e / 1;
					bpm_p_a = parseInt(bpm_f);
					bpm_e = bpm_e - (1 * bpm_p_a);
					for (bpm_h = 0; bpm_h < bpm_h_a; bpm_h++) {
						song_text = song_text + "Q";
					}
					if (bpm_i_a == 1) {
						song_text = song_text + "R";
					}
					if (bpm_j_a == 1) {
						song_text = song_text + "S";
					}
					if (bpm_k_a == 1) {
						song_text = song_text + "T";
					}
					if (bpm_l_a == 1) {
						song_text = song_text + "U";
					}
					if (bpm_m_a == 1) {
						song_text = song_text + "V";
					}
					if (bpm_n_a == 1) {
						song_text = song_text + "W";
					}
					if (bpm_o_a == 1) {
						song_text = song_text + "X";
					}
					if (bpm_p_a == 1) {
						song_text = song_text + "Y";
					}
					b = b.replace("undefined", song_text + ",");
				}
			}
			while (b.indexOf(",,") > -1 || b.indexOf(";,") > -1 || b.indexOf(",;") > -1 || b.indexOf(";;") > -1) {
				b = b.replace(",,", ",");
				b = b.replace(",;", ",");
				b = b.replace(";,", ",");
				b = b.replace(";;", ",");
			}
			filesound = b;
			if (document.getElementById('sound').checked == true) {
				Function1();
				Function1_a();
                if ("undefined" == typeof file_f[0].alternatives) {
					alternatives = "0_0";
				} else {
					alternatives = file_f[0].alternatives[sound_num_1 - 1];
					if (file_f[0].alternatives[sound_num_1 - 1] == "piano" || file_f[0].alternatives[sound_num_1 - 1] == "") {
						alternatives = "0_0";
					}
				}
				a=a.replace(/midi_timbre_id/g,alternatives);
			} else {
				a = ""
			}
			games_type = games.value;
			if (games_type == "om") {
				ha5 = "[HitObjects]\n" + ha5 + "\n[Events]\n" + a;
                if ("undefined" == typeof file_f[0].alternatives) {
					alternatives = "0_0";
				} else {
					alternatives = file_f[0].alternatives[0];
					if (file_f[0].alternatives[sound_num_1 - 1] == "piano" || file_f[0].alternatives[sound_num_1 - 1] == "") {
						alternatives = "0_0";
					}
				}
				ha5 = ha5.replace(/midi_timbre_id/g, alternatives);
				j_a =j_a.replace(/midi_timbre_id/g, alternatives);
			} else {
				ha5 = ha5 + a;
			}
			b = "";
		}
		games_type = games.value;
		switch (games_type) {
			case "mak":
				document.getElementById("result").value = '{"meta":{"$ver":0,"creator":"creator_names","background":"background_names","version":"version_names","id":0,"mode":0,"time":'+Date.parse(new Date())+',"song":{"title":"song_names","artist":"artist_names","id":0},"mode_ext":{"column":'+key_num_a+',"bar_begin":0}},"time":[{"beat":[0,0,1],"bpm":'+parseFloat(document.getElementById("bpm").innerHTML)+'}],"effect":[],"note":['+ha5+'],"extra":{"test":{"divide":4,"speed":100,"save":0,"lock":0,"edit_mode":0}}}';
				break;
			case "mas":
				document.getElementById("result").value = '{"meta":{"$ver":0,"creator":"creator_names","background":"background_names","version":"version_names","id":0,"mode":7,"time":'+Date.parse(new Date())+',"song":{"title":"song_names","artist":"artist_names","id":0},"mode_ext":{}},"time":[{"beat":[0,0,1],"bpm":'+parseFloat(document.getElementById("bpm").innerHTML)+'}],"effect":[],"note":['+ha5+'],"extra":{"test":{"divide":4,"speed":100,"save":0,"lock":0,"edit_mode":0}}}';
				break;		
			case "om":
				document.getElementById("result").value = 'osu file format v14\n\n[General]\nAudioFilename: \nAudioLeadIn: 0\nPreviewTime: -1\nCountdown: 0\nSampleSet: Soft\nStackLeniency: 0.7\nMode: 3\nLetterboxInBreaks: 0\nSpecialStyle: 0\nWidescreenStoryboard: 0\n\n[Editor]\nDistanceSpacing: 0.8\nBeatDivisor: 1\nGridSize: 32\nTimelineZoom: 0.8\n\n[Metadata]\nTitle:song_names\nTitleUnicode:song_names\nArtist:artist_names\nArtistUnicode:artist_names\nCreator:creator_names\nVersion:version_names\nSource:\nTags:\nBeatmapID:\nBeatmapSetID:\n\n[Difficulty]\nHPDrainRate:5\nCircleSize:'+key_num_a+'\nOverallDifficulty:5\nApproachRate:5\nSliderMultiplier:1.4\nSliderTickRate:1\n\n'+bpm_text+"\n\n"+ha5+j_a;
				break;
		}
	}
	function Function2() {
		if (document.getElementById('notewidth').value == "") {
			document.getElementById('notewidth').value = "64";
			lock();
			setTimeout(function () {
				warning.innerHTML = "<b>你没有填写音符宽度，程序使用默认值转换。按下菜单键、返回键或点击此消息可解锁焦点。</b>";
				if (zh_choose == "t") {
					zh_tran('t');
				}
			}, 100);
		}
		document.getElementById('progress').style.display = "inline"
		document.getElementById('progress').style.animation = 'warning_4 0.1s';
		setTimeout(function () { document.getElementById('progress3').style.display = 'inline'; }, 100);
		document.getElementById('progress').style.width = '60%';
		document.getElementById('progress').style.height = '20px';
		document.getElementById('progress').style.left = '20%';
		timerstart = true;
		timer();
		file = document.getElementById("file").files[0];
		if (file) {
			//检测是否为文件输入
			var reader = new FileReader();
			reader.readAsText(file, "utf-8");
			reader.onload = function () {
				file_a = this.result;
				file_a = file_a.toString();
				//以后会制作midi文件的导入功能
				if (file_a.indexOf("MThd") > -1 || file_a.indexOf("MTrk") > -1) {
					midifile = document.getElementById("file").files[0];
					midifile_a = new FileReader();
					midifile_a.readAsBinaryString(midifile);
					console.warn(midifile_a);
				} else {
					//对钢琴块复制品的json的兼容
					file_a = file_a.replace(/rhythm/g, "baseBpm");
					file_a = file_a.replace(/zz39pm/g, "bpm");
					file_a = file_a.replace(/unit/g, "baseBeats");
					document.getElementById("input").value = file_a;
					var file_a = eval('(' + file_a + ')');
					//兼容小程序json
					if (file_a.__type__) {
						//对于单个小程序json里的歌曲
						if (file_a.json.musics) {
							file_f = file_a.json.musics;
							file_j = file_a.json.baseBpm;
							file_d = file_f.length;
							continue_music();
						} else {
							//对于一整组的json的歌曲选择
							select();
							songselect1 = file_a.json.length;
							for (songselect2 = 0; songselect2 < songselect1; songselect2++) {
								file_i = file_a.json;
								test1();
							}
							fl2();
						}
					} else {
						//正常的json的转换
						file_f = file_a.musics;
						file_j = file_a.baseBpm;
						file_d = file_f.length;
						continue_music();
					}
				}
			}
		} else {
			//以后取消文字输入转换，仅供测试使用
			a = document.getElementById("input").value;
			filesound = a;
			startchange();
		}
		sound1 = 0;
		soundshow.innerHTML = "正常";
		document.getElementById('soundshow').style.color = '#555';
		document.getElementById("warning_sound").innerHTML = "♮正常";
		document.getElementById("warning_sound").style.color = '#555';
	}
	function startchange1() {
		a = a.replace(/;/g, ",");
		if (document.getElementById('reverse').checked == true) {
			a = a.split(',');
			a = a.reverse();
			delete a[0];
			a = a.toString();
			a = a.replace(",", "");
			a = a + ",";
		}
		//替换一部分字符
		a = a.replace(/\./g, "");
		a = a.replace(/5</g, "h[");
		a = a.replace(/2</g, "p[");
		a = a.replace(/1</g, "q[");
		a = a.replace(/3</g, "i[");
		a = a.replace(/6</g, "j[");
		a = a.replace(/7</g, "k[");
		a = a.replace(/8</g, "l[");
		a = a.replace(/9</g, "m[");
		a = a.replace(/10</g, "n[");
		a = a.replace(/\>/g, "o");
		a = a.replace(/1/g, "");
		a = a.replace(/2/g, "");
		a = a.replace(/3/g, "");
		a = a.replace(/4/g, "");
		a = a.replace(/5/g, "");
		a = a.replace(/6/g, "");
		a = a.replace(/7/g, "");
		a = a.replace(/8/g, "");
		a = a.replace(/9/g, "");
		a = a.replace(/0/g, "");
		a = a.replace(/zz/g, "");
		a = a.replace(/H/g, ",8`");
		a = a.replace(/I/g, ",4`");
		a = a.replace(/J/g, ",2`");
		a = a.replace(/K/g, ",1`");
		a = a.replace(/L/g, ",0.5`");
		a = a.replace(/M/g, ",0.25`");
		a = a.replace(/N/g, ",0.125`");
		a = a.replace(/O/g, ",0.0625`");
		a = a.replace(/P/g, ",0.03125`");
		a = a.replace(/Q/g, "-`8`-");
		a = a.replace(/R/g, "-`4`-");
		a = a.replace(/S/g, "-`2`-");
		a = a.replace(/T/g, "-`1`-");
		a = a.replace(/U/g, "-`0.5`-");
		a = a.replace(/V/g, "-`0.25`-");
		a = a.replace(/W/g, "-`0.125`-");
		a = a.replace(/X/g, "-`0.0625`-");
		a = a.replace(/Y/g, "-`0.03125`-");
		a = a.replace(/mute/g, "");
		a = a.replace(/chuanshao/g, "");
		a = a.replace(/\#/g, "");
		document.getElementById('progress').value = "5"
		progress1.innerHTML = "5"
		//对于音符括号组合中藏有休止符例如(a~V~a)的清空部分
		while (a.indexOf("(") > -1) {
			b = a.indexOf("(");
			c = a.indexOf(")") + 1;
			d = a.slice(b, c);
			a = a.replace(d, "");
		}
		a = a.replace(/\(/g, "");
		a = a.replace(/\)/g, "");
		a = a.replace(/\{/g, "");
		a = a.replace(/\}/g, "");
		a = a.replace(/\`,/g, "`");
		a = a.replace(/\[,/g, "[");
		a = a.replace(/\],/g, "+");
		a = a.replace(/\];/g, "+");
		a = a.replace(/\[/g, "");
		a = a.replace(/\],h/g, "+h");
		a = a.replace(/\],i/g, "+i");
		a = a.replace(/\],j/g, "+j");
		a = a.replace(/\],k/g, "+k");
		a = a.replace(/\],l/g, "+l");
		a = a.replace(/\],m/g, "+m");
		a = a.replace(/\],n/g, "+n");
		a = a.replace(/\],q/g, "+q");
		a = a.replace(/\],p/g, "+p");
		a = a.replace(/\]/, "");
		a = a.replace(/Z/g, "");
		a = a.replace(/c/g, "");
		a = a.replace(/d/g, "");
		a = a.replace(/e/g, "");
		a = a.replace(/f/g, "");
		a = a.replace(/g/g, "");
		a = a.replace(/a/g, "");
		a = a.replace(/b/g, "");
		a = a.replace(/C-/g, "");
		a = a.replace(/D-/g, "");
		a = a.replace(/E-/g, "");
		a = a.replace(/F-/g, "");
		a = a.replace(/G-/g, "");
		a = a.replace(/A-/g, "");
		a = a.replace(/B-/g, "");
		document.getElementById('progress').value = "10"
		progress1.innerHTML = "10"
		//开始转换数字形式表示谱子节奏
		a = a.split("`+");
		a = a.toString();
		//对于key模式下的转换
		a = a.replace(/;/g, ",");
		a = a.replace(/-o/g, "-,o");
		ba = a;
		//休止符的转换
		an = a.indexOf("-`");
		ao = a.indexOf("`-,") + 3;
		while (an > -1) {
			ap = a.slice(an, ao - 1);
			aw = ap;
			aq = ap.indexOf("-`") + 2;
			ar = ap.indexOf("`-");
			au = 0;
			while (aq > 1) {
				at = ap.slice(aq, ar);
				av = ap.slice(aq - 2, ar + 1);
				at = parseFloat(at);
				au = at + au;
				ap = ap.replace(av, "");
				aq = ap.indexOf("-`") + 2;
				ar = ap.indexOf("`-");
			}
			a = a.replace(aw, au);
			an = a.indexOf("-`");
			ao = a.indexOf("`-,") + 3;
		}
		a = a.replace(/,o/g, "`o");
		a = a.replace(/`]o/g, "`o");
		//爆裂块10<
		ah = a.lastIndexOf("");
		ai = a.indexOf("n");
		if (ai > -1) {
			aj = a.slice(ai, ah);
			ak = aj.indexOf("`o");
			al = aj.slice(1, ak);
			am = aj.slice(0, ak + 2);
			a = a.replace(am, al);
			ah = a.lastIndexOf("");
			ai = a.indexOf("n");
			while (ai > -1) {
				aj = a.slice(ai, ah);
				ak = aj.indexOf("`]o");
				al = aj.slice(1, ak);
				am = aj.slice(0, ak + 3);
				a = a.replace(am, al);
				ah = a.lastIndexOf("");
				ai = a.indexOf("n");
			}
		}
		//单黑2<
		ah = a.lastIndexOf("");
		ai = a.indexOf("p");
		if (ai > -1) {
			aj = a.slice(ai, ah);
			ak = aj.indexOf("`o");
			al = aj.slice(1, ak);
			am = aj.slice(0, ak + 2);
			a = a.replace(am, al);
			ah = a.lastIndexOf("");
			ai = a.indexOf("p");
			while (ai > -1) {
				aj = a.slice(ai, ah);
				ak = aj.indexOf("`]o");
				al = aj.slice(1, ak);
				am = aj.slice(0, ak + 3);
				a = a.replace(am, al);
				ah = a.lastIndexOf("");
				ai = a.indexOf("p");
			}
		}
		//未定义1<
		ah = a.lastIndexOf("");
		ai = a.indexOf("q");
		if (ai > -1) {
			aj = a.slice(ai, ah);
			ak = aj.indexOf("`o");
			al = aj.slice(1, ak);
			am = aj.slice(0, ak + 2);
			a = a.replace(am, al);
			ah = a.lastIndexOf("");
			ai = a.indexOf("q");
			while (ai > -1) {
				aj = a.slice(ai, ah);
				ak = aj.indexOf("`]o");
				al = aj.slice(1, ak);
				am = aj.slice(0, ak + 3);
				a = a.replace(am, al);
				ah = a.lastIndexOf("");
				ai = a.indexOf("q");
			}
		}
		a = a.replace(/i/g, "h");
		a = a.replace(/j/g, "h");
		a = a.replace(/k/g, "h");
		a = a.replace(/l/g, "h");
		a = a.replace(/m/g, "h");
		a = a.replace(/n/g, "h");
		a = a.replace(/p/g, "h");
		a = a.replace(/q/g, "h");
		document.getElementById('progress').value = "15"
		progress1.innerHTML = "15"
		//玩法干预区域
		aa = a.indexOf("h") + 1;
		ab = a.indexOf("`o");
		while (aa > 0) {
			ac = a.slice(aa, ab);
			ag = a.slice(aa - 1, ab + 2);
			ad = ac.indexOf(",");
			f = 0;
			while (ad > -1) {
				ae = ac.slice(0, ad);
				d = ae.indexOf("`");
				ac = ac.replace(ae + ",", "");
				while (d > -1) {
					e = ae.slice(0, d);
					ae = ac.replace(e + "`", "");
					e = parseFloat(e);
					f = e + f;
					d = ae.indexOf("`");
				}
				ae = parseFloat(ae);
				f = f + ae;
				ad = ac.indexOf(",");
			}
			ae = ac.slice(0, ac.lastIndexOf(""));
			d = ae.indexOf("`");
			ac = ac.replace(ae + ",", "");
			while (d > -1) {
				e = ae.slice(0, d);
				ae = ac.replace(e + "`", "");
				e = parseFloat(e);
				f = e + f;
				d = ae.indexOf("`");
			}
			ae = parseFloat(ae);
			f = f + ae;
			f = f.toString();
			a = a.replace(ag, f);
			aa = a.indexOf("h") + 1;
			ab = a.indexOf("`o");
		}
		document.getElementById('progress').value = "20"
		progress1.innerHTML = "20"
		a = a.replace(",,", ",");
		a = a.replace(/`/g, "+");
		a = a.replace(/\+o/g, "");
		a = a.split(",");
		//整理音符时间堆积
		var f = 0, g = "";
		for (b = 0; b < a.length - 1; b++) {
			c = a[b];
			if (c.indexOf("+") > -1) {
				c = c.split("+");
				var e = 0;
				for (d = 0; d < c.length; d++) {
					e = parseFloat(c[d]) + e;
				}
				c = e * 32;
				f = f + c;
				c = f.toString();
				g = g + "," + c;
			} else {
				c = parseFloat(c);
				c = c * 32;
				f = f + c;
				c = f.toString();
				g = g + "," + c;
			}
		}
		g = g.replace(",", "");
		g_g = g;
		i = g;
	}
	function startchange() {
		startchange1();
		document.getElementById('progress').value = "25"
		progress1.innerHTML = "25"
		//格式化
		v = g;
		o = g;
		games_type = games.value;
		switch (games_type) {
			case "mak":
			case "mas":
				game_type1();
				break;
			case "om":
				game_type3();
				break;
		}
		function game_type3() {
			a = document.getElementById("bpm").value;
			a = parseFloat(a);
			g = g.split(",");
			var g_d = "";
			for (g_a = 0; g_a < g.length; g_a++) {
				g_b = parseFloat(g[g_a]);
				g_c = Math.floor(3750 * g_b / a * 0.5);
				g_d = g_d + "," + g_c;
			}
			g_d = g_d.replace(",", "");
			a = g_d;
			a = a.split(",");
			g_b = "";
			for (g_a = 0; g_a < g.length - 1; g_a++) {
				g_b = g_b + "\ncolumn,192,<" + a[g_a] + ">,note,0,endbeat:0:0:0:sound"
			}
			g_b = g_b.replace("\n", "column,192,<0>,note,0,endbeat:0:0:0:sound\n");
			m = document.getElementById("beats").value;
			m = parseFloat(m);
			a = document.getElementById("bpm").value;
			a = parseFloat(a);
			n = Math.floor(3750 * m * 32 / a * 0.5);
			g_d = g_d.split(",");
			for (g_a = 0; g_a < g.length; g_a++) {
				f_a = g_b.indexOf("<");
				f_b = g_b.indexOf(">") + 1;
				f_c = g_b.slice(f_a, f_b);
				f_d = f_c.replace("<", "");
				f_d = f_d.replace(">", "");
				g_b = g_b.replace(f_c, f_d);
				f_a = parseFloat(g_d[g_a]);
				f_d = parseFloat(f_d);
				f_b = f_a - f_d;
				if (f_b > n + 1) {
					f_c = f_a - n;
					f_c = Math.floor(f_c);
					g_b = g_b.replace("endbeat", f_c + ":0");
					g_b = g_b.replace("note", "128");
				} else {
					g_b = g_b.replace("endbeat", "0");
					g_b = g_b.replace("note", "1");
				}
			}
			key_num = key.value;
			switch (key_num) {
				case "1k":
					key_num_a = 1;
					g_b = g_b.replace(/column/g, "256");
					break;
				case "2k":
					key_num_a = 2;
					if (document.getElementById("continue").checked == true) {
						while (g_b.indexOf("column") > -1) {
							x = Math.random() * 2;
							x = Math.floor(x);
							if (x == 0) {
								g_b = g_b.replace(/column/, "128");
							} else {
								g_b = g_b.replace(/column/, "384");
							}
						}
					} else {
						var x = 0;
						while (g_b.indexOf("column") > -1) {
							x = x + 1;
							if (x % 2 == 0) {
								g_b = g_b.replace(/column/, "128");
							} else {
								g_b = g_b.replace(/column/, "384");
							}
						}
					}
					break;
				case "3k":
					key_num_a = 3;
					if (document.getElementById("continue").checked == true) {
						while (g_b.indexOf("column") > -1) {
							x = Math.random() * 3;
							x = Math.floor(x);
							if (x == 0) {
								g_b = g_b.replace(/column/, "85");
							}
							if (x == 1) {
								g_b = g_b.replace(/column/, "256");
							}
							if (x == 2) {
								g_b = g_b.replace(/column/, "426");
							}
						}
					} else {
						var y;
						while (g_b.indexOf("column") > -1) {
							x = Math.random() * 3;
							x = Math.floor(x);
							while (x == y) {
								x = Math.random() * 3;
								x = Math.floor(x);
							}
							y = x;
							if (x == 0) {
								g_b = g_b.replace(/column/, "85");
							}
							if (x == 1) {
								g_b = g_b.replace(/column/, "256");
							}
							if (x == 2) {
								g_b = g_b.replace(/column/, "426");
							}
						}
					}
					break;
				case "4k":
					key_num_a = 4;
					if (document.getElementById("continue").checked == true) {
						while (g_b.indexOf("column") > -1) {
							x = Math.random() * 4;
							x = Math.floor(x);
							if (x == 0) {
								g_b = g_b.replace(/column/, "64");
							}
							if (x == 1) {
								g_b = g_b.replace(/column/, "192");
							}
							if (x == 2) {
								g_b = g_b.replace(/column/, "320");
							}
							if (x == 3) {
								g_b = g_b.replace(/column/, "448");
							}
						}
					} else {
						var y;
						while (g_b.indexOf("column") > -1) {
							x = Math.random() * 4;
							x = Math.floor(x);
							while (x == y) {
								x = Math.random() * 4;
								x = Math.floor(x);
							}
							y = x;
							if (x == 0) {
								g_b = g_b.replace(/column/, "64");
							}
							if (x == 1) {
								g_b = g_b.replace(/column/, "192");
							}
							if (x == 2) {
								g_b = g_b.replace(/column/, "320");
							}
							if (x == 3) {
								g_b = g_b.replace(/column/, "448");
							}
						}
					}
					break;
				case "5k":
					key_num_a = 5;
					if (document.getElementById("continue").checked == true) {
						while (g_b.indexOf("column") > -1) {
							x = Math.random() * 5;
							x = Math.floor(x);
							if (x == 0) {
								g_b = g_b.replace(/column/, "51");
							}
							if (x == 1) {
								g_b = g_b.replace(/column/, "153");
							}
							if (x == 2) {
								g_b = g_b.replace(/column/, "256");
							}
							if (x == 3) {
								g_b = g_b.replace(/column/, "358");
							}
							if (x == 4) {
								g_b = g_b.replace(/column/, "460");
							}
						}
					} else {
						var y;
						while (g_b.indexOf("column") > -1) {
							x = Math.random() * 5;
							x = Math.floor(x);
							while (x == y) {
								x = Math.random() * 5;
								x = Math.floor(x);
							}
							y = x;
							if (x == 0) {
								g_b = g_b.replace(/column/, "51");
							}
							if (x == 1) {
								g_b = g_b.replace(/column/, "153");
							}
							if (x == 2) {
								g_b = g_b.replace(/column/, "256");
							}
							if (x == 3) {
								g_b = g_b.replace(/column/, "358");
							}
							if (x == 4) {
								g_b = g_b.replace(/column/, "460");
							}
						}
					}
					break;
				case "6k":
					key_num_a = 6;
					if (document.getElementById("continue").checked == true) {
						while (g_b.indexOf("column") > -1) {
							x = Math.random() * 6;
							x = Math.floor(x);
							if (x == 0) {
								g_b = g_b.replace(/column/, "42");
							}
							if (x == 1) {
								g_b = g_b.replace(/column/, "128");
							}
							if (x == 2) {
								g_b = g_b.replace(/column/, "213");
							}
							if (x == 3) {
								g_b = g_b.replace(/column/, "298");
							}
							if (x == 4) {
								g_b = g_b.replace(/column/, "384");
							}
							if (x == 5) {
								g_b = g_b.replace(/column/, "469");
							}
						}
					} else {
						var y;
						while (g_b.indexOf("column") > -1) {
							x = Math.random() * 6;
							x = Math.floor(x);
							while (x == y) {
								x = Math.random() * 6;
								x = Math.floor(x);
							}
							y = x;
							if (x == 0) {
								g_b = g_b.replace(/column/, "42");
							}
							if (x == 1) {
								g_b = g_b.replace(/column/, "128");
							}
							if (x == 2) {
								g_b = g_b.replace(/column/, "213");
							}
							if (x == 3) {
								g_b = g_b.replace(/column/, "298");
							}
							if (x == 4) {
								g_b = g_b.replace(/column/, "384");
							}
							if (x == 5) {
								g_b = g_b.replace(/column/, "469");
							}
						}
					}
					break;
				case "7k":
					key_num_a = 7;
					if (document.getElementById("continue").checked == true) {
						while (g_b.indexOf("column") > -1) {
							x = Math.random() * 7;
							x = Math.floor(x);
							if (x == 0) {
								g_b = g_b.replace(/column/, "36");
							}
							if (x == 1) {
								g_b = g_b.replace(/column/, "109");
							}
							if (x == 2) {
								g_b = g_b.replace(/column/, "182");
							}
							if (x == 3) {
								g_b = g_b.replace(/column/, "256");
							}
							if (x == 4) {
								g_b = g_b.replace(/column/, "329");
							}
							if (x == 5) {
								g_b = g_b.replace(/column/, "402");
							}
							if (x == 6) {
								g_b = g_b.replace(/column/, "475");
							}
						}
					} else {
						var y;
						while (g_b.indexOf("column") > -1) {
							x = Math.random() * 7;
							x = Math.floor(x);
							while (x == y) {
								x = Math.random() * 7;
								x = Math.floor(x);
							}
							y = x;
							if (x == 0) {
								g_b = g_b.replace(/column/, "36");
							}
							if (x == 1) {
								g_b = g_b.replace(/column/, "109");
							}
							if (x == 2) {
								g_b = g_b.replace(/column/, "182");
							}
							if (x == 3) {
								g_b = g_b.replace(/column/, "256");
							}
							if (x == 4) {
								g_b = g_b.replace(/column/, "329");
							}
							if (x == 5) {
								g_b = g_b.replace(/column/, "402");
							}
							if (x == 6) {
								g_b = g_b.replace(/column/, "475");
							}
						}
					}
					break;
				case "8k":
					key_num_a = 8;
					if (document.getElementById("continue").checked == true) {
						while (g_b.indexOf("column") > -1) {
							x = Math.random() * 8;
							x = Math.floor(x);
							if (x == 0) {
								g_b = g_b.replace(/column/, "32");
							}
							if (x == 1) {
								g_b = g_b.replace(/column/, "96");
							}
							if (x == 2) {
								g_b = g_b.replace(/column/, "160");
							}
							if (x == 3) {
								g_b = g_b.replace(/column/, "224");
							}
							if (x == 4) {
								g_b = g_b.replace(/column/, "288");
							}
							if (x == 5) {
								g_b = g_b.replace(/column/, "352");
							}
							if (x == 6) {
								g_b = g_b.replace(/column/, "416");
							}
							if (x == 7) {
								g_b = g_b.replace(/column/, "480");
							}
						}
					} else {
						var y;
						while (g_b.indexOf("column") > -1) {
							x = Math.random() * 8;
							x = Math.floor(x);
							while (x == y) {
								x = Math.random() * 8;
								x = Math.floor(x);
							}
							y = x;
							if (x == 0) {
								g_b = g_b.replace(/column/, "32");
							}
							if (x == 1) {
								g_b = g_b.replace(/column/, "96");
							}
							if (x == 2) {
								g_b = g_b.replace(/column/, "160");
							}
							if (x == 3) {
								g_b = g_b.replace(/column/, "224");
							}
							if (x == 4) {
								g_b = g_b.replace(/column/, "288");
							}
							if (x == 5) {
								g_b = g_b.replace(/column/, "352");
							}
							if (x == 6) {
								g_b = g_b.replace(/column/, "416");
							}
							if (x == 7) {
								g_b = g_b.replace(/column/, "480");
							}
						}
					}
					break;
				case "9k":
					key_num_a = 9;
					if (document.getElementById("continue").checked == true) {
						while (g_b.indexOf("column") > -1) {
							x = Math.random() * 9;
							x = Math.floor(x);
							if (x == 0) {
								g_b = g_b.replace(/column/, "28");
							}
							if (x == 1) {
								g_b = g_b.replace(/column/, "85");
							}
							if (x == 2) {
								g_b = g_b.replace(/column/, "142");
							}
							if (x == 3) {
								g_b = g_b.replace(/column/, "199");
							}
							if (x == 4) {
								g_b = g_b.replace(/column/, "256");
							}
							if (x == 5) {
								g_b = g_b.replace(/column/, "312");
							}
							if (x == 6) {
								g_b = g_b.replace(/column/, "369");
							}
							if (x == 7) {
								g_b = g_b.replace(/column/, "426");
							}
							if (x == 8) {
								g_b = g_b.replace(/column/, "483");
							}
						}
					} else {
						var y;
						while (g_b.indexOf("column") > -1) {
							x = Math.random() * 9;
							x = Math.floor(x);
							while (x == y) {
								x = Math.random() * 9;
								x = Math.floor(x);
							}
							y = x;
							if (x == 0) {
								g_b = g_b.replace(/column/, "28");
							}
							if (x == 1) {
								g_b = g_b.replace(/column/, "85");
							}
							if (x == 2) {
								g_b = g_b.replace(/column/, "142");
							}
							if (x == 3) {
								g_b = g_b.replace(/column/, "199");
							}
							if (x == 4) {
								g_b = g_b.replace(/column/, "256");
							}
							if (x == 5) {
								g_b = g_b.replace(/column/, "312");
							}
							if (x == 6) {
								g_b = g_b.replace(/column/, "369");
							}
							if (x == 7) {
								g_b = g_b.replace(/column/, "426");
							}
							if (x == 8) {
								g_b = g_b.replace(/column/, "483");
							}
						}
					}
					break;
			}
			while (c_a.indexOf(",,") > -1 || c_a.indexOf(";,") > -1 || c_a.indexOf(",;") > -1 || c_a.indexOf(";;") > -1) {
				c_a = c_a.replace(",,", ",");
				c_a = c_a.replace(",;", ",");
				c_a = c_a.replace(";,", ",");
				c_a = c_a.replace(";;", ",");
			}
			a = c_a;
			Function1();
			a = a.split(",");
			var i_a = /\((.+?)\)/g;
			var i_b = /\[(.+?)\]/g;
			j_a = "";
			for (g_a = 0; g_a < a.length - 1; g_a++) {
				g_f = a[g_a].match(i_a);
				if (g_f === null) {
					g_b = g_b.replace("sound", "");
					j_a = j_a + "," + a[g_a].match(i_b).toString();
				} else {
					g_f = g_f.toString();
					if (g_f.indexOf(".") > -1 || g_f.indexOf("!") > -1 || g_f.indexOf("~") > -1 || g_f.indexOf("@") > -1 || g_f.indexOf("$") > -1 || g_f.indexOf("%") > -1 || g_f.indexOf("^") > -1 || g_f.indexOf("&") > -1) {
						if (g_f.indexOf("^") > -1 || g_f.indexOf("&") > -1) {
							g_b = g_b.replace("sound", "");
							j_a = j_a + "," + a[g_a].match(i_b).toString();
						} else {
							g_h = g_f;
							g_f = g_f.replace("(", "");
							g_f = g_f.replace(")", "");
							g_f = g_f.replace(".", ",");
							g_f = g_f.replace("~", ",");
							g_f = g_f.replace("!", ",");
							g_f = g_f.replace("@", ",");
							g_f = g_f.replace("$", ",");
							g_f = g_f.replace("%", ",");
							g_f = g_f.split(",");
							g_b = g_b.replace("sound", "midi_timbre_id/" + g_f[0]);
							g_h = g_h.replace(g_f[0], "mute");
							j_a = j_a + "," + g_h + a[g_a].match(i_b).toString();
						}
					} else {
						g_f = g_f.replace("(", "");
						g_f = g_f.replace(")", "");
						g_b = g_b.replace("sound", "midi_timbre_id/" + g_f);
						j_a = j_a + "," + a[g_a].match(i_b).toString();
					}
				}
			}
			i_c = g_b;
			j_a = j_a.replace(",", "");
			a = j_a;
			Function1_a();
			j_a = a;
			ha5 = i_c;
			a = document.getElementById("bpm").value;
			a = parseFloat(a);
			bpm_text='[TimingPoints]\n0,'+3750 * 32 / a * 0.5+',4,2,1,50,1,0';
		}
		function game_type1() {
			g = g.replace("", '{"beat":[j,0,');
			games_type = games.value;
			switch (games_type) {
				case "mak":
					g = g.replace(/\,/g, ',32>,"column":x},{"beat":[j,');
					g = g.replace('{"beat":[j,32>,"column":x},', "");
					i = i.toString();
					g = g.replace('\,"column":x},{"beat":[j,' + i, ',"column":x},');
					b = g.indexOf("j");
					while (b > -1) {
						c = g.indexOf("[j");
						d = g.indexOf("32>");
						e = g.slice(c, d + 3);
						l = e;
						f = e.indexOf(",");
						h = e.indexOf(",32>");
						i = e.slice(f + 1, h);
						i = parseFloat(i);
						k = i;
						k = k.toString();
						l = l.toString();
						if (i >= 32) {
							j = i / 32;
							j = Math.floor(j);
							i = i - 32 * j;
							j = j.toString();
							i = i.toString();
							e = e.replace(/\>/, "]");
							e = e.replace(k, i);
							e = e.replace(/j/, j);
							g = g.replace(l, e)
						} else {
							j = 0;
							g = g.replace(/j/, j);
							g = g.replace(/\>/, "]");
						}
						b = g.indexOf("j");
					}
					key_num = key.value;
					switch (key_num) {
						case "4k":
							key_num_a = 4;
							break;
						case "5k":
							key_num_a = 5;
							break;
						case "6k":
							key_num_a = 6;
							break;
						case "7k":
							key_num_a = 7;
							break;
						case "8k":
							key_num_a = 8;
							break;
						case "9k":
							key_num_a = 9;
							break;
						case "10k":
							key_num_a = 10;
							break;
					}
					//随机生成note位置
					if (document.getElementById("continue").checked == true) {
						a = g.indexOf("x");
						while (a > -1) {
							var x;
							x = Math.random() * key_num_a;
							x = Math.floor(x);
							x = x.toString();
							g = g.replace("x", x);
							a = g.indexOf("x");
						}
					} else {
						a = g.indexOf("x");
						var y;
						while (a > -1) {
							var x;
							x = Math.random() * key_num_a;
							x = Math.floor(x);
							while (x == y) {
								x = Math.random() * key_num_a;
								x = Math.floor(x);
							}
							y = x;
							x = x.toString();
							g = g.replace("x", x);
							a = g.indexOf("x");
						}
					}
					break;
				case "mas":
					g = g.replace(/\,/g, ',32>,"x":s_x,"w":s_w,end},{"beat":[j,');
					g = g.replace('{"beat":[j,32>,"x":s_x,"w":s_w,end},', "");
					i = i.toString();
					g = g.replace('\,"x":s_x,"w":s_w},{"beat":[j,' + i, ',"x":s_x,"w":s_w,end},');
					b = g.indexOf("j");
					while (b > -1) {
						c = g.indexOf("[j");
						d = g.indexOf("32>");
						e = g.slice(c, d + 3);
						l = e;
						f = e.indexOf(",");
						h = e.indexOf(",32>");
						i = e.slice(f + 1, h);
						i = parseFloat(i);
						k = i;
						k = k.toString();
						l = l.toString();
						if (i >= 32) {
							j = i / 32;
							j = Math.floor(j);
							i = i - 32 * j;
							j = j.toString();
							i = i.toString();
							e = e.replace(/\>/, "]");
							e = e.replace(k, i);
							e = e.replace(/j/, j);
							g = g.replace(l, e)
						} else {
							j = 0;
							g = g.replace(/j/, j);
							g = g.replace(/\>/, "]");
						}
						b = g.indexOf("j");
					}
					//随机生成note位置
					notewidth_1 = document.getElementById('notewidth').value;
					if (notewidth_1.indexOf("-") > -1) {

					} else {
						g = g.replace(/s_w/g, notewidth_1);
						notewidth_1 = parseFloat(notewidth_1);
						if (document.getElementById("continue").checked == true) {
							a = g.indexOf("s_x");
							while (a > -1) {
								var x;
								x = Math.random() * (256 - notewidth_1);
								x = Math.floor(x);
								x = x + (notewidth_1 / 2);
								x = x.toString();
								g = g.replace("s_x", x);
								a = g.indexOf("s_x");
							}
						} else {
							a = g.indexOf("s_x");
							var y;
							while (a > -1) {
								var x;
								x = Math.random() * (256 - notewidth_1);
								x = Math.floor(x);
								x = x + (notewidth_1 / 2);
								while (x == y || x > y - notewidth_1 && x < y + notewidth_1) {
									x = Math.random() * (256 - notewidth_1);
									x = Math.floor(x);
									x = x + (notewidth_1 / 2);
								}
								y = x;
								x = x.toString();
								g = g.replace("s_x", x);
								a = g.indexOf("s_x");
							}
						}
					}
					console.log(notewidth_1);
					break;
			}
			document.getElementById('progress').value = "30"
			progress1.innerHTML = "30"
			m = document.getElementById("beats").value;
			b = m.indexOf(";");
			//基础节拍的读取与转换
			n = parseFloat(m);
			n = n * 32;
			a = g;
			c = a.indexOf("},") + 1;
			d = a.slice(0, c);
			a = a.replace(d, "");
			h = "";
			o = o.concat(",");
			while (c > 0) {
				p = o.indexOf(",");
				q = o.slice(0, p);
				o = o.replace(q + ",", "");
				r = q.indexOf("`");
				t = 0;
				while (r > -1) {
					s = q.slice(0, r);
					q = q.replace(s + "`", "");
					s = parseFloat(s);
					t = t + s;
					r = q.indexOf("`");
					if (r = -1) {
						q = parseFloat(q);
						q = t + q;
					}
				}
				q = parseFloat(q);
				q = q - aa;
				if (q > n) {
					games_type = games.value;
					if (games_type == "mas") {
						e = '"seg":[{"beat":[f,u,32],"x":0}]';
					} else {
						e = '],"endbeat": [f,u,32],"';
					}
					u = parseFloat(v);
					w = u;
					w = w.toString();
					v = v.replace(w + ",", "");
					u = u - n;
					f = 0;
					if (u >= 32) {
						f = u / 32;
						f = Math.floor(f);
						u = u - (32 * f);
					}
					games_type = games.value;
					if (games_type == "mas") {
						var a_a = d.indexOf('"beat":[') + 8;
						var a_b = d.indexOf(',32');
						var a_c = d.slice(a_a, a_b);
						var a_c = a_c.split(",");
						a_a = parseFloat(a_c[0]);
						a_b = parseFloat(a_c[1]);
						u = u - a_b + n;
						f = f - a_a;
						if (u < 0) {
							f = f - 1;
							u = 0 - u;
						}
						u = u.toString();
						f = f.toString();
						e = e.replace("u", u);
						e = e.replace("f", f);
						d = d.replace('end', e);
					} else {
						u = u.toString();
						f = f.toString();
						e = e.replace("u", u);
						e = e.replace("f", f);
						d = d.replace('],"', e);
					}
				} else {
					u = parseFloat(v);
					w = u;
					w = w.toString();
					v = v.replace(w + ",", "");
					games_type = games.value;
					if (games_type == "mas") {
						d = d.replace(',end', "");
					}
				}
				aa = q + aa;
				h = h.replace(h, h + d);
				c = a.indexOf("},") + 1;
				d = a.slice(0, c);
				a = a.replace(d, "");
			}
			document.getElementById('progress').value = "35"
			progress1.innerHTML = "35"
			//音符玩法的最后调整
			ba = ba.replace(/]/g, "");
			b1 = ba.indexOf("q");
			b2 = ba.indexOf("p");
			b3 = ba.indexOf("i");
			b5 = ba.indexOf("h");
			b6 = ba.indexOf("j");
			b7 = ba.indexOf("k");
			b8 = ba.indexOf("l");
			b9 = ba.indexOf("m");
			b10 = ba.indexOf("n");
			bb = ba.indexOf("o");
			console.warn(ba);
			while (bb > -1) {
				if (b1 < bb && b1 > -1) {
					ba = ba.replace(/q/, "");
					ba = ba.replace(/`o/, "");
					ba = ba.replace(/,o/, "");
				}
				if (b2 < bb && b2 > -1) {
					ba = ba.replace(/p/, "");
					ba = ba.replace(/`o/, "");
					ba = ba.replace(/,o/, "");
				}
				if (b3 < bb && b3 > -1) {
					bc = ba.slice(b3, bb + 2);
					ba = ba.replace(bc, "test6,");
				}
				if (b5 < bb && b5 > -1) {
					bc = ba.slice(b5, bb + 2);
					ba = ba.replace(bc, "test5,");
				}
				if (b6 < bb && b6 > -1) {
					bc = ba.slice(b6, bb + 2);
					ba = ba.replace(bc, "test6,");
				}
				if (b7 < bb && b7 > -1) {
					bc = ba.slice(b7, bb + 2);
					ba = ba.replace(bc, "test6,");
				}
				if (b8 < bb && b8 > -1) {
					bc = ba.slice(b8, bb + 2);
					ba = ba.replace(bc, "test5,");
				}
				if (b9 < bb && b9 > -1) {
					bc = ba.slice(b9, bb + 2);
					ba = ba.replace(bc, "test9,");
				}
				if (b10 < bb && b10 > -1) {
					bc = ba.slice(b10, bb + 2);
					bf = bc;
					bd = bc.indexOf(",");
					if (bd > -1) {
						be = bc.slice(1, bd);
						bc = bc.replace(be, "test5");
						bc = bc.replace(/n/, "");
						bc = bc.replace(/`o/, "");
						bc = bc.replace(/,o/, "");
						ba = ba.replace(bf, bc);
					}
				}
				document.getElementById('progress').value = "40"
				progress1.innerHTML = "40"
				b1 = ba.indexOf("q");
				b2 = ba.indexOf("p");
				b3 = ba.indexOf("i");
				b5 = ba.indexOf("h");
				b6 = ba.indexOf("j");
				b7 = ba.indexOf("k");
				b8 = ba.indexOf("l");
				b9 = ba.indexOf("m");
				b10 = ba.indexOf("n");
				bb = ba.indexOf("o");
			}
			h = h.concat(",");
			ha5 = "";
			ha1 = h.indexOf("},") + 2;
			var hc1;
			while (ha1 > 1) {
				ha2 = h.slice(0, ha1);
				h = h.replace(ha2, "");
				ha3 = ba.indexOf(",") + 1;
				ha4 = ba.slice(0, ha3);
				ba = ba.replace(ha4, "");
				//双黑块的生成
				if (ha4 == "test5,") {
					hb1 = ha2.indexOf('n":') + 3;
					hb2 = ha2.slice(hb1, hb1 + 1);
					hb2 = parseFloat(hb2);
					hb4 = hb2;
					if (hc1 == hb2 || hc1 == hb2 + 2 || hc1 == hb2 - 2) {
						hb2 = hb2 + 1;
						if (hb2 > 3) {
							hb2 = hb2 - 2;
						}
						ha2 = ha2.replace('"column":' + hb4, '"column":' + hb2);
					}
					switch (hb2) {
						case 0:
							hb3 = ha2;
							hb3 = hb3.replace('"column":0', '"column":2');
							ha2 = ha2.concat(hb3);
							break;
						case 1:
							hb3 = ha2;
							hb3 = hb3.replace('"column":1', '"column":3');
							ha2 = ha2.concat(hb3);
							break;
						case 2:
							hb3 = ha2;
							hb3 = hb3.replace('"column":2', '"column":0');
							ha2 = ha2.concat(hb3);
							break;
						case 3:
							hb3 = ha2;
							hb3 = hb3.replace('"column":3', '"column":1');
							ha2 = ha2.concat(hb3);
							break;
					}
					hc1 = hb2;
					ha5 = ha5 + ha2;
					document.getElementById('progress').value = "45"
					progress1.innerHTML = "45"
				} else if (ha4 == "test9,") {
					document.getElementById('progress').value = "45"
					progress1.innerHTML = "45"
					//伴奏块暂时不做
				} else {
					//非双黑块的生成
					hb1 = ha2.indexOf('n":') + 3;
					hb2 = ha2.slice(hb1, hb1 + 1);
					hb2 = parseFloat(hb2);
					hb4 = hb2;
					//避免后面的黑块生成在双黑块上造成连续
					if (hc1 == hb2 || hc1 == hb2 + 2 || hc1 == hb2 - 2) {
						if (Math.random() * 2 > 1) {
							hb2 = hb2 - 1;
							if (hb2 < 0) {
								hb2 = hb2 + 2;
							}
						} else {
							hb2 = hb2 + 1;
							if (hb2 > 3) {
								hb2 = hb2 - 2;
							}
						}
						ha2 = ha2.replace('"column":' + hb4, '"column":' + hb2);
					}
					hc1 = hb2;
					ha5 = ha5 + ha2;
					document.getElementById('progress').value = "45"
					progress1.innerHTML = "45"
				}
				ha1 = h.indexOf("},") + 2;
			}
			document.getElementById("result").innerHTML = ha5;
			timerstart = false;
			clock = 0;
			document.getElementById('progress').value = "50"
			progress1.innerHTML = "50"
			if (document.getElementById('sound').checked == true) {
				Function1();
				Function1_a();
			} else {
				a = ""
			}
			ha5 = ha5 + a;
			sound3();
			document.getElementById('progress').value = "100"
			progress1.innerHTML = "100"
		}
	}
	//声音转换部分
	function Function1() {
		timerstart = true;
		timer();
		a = filesound;
		a = a.replace(/;/g, ",");
		if (document.getElementById('reverse').checked == true) {
			a = a.split(',');
			a = a.reverse();
			delete a[0];
			a = a.toString();
			a = a.replace(",", "");
			a = a + ",";
		}
		a = a.replace(/chuanshao/g, "mute");
		//自动纠错音符错误
		if (a.indexOf("#B") > -1 || a.indexOf("#E") > -1 || a.indexOf("#b") > -1 || a.indexOf("#e") > -1) {
			a = a.replace(/#e/g, "f");
			a = a.replace(/#b/g, "c1");
			a = a.replace(/#b1/g, "c2");
			a = a.replace(/#b2/g, "c3");
			a = a.replace(/#b3/g, "c4");
			a = a.replace(/#b4/g, "c5");
			a = a.replace(/#E/g, "F");
			a = a.replace(/#B-1/g, "c");
			a = a.replace(/#B-2/g, "C-1");
			a = a.replace(/#B-3/g, "C-2");
			lock();
			setTimeout(function () {
				warning.innerHTML = "<b>注意！json中出现#e或#b等错误音符，程序已自动纠错。按下菜单键、返回键或点击此消息可解锁焦点。</b>";
				if (zh_choose == "t") {
					zh_tran('t');
				}
			}, 100);
		}
		//对小程序的json里的特效代码删除（无法确定是否为音符的音量大小控制）
		if (a.indexOf("]0") > -1 || a.indexOf("]1") > -1 || a.indexOf("]2") > -1 || a.indexOf("]3") > -1 || a.indexOf("]4") > -1 || a.indexOf("]5") > -1 || a.indexOf("]6") > -1 || a.indexOf("]7") > -1 || a.indexOf("]8") > -1 || a.indexOf("]9") > -1 || a.indexOf("}0") > -1 || a.indexOf("}1") > -1 || a.indexOf("}2") > -1 || a.indexOf("}3") > -1 || a.indexOf("}4") > -1 || a.indexOf("}5") > -1 || a.indexOf("}6") > -1 || a.indexOf("}7") > -1 || a.indexOf("}8") > -1 || a.indexOf("}9") > -1) {
			a = a.replace(/]0/g, "]{0");
			a = a.replace(/]1/g, "]{1");
			a = a.replace(/]2/g, "]{2");
			a = a.replace(/]3/g, "]{3");
			a = a.replace(/]4/g, "]{4");
			a = a.replace(/]5/g, "]{5");
			a = a.replace(/]6/g, "]{6");
			a = a.replace(/]7/g, "]{7");
			a = a.replace(/]8/g, "]{8");
			a = a.replace(/]9/g, "]{9");
			a = a.replace(/}0/g, "}{0");
			a = a.replace(/}1/g, "}{1");
			a = a.replace(/}2/g, "}{2");
			a = a.replace(/}3/g, "}{3");
			a = a.replace(/}4/g, "}{4");
			a = a.replace(/}5/g, "}{5");
			a = a.replace(/}6/g, "}{6");
			a = a.replace(/}7/g, "}{7");
			a = a.replace(/}8/g, "}{8");
			a = a.replace(/}9/g, "}{9");
			a = a.replace(/0,/g, "0},");
			a = a.replace(/1,/g, "1},");
			a = a.replace(/2,/g, "2},");
			a = a.replace(/3,/g, "3},");
			a = a.replace(/4,/g, "4},");
			a = a.replace(/5,/g, "5},");
			a = a.replace(/6,/g, "6},");
			a = a.replace(/7,/g, "7},");
			a = a.replace(/8,/g, "8},");
			a = a.replace(/9,/g, "9},");
			a = a.replace(/0{/g, "0}{");
			a = a.replace(/1{/g, "1}{");
			a = a.replace(/2{/g, "2}{");
			a = a.replace(/3{/g, "3}{");
			a = a.replace(/4{/g, "4}{");
			a = a.replace(/5{/g, "5}{");
			a = a.replace(/6{/g, "6}{");
			a = a.replace(/7{/g, "7}{");
			a = a.replace(/8{/g, "8}{");
			a = a.replace(/9{/g, "9}{");
		}
		//删除视觉特效代码
		while (a.indexOf("{") > -1) {
			b = a.indexOf("{");
			c = a.indexOf("}") + 1;
			d = a.slice(b, c);
			a = a.replace(d, "");
		}
		//对钢琴块复制品的json的兼容
		a = a.replace(/zz01/g, "A-3");
		a = a.replace(/zz02/g, "#A-3");
		a = a.replace(/zz03/g, "B-3");
		a = a.replace(/zz04/g, "C-2");
		a = a.replace(/zz05/g, "#C-2");
		a = a.replace(/zz06/g, "D-2");
		a = a.replace(/zz07/g, "#D-2");
		a = a.replace(/zz08/g, "E-2");
		a = a.replace(/zz09/g, "F-2");
		a = a.replace(/zz10/g, "#F-2");
		a = a.replace(/zz11/g, "G-2");
		a = a.replace(/zz12/g, "#G-2");
		a = a.replace(/zz13/g, "A-2");
		a = a.replace(/zz14/g, "#A-2");
		a = a.replace(/zz15/g, "B-2");
		a = a.replace(/zz16/g, "C-1");
		a = a.replace(/zz17/g, "#C-1");
		a = a.replace(/zz18/g, "D-1");
		a = a.replace(/zz19/g, "#D-1");
		a = a.replace(/zz20/g, "E-1");
		a = a.replace(/zz21/g, "F-1");
		a = a.replace(/zz22/g, "#F-1");
		a = a.replace(/zz23/g, "G-1");
		a = a.replace(/zz24/g, "#G-1");
		a = a.replace(/zz25/g, "A-1");
		a = a.replace(/zz26/g, "#A-1");
		a = a.replace(/zz27/g, "B-1");
		a = a.replace(/zz28/g, "c");
		a = a.replace(/zz29/g, "#c");
		a = a.replace(/zz30/g, "d");
		a = a.replace(/zz31/g, "#d");
		a = a.replace(/zz32/g, "e");
		a = a.replace(/zz33/g, "f");
		a = a.replace(/zz34/g, "#f");
		a = a.replace(/zz35/g, "g");
		a = a.replace(/zz36/g, "#g");
		a = a.replace(/zz37/g, "a");
		a = a.replace(/zz38/g, "#a");
		a = a.replace(/zz39/g, "b");
		a = a.replace(/zz40/g, "c1");
		a = a.replace(/zz41/g, "#c1");
		a = a.replace(/zz42/g, "d1");
		a = a.replace(/zz43/g, "#d1");
		a = a.replace(/zz44/g, "e1");
		a = a.replace(/zz45/g, "f1");
		a = a.replace(/zz46/g, "#f1");
		a = a.replace(/zz47/g, "g1");
		a = a.replace(/zz48/g, "#g1");
		a = a.replace(/zz49/g, "a1");
		a = a.replace(/zz50/g, "#a1");
		a = a.replace(/zz51/g, "b1");
		a = a.replace(/zz52/g, "c2");
		a = a.replace(/zz53/g, "#c2");
		a = a.replace(/zz54/g, "d2");
		a = a.replace(/zz55/g, "#d2");
		a = a.replace(/zz56/g, "e2");
		a = a.replace(/zz57/g, "f2");
		a = a.replace(/zz58/g, "#f2");
		a = a.replace(/zz59/g, "g2");
		a = a.replace(/zz60/g, "#g2");
		a = a.replace(/zz61/g, "a2");
		a = a.replace(/zz62/g, "#a2");
		a = a.replace(/zz63/g, "b2");
		a = a.replace(/zz64/g, "c3");
		a = a.replace(/zz65/g, "#c3");
		a = a.replace(/zz66/g, "d3");
		a = a.replace(/zz67/g, "#d3");
		a = a.replace(/zz68/g, "e3");
		a = a.replace(/zz69/g, "f3");
		a = a.replace(/zz70/g, "#f3");
		a = a.replace(/zz71/g, "g3");
		a = a.replace(/zz72/g, "#g3");
		a = a.replace(/zz73/g, "a3");
		a = a.replace(/zz74/g, "#a3");
		a = a.replace(/zz75/g, "b3");
		a = a.replace(/zz76/g, "c4");
		a = a.replace(/zz77/g, "#c4");
		a = a.replace(/zz78/g, "d4");
		a = a.replace(/zz79/g, "#d4");
		a = a.replace(/zz80/g, "e4");
		a = a.replace(/zz81/g, "f4");
		a = a.replace(/zz82/g, "#f4");
		a = a.replace(/zz83/g, "g4");
		a = a.replace(/zz84/g, "#g4");
		a = a.replace(/zz85/g, "a4");
		a = a.replace(/zz86/g, "#a4");
		a = a.replace(/zz87/g, "b4");
		a = a.replace(/zz88/g, "c5");
		//正常转换
		a = a.replace(/5</g, "");
		a = a.replace(/2</g, "");
		a = a.replace(/1</g, "");
		a = a.replace(/3</g, "");
		a = a.replace(/6</g, "");
		a = a.replace(/7</g, "");
		a = a.replace(/8</g, "");
		a = a.replace(/9</g, "");
		a = a.replace(/10</g, "");
		a = a.replace(/>/g, "");
		a = a.replace(/,a/g, ",(a");
		a = a.replace(/,b/g, ",(b");
		a = a.replace(/,c/g, ",(c");
		a = a.replace(/,d/g, ",(d");
		a = a.replace(/,e/g, ",(e");
		a = a.replace(/,f/g, ",(f");
		a = a.replace(/,g/g, ",(g");
		a = a.replace(/,A/g, ",(A");
		a = a.replace(/,B/g, ",(B");
		a = a.replace(/,C/g, ",(C");
		a = a.replace(/,D/g, ",(D");
		a = a.replace(/,E/g, ",(E");
		a = a.replace(/,F/g, ",(F");
		a = a.replace(/,G/g, ",(G");
		a = a.replace(/1\[/g, "1)[");
		a = a.replace(/2\[/g, "2)[");
		a = a.replace(/3\[/g, "3)[");
		a = a.replace(/4\[/g, "4)[");
		a = a.replace(/5\[/g, "5)[");
		a = a.replace(/a\[/g, "a)[");
		a = a.replace(/b\[/g, "b)[");
		a = a.replace(/c\[/g, "c)[");
		a = a.replace(/d\[/g, "d)[");
		a = a.replace(/e\[/g, "e)[");
		a = a.replace(/f\[/g, "f)[");
		a = a.replace(/g\[/g, "g)[");
		if (a.indexOf("#") == 0 || a.indexOf("a") == 0 || a.indexOf("b") == 0 || a.indexOf("c") == 0 || a.indexOf("d") == 0 || a.indexOf("e") == 0 || a.indexOf("f") == 0 || a.indexOf("g") == 0 || a.indexOf("A") == 0 || a.indexOf("B") == 0 || a.indexOf("C") == 0 || a.indexOf("D") == 0 || a.indexOf("E") == 0 || a.indexOf("F") == 0 || a.indexOf("G") == 0 || a.indexOf("mute") == 0) {
			a = "(".concat(a);
		}
		a = a.replace(/,#/g, ",(#");
		a = a.replace(/,mute/g, ",(mute");
		j = a;
		while (j.indexOf("(") > -1) {
			b = j.indexOf("(");
			c = j.indexOf(")") + 1;
			d = j.slice(b, c);
			j = j.replace(d, "");
		}
		j = j.replace(/Q/g, "");
		j = j.replace(/R/g, "");
		j = j.replace(/S/g, "");
		j = j.replace(/T/g, "");
		j = j.replace(/U/g, "");
		j = j.replace(/V/g, "");
		j = j.replace(/W/g, "");
		j = j.replace(/X/g, "");
		j = j.replace(/Y/g, "");
		while (j.indexOf(",,") > -1) {
			j = j.replace(/,,/g, "");
		}
		a = a.replace(/H/g, "256+");
		a = a.replace(/I/g, "128+");
		a = a.replace(/J/g, "64+");
		a = a.replace(/K/g, "32+");
		a = a.replace(/L/g, "16+");
		a = a.replace(/M/g, "8+");
		a = a.replace(/N/g, "4+");
		a = a.replace(/O/g, "2+");
		a = a.replace(/P/g, "1+");
		j = j.replace(/H/g, "256+");
		j = j.replace(/I/g, "128+");
		j = j.replace(/J/g, "64+");
		j = j.replace(/K/g, "32+");
		j = j.replace(/L/g, "16+");
		j = j.replace(/M/g, "8+");
		j = j.replace(/N/g, "4+");
		j = j.replace(/O/g, "2+");
		j = j.replace(/P/g, "1+");
		while (j.indexOf("[") > -1) {
			b = j.indexOf("[");
			c = j.indexOf("]");
			d = j.slice(b + 1, c);
			l = d;
			var k = 0;
			while (d.indexOf("+") > -1) {
				e = d.indexOf("+");
				f = d.slice(0, e);
				d = d.replace(f + "+", "");
				f = parseFloat(f);
				f = f + k;
				k = f;
			}
			j = j.replace(l, f);
			j = j.replace(/\[/, "<");
			j = j.replace(/\]/, ">");
		}
		if (a.indexOf("Q") == 0 || a.indexOf("R") == 0 || a.indexOf("S") == 0 || a.indexOf("T") == 0 || a.indexOf("U") == 0 || a.indexOf("V") == 0 || a.indexOf("W") == 0 || a.indexOf("X") == 0 || a.indexOf("Y") == 0) {
			a = "[".concat(a);
		}
		a = a.replace(/Q,/g, "256+],");
		a = a.replace(/R,/g, "128+],");
		a = a.replace(/S,/g, "64+],");
		a = a.replace(/T,/g, "32+],");
		a = a.replace(/U,/g, "16+],");
		a = a.replace(/V,/g, "8+],");
		a = a.replace(/W,/g, "4+],");
		a = a.replace(/X,/g, "2+],");
		a = a.replace(/Y,/g, "1+],");
		a = a.replace(/,Q/g, ",[256+");
		a = a.replace(/,R/g, ",[128+");
		a = a.replace(/,S/g, ",[64+");
		a = a.replace(/,T/g, ",[32+");
		a = a.replace(/,U/g, ",[16+");
		a = a.replace(/,V/g, ",[8+");
		a = a.replace(/,W/g, ",[4+");
		a = a.replace(/,X/g, ",[2+");
		a = a.replace(/,Y/g, ",[1+");
		a = a.replace(/,256\+/g, ",[256+");
		a = a.replace(/,128\+/g, ",[128+");
		a = a.replace(/,64\+/g, ",[64+");
		a = a.replace(/,32\+/g, ",[32+");
		a = a.replace(/,16\+/g, ",[16+");
		a = a.replace(/,8\+/g, ",[8+");
		a = a.replace(/,4\+/g, ",[4+");
		a = a.replace(/,2\+/g, ",[2+");
		a = a.replace(/,1\+/g, ",[1+");
		a = a.replace(/\[Q/g, "[256+");
		a = a.replace(/\[R/g, "[128+");
		a = a.replace(/\[S/g, "[64+");
		a = a.replace(/\[T/g, "[32+");
		a = a.replace(/\[U/g, "[16+");
		a = a.replace(/\[V/g, "[8+");
		a = a.replace(/\[W/g, "[4+");
		a = a.replace(/\[X/g, "[2+");
		a = a.replace(/\[Y/g, "[1+");
		a = a.replace(/\++/g, "+");
		while (a.indexOf("+Q") > -1 || a.indexOf("+R") > -1 || a.indexOf("+S") > -1 || a.indexOf("+T") > -1 || a.indexOf("+U") > -1 || a.indexOf("+V") > -1 || a.indexOf("+W") > -1 || a.indexOf("+X") > -1 || a.indexOf("+Y") > -1) {
			a = a.replace(/\+Q/g, "+256+");
			a = a.replace(/\+R/g, "+128+");
			a = a.replace(/\+S/g, "+64+");
			a = a.replace(/\+T/g, "+32+");
			a = a.replace(/\+U/g, "+16+");
			a = a.replace(/\+V/g, "+8+");
			a = a.replace(/\+W/g, "+4+");
			a = a.replace(/\+X/g, "+2+");
			a = a.replace(/\+Y/g, "+1+");
		}
		a = a.replace(/mute/g, "");
		a = a.replace(/chuanshao/g, "");
		b = a.indexOf("[");
		c = a.indexOf("]");
		var soundtime = 0;
		//整理音符时间堆积
		while (a.indexOf("[") > -1) {
			b = a.indexOf("[");
			c = a.indexOf("]");
			d = a.slice(b, c + 1);
			e = d;
			d = d.replace(/\[/g, "<");
			d = d.replace(/\]/g, ">");
			a = a.replace(e, d);
			h = d;
			while (d.indexOf("+") > -1) {
				f = d.indexOf("+");
				g = d.slice(1, f);
				d = d.replace(g + "+", "");
				g = parseFloat(g);
				soundtime = soundtime + g;
			}
			if (d.indexOf("+") == -1) {
				a = a.replace(h, "<" + soundtime + ">");
			}
		}
		b = a.lastIndexOf("<");
		c = a.lastIndexOf(">") + 1;
		d = a.slice(b, c);
		a = a.replace(d, '[endnotetime]');
		while (a.indexOf("[endnotetime]") > -1) {
			b = a.lastIndexOf("<");
			c = a.lastIndexOf(">") + 1;
			if (b == -1) {
				a = a.replace("[endnotetime]", "<0>");
			} else {
				d = a.slice(b + 1, c - 1);
				a = a.replace("[endnotetime]", "[" + d + "]");
				a = a.replace("<" + d + ">", '[endnotetime]');
			}
		}
		a = a.replace("<0>", '[0]');
	}
	function Function1_a() {
		//格式化
		a = a.replace(/\[/g, '"beat":[');
		a = a.replace(/\]/g, "]");
		a = "{".concat(a);
		a = a.replace(/],/g, '],"type":1,"vol":volnum,"sound":"soundname"},');
		a = a.replace(/,\(/g, ",{(");
		a = a.replace(/},\"/g, '},{"');
		//清除休止符
		while (a.indexOf("{") > -1) {
			b = a.indexOf("{");
			c = a.indexOf("}") + 2;
			d = a.slice(b, c);
			if (d.indexOf('"') == 1) {
				a = a.replace(d, "");
			} else {
				a = a.replace("{", "<");
				a = a.replace("}", ">");
			}
		}
		a = a.replace(/</g, '{');
		a = a.replace(/>/g, "}");
		//对于全局音符音量大小的调整（如果碰到midi文件的转换时另外考虑）
		vol1 = document.getElementById("vol").value;
		vol1 = vol1.toString();
		a = a.replace(/volnum/g, vol1);
		//音符位置作进一步的调整
		a = a.replace(/\]/g, ",32]")
		a = a.replace(/\[/g, "[notetime,")
		while (a.indexOf("[") > -1) {
			b = a.indexOf("[");
			c = a.indexOf("]") + 1;
			d = a.slice(b, c);
			a = a.replace("[", "<");
			a = a.replace("]", ">");
			e = d.indexOf("notetime,") + 9;
			f = d.indexOf(",32]");
			g = d.slice(e, f);
			g = parseFloat(g);
			if (g > 32) {
				h = g / 32;
				h = Math.floor(h);
				i = g;
				a = a.replace("notetime", h);
				g = g - (h * 32);
				a = a.replace(i, g);
			} else {
				a = a.replace("notetime", "0");
				a = a.replace("0,32,", "1, 0,");
			}
		}
		a = a.replace(/</g, '[');
		a = a.replace(/>/g, ']');
		a = a.replace(/\$/g, '~');
		a = a.replace(/\&/g, '^');
		while (a.indexOf("(") > -1) {
			b = a.indexOf("(");
			c = a.indexOf(")") + 1;
			d = a.slice(b, c);
			//普通音符与和弦的处理
			if (d.indexOf("^") == -1 && d.indexOf("~") == -1 && d.indexOf("@") == -1 && d.indexOf("%") == -1 && d.indexOf("!") == -1) {
				a = a.replace("{", "<");
				a = a.replace("}", ">");
				e = a.indexOf("<");
				f = a.indexOf(">") + 1;
				g = a.slice(e, f);
				a = a.replace(d, "");
				d = d.replace("(", "");
				d = d.replace(")", "");
				a = a.replace("soundname", "midi_timbre_id/" + d + ".mp3");
			}
			//不赞成使用 ^ 与 & 字符，故与原游戏的播放效果不同
			if (d.indexOf("^") > -1) {
				a = a.replace(d, "");
				e = a.indexOf("{");
				f = a.indexOf("}") + 2;
				a = a.replace("{", "<");
				a = a.replace("}", ">");
				g = a.slice(e, f);
				d = d.replace(/@/g, '^');
				d = d.replace(/!/g, '^');
				d = d.replace(/%/g, '^');
				d = d.replace(/~/g, '^');
				d = d.replace(/\(/, '');
				d = d.replace(/\)/, '');
				k = j.indexOf("<");
				l = j.indexOf(">") + 1;
				d = d.replace(/\(/, '');
				d = d.replace(/\)/, '');
				d = d + "^" + d + "^" + d;
				m = j.slice(k, l);
				j = j.replace(m, "");
				m = m.replace("<", "");
				m = m.replace(">", "");
				n = g.indexOf(",");
				o = g.indexOf(",32");
				p = g.slice(n + 1, o);
				t = p;
				p = parseFloat(p);
				h = (d.split('^'));
				m = parseFloat(m);
				tercetsound();
			}
			//不允许琶音与连音混装在一个括号内，在连音括号内的琶音音符会转换为连音
			//连音转换
			if (d.indexOf("~") > -1) {
				a = a.replace(d, "");
				e = a.indexOf("{");
				f = a.indexOf("}") + 2;
				a = a.replace("{", "<");
				a = a.replace("}", ">");
				g = a.slice(e, f);
				d = d.replace(/@/g, '~');
				d = d.replace(/!/g, '~');
				d = d.replace(/%/g, '~');
				d = d.replace(/\(/, '');
				d = d.replace(/\)/, '');
				d = d.replace(/Q/g, "mute");
				d = d.replace(/R/g, "mute");
				d = d.replace(/S/g, "mute");
				d = d.replace(/T/g, "mute");
				d = d.replace(/U/g, "mute");
				d = d.replace(/V/g, "mute");
				d = d.replace(/W/g, "mute");
				d = d.replace(/X/g, "mute");
				d = d.replace(/Y/g, "mute");
				d = d.replace(/Z/g, "mute");
				k = j.indexOf("<");
				l = j.indexOf(">") + 1;
				m = j.slice(k, l);
				j = j.replace(m, "");
				m = m.replace("<", "");
				m = m.replace(">", "");
				n = g.indexOf(",");
				o = g.indexOf(",32");
				p = g.slice(n + 1, o);
				t = p;
				p = parseFloat(p);
				h = (d.split('~'));
				m = parseFloat(m);
				tercetsound();
			}
			//琶音转换
			if (d.indexOf("@") > -1) {
				a = a.replace(d, "");
				e = a.indexOf("{");
				f = a.indexOf("}") + 2;
				a = a.replace("{", "<");
				a = a.replace("}", ">");
				g = a.slice(e, f);
				d = d.replace(/\(/, '');
				d = d.replace(/\)/, '');
				k = j.indexOf("<");
				l = j.indexOf(">") + 1;
				m = j.slice(k, l);
				j = j.replace(m, "");
				m = m.replace("<", "");
				m = m.replace(">", "");
				n = g.indexOf(",");
				o = g.indexOf(",32");
				p = g.slice(n + 1, o);
				t = p;
				p = parseFloat(p);
				h = (d.split('@'));
				m = parseFloat(m);
				m = m / 4;
				tercetsound();
			}
			//琶音转换
			if (d.indexOf("%") > -1) {
				a = a.replace(d, "");
				e = a.indexOf("{");
				f = a.indexOf("}") + 2;
				a = a.replace("{", "<");
				a = a.replace("}", ">");
				g = a.slice(e, f);
				d = d.replace(/\(/, '');
				d = d.replace(/\)/, '');
				k = j.indexOf("<");
				l = j.indexOf(">") + 1;
				m = j.slice(k, l);
				j = j.replace(m, "");
				m = m.replace("<", "");
				m = m.replace(">", "");
				n = g.indexOf(",");
				o = g.indexOf(",32");
				p = g.slice(n + 1, o);
				t = p;
				p = parseFloat(p);
				h = (d.split('%'));
				m = parseFloat(m);
				m = m / 3;
				tercetsound();
			}
			//琶音转换
			if (d.indexOf("!") > -1) {
				a = a.replace(d, "");
				e = a.indexOf("{");
				f = a.indexOf("}") + 2;
				a = a.replace("{", "<");
				a = a.replace("}", ">");
				g = a.slice(e, f);
				d = d.replace(/\(/, '');
				d = d.replace(/\)/, '');
				k = j.indexOf("<");
				l = j.indexOf(">") + 1;
				m = j.slice(k, l);
				j = j.replace(m, "");
				m = m.replace("<", "");
				m = m.replace(">", "");
				n = g.indexOf(",");
				o = g.indexOf(",32");
				p = g.slice(n + 1, o);
				t = p;
				p = parseFloat(p);
				h = (d.split('!'));
				m = parseFloat(m);
				m = m / 2;
				tercetsound();
			}
		}
		//再次处理和弦
		while (a.indexOf("<") > -1) {
			e = a.indexOf("<");
			f = a.indexOf(">") + 1;
			a = a.replace("<", "{");
			a = a.replace(">", "}");
			g = a.slice(e, f);
			h = g.indexOf("/") + 1;
			i = g.indexOf(".mp3");
			j = g.slice(h, i);
			m = g;
			if (j.indexOf(".") > -1) {
				k = (j.split('.'));
				for (l = 0; l < k.length - 1; l++) {
					m = m + ",".concat(g);
				}
				for (l = 0; l < k.length; l++) {
					m = m.replace(j, k[l]);
				}
				a = a.replace(g, m);
			}
		}
		a = a.replace(/ /g, "");
		while (a.indexOf("midi_timbre_id/.mp3") > -1) {
			a = a.replace("midi_timbre_id/.mp3", "midi_timbre_id/mute.mp3");
		}
		a = a.replace(/{/g, "<");
		a = a.replace(/}/g, ">");
		while (a.indexOf("<") > -1) {
			e = a.indexOf("<");
			f = a.indexOf(">") + 2;
			a = a.replace("<", "{");
			a = a.replace(">", "}");
			g = a.slice(e, f);
			if (g.indexOf("mute") > -1) {
				a = a.replace(g, "");
			}
		}
		//osu
		games_type = games.value;
		if (games_type == "om") {
			a = a.replace(/},/g, "};");
			a = a.split(";");
			d_a = '\nSample,notepos,0,"notesound",volnum';
			d_sound = "";
			for (g_b = 0; g_b < a.length - 1; g_b++) {
				d_sound = d_sound + d_a;
				d_b = a[g_b];
				d_c = d_b.indexOf("[") + 1;
				d_d = d_b.indexOf("]");
				d_e = d_b.slice(d_c, d_d);
				d_e = d_e.split(",");
				d_c = d_b.indexOf('"sound":') + 9;
				d_d = d_b.indexOf("mp3") + 3;
				d_f = d_b.slice(d_c, d_d);
				d_sound = d_sound.replace("notesound", d_f);
				d_c = d_b.indexOf('"vol":') + 6;
				d_d = d_b.indexOf(',"s');
				d_f = d_b.slice(d_c, d_d);
				d_sound = d_sound.replace("volnum", d_f);
				m = document.getElementById("bpm").value;
				m = parseFloat(m);
				n = Math.floor(60000 / m);
				d_g = parseFloat(d_e[0]);
				d_g = d_g * n;
				d_h = parseFloat(d_e[1]);
				d_i = parseFloat(d_e[2]);
				d_j = n / d_i;
				d_j = d_h * d_j;
				d_g = d_g + d_j;
				d_g = Math.floor(d_g);
				d_sound = d_sound.replace("notepos", d_g);
			}
			a = d_sound;
		}
		timerstart = false;
		clock = 0;
		//对于音符中 @ ! % ~ 字符的转换
		function tercetsound() {
			q = 32 * h.length;
			u = q;
			p = p * h.length;
			r = g;
			g = g.replace("32]", q + "]");
			g = g.replace(',' + t + ',', ',' + p + ',');
			s = g;
			n = g.indexOf(",");
			o = g.indexOf("," + q);
			p = g.slice(n + 1, o);
			p = parseFloat(p);
			t = p;
			s = s.replace("," + p + ",", ",z,");
			for (i = 0; i < h.length - 1; i++) {
				s = s.concat(g);
				t = t + m;
				t = t.toFixed(0);
				t = parseFloat(t);
				s = s.replace("," + p + ",", "," + t + ",");
			}
			s = s.replace(",z,", "," + p + ",");
			for (i = 0; i < h.length; i++) {
				q = h[i];
				q = q.replace(/"/g, "");
				s = s.replace("soundname", "midi_timbre_id/" + q + ".mp3");
			}
			a = a.replace(r, s);
		}
	}
	key_value();
	function key_value() {
		setTimeout(function () {
			var keyselect = document.getElementById("key"); var keyindex = keyselect.selectedIndex; var keyvalue = keyselect.options[keyindex].value;//console.log(keyvalue);
			key_value();
		}, 200);
	}
	var windowsopen = false;
	//触摸部分，为手机、平板、导航和手表等拥有触控的设备使用
	document.addEventListener('touchstart', touch, false);
	document.addEventListener('touchmove', touch, false);
	function touch(event) {
		var distance, clientX_start, clientX_end;
		this.callbackFun = function () {
		}
		switch (event.type) {
			case "touchstart":
				clientX_start = event.touches[0].clientX;
				this.clientX_start = clientX_start;
				break;
			case "touchmove":
				if (windowsopen == false) {
					clientX_end = event.changedTouches[0].clientX;
					if (this.clientX_start + 50 < clientX_end) {
						id2 = 0;
						document.getElementById('id1').style.animation = 'board_1 1s';
						document.getElementById('id1').style.left = '0px';
						document.getElementById('id3').style.width = '100%';
					}
					if (this.clientX_start - 50 > clientX_end) {
						id2 = 1;
						document.getElementById('id1').style.animation = 'board_0 1s';
						document.getElementById('id1').style.left = '-250px';
						document.getElementById('id3').style.width = '0%';
					}
				}
				break;
		}
	}
	//窗口部分
	function about() {
		windowsopen = true;
		ff1 = true;
		document.getElementById('mask').style.display = "";
		document.getElementById("box").style.display = "";
		document.getElementById('box').style.animation = 'board_3 0.1s';
		document.getElementById('box').style.height = '30px';
		document.getElementById('box').style.width = '60%';
		const box = document.getElementById('box')
		var movex = 0;
		var movey = 0;
		var movel = 0;
		var movet = 0;
		var isDown = false;
		//鼠标按下事件
		box.onmousedown = function (movee) {
			//获取x坐标和y坐标
			movex = movee.clientX;
			movey = movee.clientY;
			//获取左部和顶部的偏移量
			movel = box.offsetLeft;
			movet = box.offsetTop;
			//开关打开
			isDown = true;
			//设置样式
			box.style.cursor = 'move';
		}
		//鼠标移动
		window.onmousemove = function (movee) {
			if (isDown == false) {
				return;
			}
			//获取x和y
			var movenx = movee.clientX;
			var moveny = movee.clientY;
			//计算移动后的左偏移量和顶部的偏移量
			var movenl = movenx - (movex - movel);
			var movent = moveny - (movey - movet);

			box.style.left = movenl + 'px';
			box.style.top = movent + 'px';
		}
		//鼠标抬起事件
		box.onmouseup = function () {
			//开关关闭
			isDown = false;
			box.style.cursor = 'default';
		}
	}
	function id0() {
		windowsopen = true;
		fg1 = true;
		document.getElementById('mask').style.display = "";
		document.getElementById("lang").style.display = "";
		document.getElementById('lang').style.animation = 'board_3 0.1s';
		document.getElementById('lang').style.height = '30px';
		document.getElementById('lang').style.width = '60%';
		const box = document.getElementById('lang')
		var movex = 0;
		var movey = 0;
		var movel = 0;
		var movet = 0;
		var isDown = false;
		//鼠标按下事件
		box.onmousedown = function (movee) {
			//获取x坐标和y坐标
			movex = movee.clientX;
			movey = movee.clientY;
			//获取左部和顶部的偏移量
			movel = box.offsetLeft;
			movet = box.offsetTop;
			//开关打开
			isDown = true;
			//设置样式
			box.style.cursor = 'move';
		}
		//鼠标移动
		window.onmousemove = function (movee) {
			if (isDown == false) {
				return;
			}
			//获取x和y
			var movenx = movee.clientX;
			var moveny = movee.clientY;
			//计算移动后的左偏移量和顶部的偏移量
			var movenl = movenx - (movex - movel);
			var movent = moveny - (movey - movet);

			box.style.left = movenl + 'px';
			box.style.top = movent + 'px';
		}
		//鼠标抬起事件
		box.onmouseup = function () {
			//开关关闭
			isDown = false;
			box.style.cursor = 'default';
		}
	}
	function note() {
		windowsopen = true;
		fe1 = true;
		document.getElementById('mask').style.display = "";
		document.getElementById("note").style.display = "";
		document.getElementById('note').style.animation = 'board_5 0.1s';
		document.getElementById('note').style.height = '30px';
		document.getElementById('note').style.width = '80%';
		var box = document.getElementById('note');
		var movex = 0;
		var movey = 0;
		var movel = 0;
		var movet = 0;
		var isDown = false;
		//鼠标按下事件
		box.onmousedown = function (movee) {
			//获取x坐标和y坐标
			movex = movee.clientX;
			movey = movee.clientY;
			//获取左部和顶部的偏移量
			movel = box.offsetLeft;
			movet = box.offsetTop;
			//开关打开
			isDown = true;
			//设置样式
			box.style.cursor = 'move';
		}
		//鼠标移动
		window.onmousemove = function (movee) {
			if (isDown == false) {
				return;
			}
			//获取x和y
			var movenx = movee.clientX;
			var moveny = movee.clientY;
			//计算移动后的左偏移量和顶部的偏移量
			var movenl = movenx - (movex - movel);
			var movent = moveny - (movey - movet);

			box.style.left = movenl + 'px';
			box.style.top = movent + 'px';
		}
		//鼠标抬起事件
		box.onmouseup = function () {
			//开关关闭
			isDown = false;
			box.style.cursor = 'default';
		}
	}
	function select() {
		windowsopen = true;
		fl1 = true;
		document.getElementById("id20").style.backgroundColor = "#fb7299";
		document.getElementById("id20").style.color = "#fff";
		document.getElementById('mask').style.display = "";
		document.getElementById("select").style.display = "";
		document.getElementById('select').style.animation = 'board_3 0.1s';
		document.getElementById('select').style.height = '30px';
		document.getElementById('select').style.width = '60%';
		const box = document.getElementById('select')
		var movex = 0;
		var movey = 0;
		var movel = 0;
		var movet = 0;
		var isDown = false;
		//鼠标按下事件
		box.onmousedown = function (movee) {
			//获取x坐标和y坐标
			movex = movee.clientX;
			movey = movee.clientY;
			//获取左部和顶部的偏移量
			movel = box.offsetLeft;
			movet = box.offsetTop;
			//开关打开
			isDown = true;
			//设置样式
			box.style.cursor = 'move';
		}
		//鼠标移动
		window.onmousemove = function (movee) {
			if (isDown == false) {
				return;
			}
			//获取x和y
			var movenx = movee.clientX;
			var moveny = movee.clientY;
			//计算移动后的左偏移量和顶部的偏移量
			var movenl = movenx - (movex - movel);
			var movent = moveny - (movey - movet);

			box.style.left = movenl + 'px';
			box.style.top = movent + 'px';
		}
		//鼠标抬起事件
		box.onmouseup = function () {
			//开关关闭
			isDown = false;
			box.style.cursor = 'default';
		}
	}
	function next() {
		windowsopen = true;
		document.getElementById("id20").style.backgroundColor = "#fb7299";
		document.getElementById("id20").style.color = "#fff";
		document.getElementById('mask').style.display = "";
		document.getElementById("next").style.display = "";
		document.getElementById('next').style.animation = 'board_3 0.1s';
		document.getElementById('next').style.height = '30px';
		document.getElementById('next').style.width = '60%';
		const box = document.getElementById('next')
		var movex = 0;
		var movey = 0;
		var movel = 0;
		var movet = 0;
		var isDown = false;
		//鼠标按下事件
		box.onmousedown = function (movee) {
			//获取x坐标和y坐标
			movex = movee.clientX;
			movey = movee.clientY;
			//获取左部和顶部的偏移量
			movel = box.offsetLeft;
			movet = box.offsetTop;
			//开关打开
			isDown = true;
			//设置样式
			box.style.cursor = 'move';
		}
		//鼠标移动
		window.onmousemove = function (movee) {
			if (isDown == false) {
				return;
			}
			//获取x和y
			var movenx = movee.clientX;
			var moveny = movee.clientY;
			//计算移动后的左偏移量和顶部的偏移量
			var movenl = movenx - (movex - movel);
			var movent = moveny - (movey - movet);

			box.style.left = movenl + 'px';
			box.style.top = movent + 'px';
		}
		//鼠标抬起事件
		box.onmouseup = function () {
			//开关关闭
			isDown = false;
			box.style.cursor = 'default';
		}
	}
	function view_window() {
		windowsopen = true;
		document.getElementById("id20").style.backgroundColor = "#fb7299";
		document.getElementById("id20").style.color = "#fff";
		document.getElementById('mask').style.display = "";
		document.getElementById("view_window").style.display = "";
		document.getElementById('view_window').style.animation = 'board_3 0.1s';
		document.getElementById('view_window').style.height = '30px';
		document.getElementById('view_window').style.width = '60%';
		if (windowmax == false) {
			const box = document.getElementById('view_window');
			var movex = 0;
			var movey = 0;
			var movel = 0;
			var movet = 0;
			var isDown = false;
			//鼠标按下事件
			box.onmousedown = function (movee) {
				//获取x坐标和y坐标
				movex = movee.clientX;
				movey = movee.clientY;
				//获取左部和顶部的偏移量
				movel = box.offsetLeft;
				movet = box.offsetTop;
				//开关打开
				isDown = true;
				//设置样式
				box.style.cursor = 'move';
			}
			//鼠标移动
			window.onmousemove = function (movee) {
				if (isDown == false) {
					return;
				}
				//获取x和y
				var movenx = movee.clientX;
				var moveny = movee.clientY;
				//计算移动后的左偏移量和顶部的偏移量
				var movenl = movenx - (movex - movel);
				var movent = moveny - (movey - movet);
				box.style.left = movenl + 'px';
				box.style.top = movent + 'px';
				//鼠标抬起事件
				box.onmouseup = function () {
					view_window();
					if (movee.clientY < 15) {
						windowmax = true;
						view_window();
						boxmax2.innerHTML = '<b style="z-index: 1;">□</b><div style="z-index: 2;background:#fff;height:11px;width: 11px;position: absolute;top:9px;right: 14px;"></div><b class="boxmax1">□</b>';
						document.getElementById('view_window').style.width = '100%';
						document.getElementById('view_window').style.height = '100%';
						document.getElementById('view_window').style.left = '0px';
						document.getElementById('view_window').style.top = '0px';
						document.getElementById('view_window').style.borderRadius = '0px 0px 0px 0px';
						//开关关闭
						isDown = false;
						box.style.cursor = 'default';
					}
				}
			}
		} else {
			const box = document.getElementById('view_window');
			var movex = 0;
			var movey = 0;
			var movel = 0;
			var movet = 0;
			var isDown = false;
			//鼠标按下事件
			box.onmousedown = function (movee) {
				//获取x坐标和y坐标
				movex = movee.clientX;
				movey = movee.clientY;
				//获取左部和顶部的偏移量
				movel = box.offsetLeft;
				movet = box.offsetTop;
				//开关打开
				isDown = true;
				//设置样式
				box.style.cursor = 'move';
			}
			//鼠标移动
			window.onmousemove = function (movee) {
				if (isDown == false) {
					return;
				}
				document.getElementById('view_window').style.width = '60%';
				document.getElementById('view_window').style.height = '60%';
				document.getElementById('view_window').style.borderRadius = '5px 5px 0px 0px';
				//获取x和y
				var movenx = movee.clientX;
				var moveny = movee.clientY;
				box.onmouseup = function () {
					windowmax = false;
					view_window();
					boxmax2.innerHTML = '□';
					if (movee.clientY < 15) {
						windowmax = true;
						view_window();
						boxmax2.innerHTML = '<b style="z-index: 1;">□</b><div style="z-index: 2;background:#fff;height:11px;width: 11px;position: absolute;top:9px;right: 14px;"></div><b class="boxmax1">□</b>';
						document.getElementById('view_window').style.width = '100%';
						document.getElementById('view_window').style.height = '100%';
						document.getElementById('view_window').style.left = '0px';
						document.getElementById('view_window').style.top = '0px';
						document.getElementById('view_window').style.borderRadius = '0px 0px 0px 0px';
					}
				}
				//计算移动后的左偏移量和顶部的偏移量
				var movenl = movenx - (movex - movel)/2;
				var movent = moveny - (movey - movet)/2;

				box.style.left = movenl + 'px';
				box.style.top = movent + 'px';
			}
			//鼠标抬起事件
			box.onmouseup = function () {
				//开关关闭
				isDown = false;
				box.style.cursor = 'default';
			}
		}
	}
	//窗口隐藏部分
	function hidder() {
		fe1 = false;
		ff1 = false;
		fg1 = false;
		windowsopen = false;
		if (fl1 == true) {
			document.onkeydown = keyDown;
			keyDown();
			fl1 = false;
		}
		fh1 = 0;
		document.getElementById('vol').style.border = '1px solid #ddd';
		document.getElementById('songselect').innerHTML = "";
		document.getElementById('box').style.animation = 'board_4 0.1s';
		document.getElementById('box').style.height = '0px';
		document.getElementById('box').style.width = '0%';
		document.getElementById('lang').style.animation = 'board_4 0.1s';
		document.getElementById('lang').style.height = '0px';
		document.getElementById('lang').style.width = '0%';
		document.getElementById('select').style.animation = 'board_4 0.1s';
		document.getElementById('select').style.height = '0px';
		document.getElementById('select').style.width = '0%';
		document.getElementById('note').style.animation = 'board_6 0.1s';
		document.getElementById('note').style.height = '0px';
		document.getElementById('note').style.width = '0%';
		document.getElementById('note').style.left = "10%";
		document.getElementById('note').style.top = "10%";
		document.getElementById('lang').style.left = "20%";
		document.getElementById('lang').style.top = "25%";
		document.getElementById('box').style.left = "20%";
		document.getElementById('box').style.top = "25%";
		document.getElementById('select').style.left = "20%";
		document.getElementById('select').style.top = "25%";
		document.getElementById('next').style.animation = 'board_4 0.1s';
		document.getElementById('next').style.height = '0px';
		document.getElementById('next').style.width = '0%';
		document.getElementById('next').style.left = "20%";
		document.getElementById('next').style.top = "25%";
		aboutoff();
		langoff();
		noteoff();
		selectoff();
		nextoff();
		function aboutoff() {
			setTimeout(function () { document.getElementById('box').style.display = "none"; }, 100);
		}
		function langoff() {
			setTimeout(function () { document.getElementById('lang').style.display = "none"; }, 100);
		}
		function noteoff() {
			setTimeout(function () { document.getElementById('note').style.display = "none"; }, 100);
		}
		function selectoff() {
			setTimeout(function () { document.getElementById('select').style.display = "none"; }, 100);
		}
		function nextoff() {
			setTimeout(function () { document.getElementById('next').style.display = "none"; }, 100);
		}
		setTimeout(function () { document.getElementById('mask').style.display = "none"; }, 100);
	}
	//菜单部分
	function menu() {
		if (id2 % 2 == 0) {
			id2 = 1;
			document.getElementById('id1').style.animation = 'board_0 1s';
			document.getElementById('id1').style.left = '-250px';
			document.getElementById('id3').style.width = '0%';
		} else {
			id2 = 0;
			document.getElementById('id1').style.animation = 'board_1 1s';
			document.getElementById('id1').style.left = '0px';
			document.getElementById('id3').style.width = '100%';
		}
	}
	function back() {
		sound3();
		warnoff();
		if (windowsopen == true) {
			hidder();
		} else {
			id2 = 1;
			progressoff();
			document.getElementById('id1').style.animation = 'board_0 1s';
			document.getElementById('id1').style.left = '-250px';
			document.getElementById('id3').style.width = '0%';
			document.getElementById('warning').style.animation = 'warning_2 0.1s';
			document.getElementById('warning').style.width = '0%';
			document.getElementById('warning').style.height = '0px';
			document.getElementById('warning').style.left = '50%';
			warning.innerHTML = "";
			fk1 = false;
		}
	}
	pushHistory();
	window.addEventListener("popstate", function () {
		back();
		pushHistory();
	}, false);
	function pushHistory() {
		var state = {
			title: "title",
			url: "#"
		};
		window.history.pushState(state, "title", "#");
	}
	//按键监听部分，为电视遥控器操作使用（不做竖屏状态下的光标处理，虽然对竖屏不友好，但可以勉强使用，本人懒癌晚期）
	var fa1 = 0, fb1 = 0, fc1 = 1, fd1 = 1, fe1 = false, ff1 = false, fg1 = false, fh1 = 1, fi1 = 1, fj1 = 1, fk1 = false; fl1 = false;
	document.onkeydown = keyDown;
	function keyDown() {
		if (event.keyCode == 27) {
			back();
		}
		window.addEventListener('popstate', function (event) {
			back();
			pushHistory();
		});
		if (event.keyCode == 93) {
			menu();
			document.getElementById('warning').style.animation = 'warning_2 0.1s';
			document.getElementById('warning').style.width = '0%';
			document.getElementById('warning').style.height = '0px';
			document.getElementById('warning').style.left = '50%';
			warning.innerHTML = "";
			warnoff();
			fk1 = false;
			fb1 = 0;
		}
		if (event.keyCode == 13) {
			if (fe1 == false && ff1 == false && fg1 == false && fl1 == false) {
				enter();
			}
			else if (fe1 == true) {
				enter1();
			}
			else if (ff1 == true) {
				enter2();
			}
			else if (fg1 == true) {
				enter3();
			}
		}
		if (fk1 == false) {
			if (event.keyCode == 37) {
				if (fh1 == 13) {
					vol2();
				}
				if (fe1 == false && ff1 == false && fg1 == false && fl1 == false) {
					fa1 = fa1 - 1;
					fa2();
				}
				if (fe1 == true) {
					if (fh1 == 12) {
						fh1 = fh1 - 1;
					}
					fe2();
				}
			}
			if (event.keyCode == 38) {
				if (fe1 == false && ff1 == false && fg1 == false && fl1 == false) {
					if (fa1 == 0) {
						if (id2 == 0) {
							fb1 = fb1 - 1;
							fb2();
						} else {
							fb1 = 0;
						}
					}
					if (fa1 == 1) {
						fc1 = fc1 - 1;
						fc2();
					}
					if (fa1 == 2) {
						fd1 = fd1 - 1;
						fd2();
					}
				}
				if (fe1 == true) {
					fh1 = fh1 - 1;
					if (fh1 == 11) {
						fh1 = 10;
					}
					fe2();
				}
				if (ff1 == true) {
					fi1 = fi1 - 1;
					ff2();
				}
				if (fg1 == true) {
					fj1 = fj1 - 1;
					fg2();
				}
			}
			if (event.keyCode == 39) {
				if (fh1 == 13) {
					vol2();
				}
				if (fe1 == false && ff1 == false && fg1 == false && fl1 == false) {
					fa1 = fa1 + 1;
					fa2();
				}
				if (fe1 == true) {
					if (fh1 == 11) {
						fh1 = fh1 + 1;
					}
					fe2();
				}
			}
			if (event.keyCode == 40) {
				if (fa1 == 3) {
					fa1 = 2;
					fc1 = 0;
					fd1 = 0;
					document.getElementById('id22').style.backgroundColor = "#FB7299";
				}
				if (fe1 == false && ff1 == false && fg1 == false && fl1 == false) {
					if (fa1 == 0) {
						if (id2 == 0) {
							fb1 = fb1 + 1;
							fb2();
						} else {
							fb1 = 0;
							if (fa1 == 0) {
								fa1 = 1;
								fc1 = 0;
							}
						}
					}
					if (fa1 == 1) {
						fc1 = fc1 + 1;
						fc2();
					}
					if (fa1 == 2) {
						fd1 = fd1 + 1;
						fd2();
					}
				}
				if (fe1 == true) {
					fh1 = fh1 + 1;
					if (fh1 == 12) {
						fh1 = 13;
					}
					fe2();
				}
				if (ff1 == true) {
					fi1 = fi1 + 1;
					ff2();
				}
				if (fg1 == true) {
					fj1 = fj1 + 1;
					fg2();
				}
			}
		}
	}
	function fe2() {
		if (fh1 < 0) {
			fh1 = 0;
		}
		if (fh1 > 16) {
			fh1 = 16;
		}
		if (fh1 == 0 || fh1 == -1) {
			document.getElementById("boxoff1").focus();
			document.getElementById('boxoff1').style.backgroundColor = "#FB7299";
			document.getElementById('boxoff1').style.color = "#fff";
		}
		if (fh1 == 1) {
			document.getElementById("note1").focus();
			document.getElementById('boxoff1').style.backgroundColor = "#fff";
			document.getElementById('boxoff1').style.color = "#555";
		}
		if (fh1 == 2) {
			document.getElementById("note2").focus();
		}
		if (fh1 == 3) {
			document.getElementById("note3").focus();
		}
		if (fh1 == 4) {
			document.getElementById("note4").focus();
		}
		if (fh1 == 5) {
			document.getElementById("note5").focus();
		}
		if (fh1 == 6) {
			document.getElementById("note6").focus();
		}
		if (fh1 == 7) {
			document.getElementById("note7").focus();
		}
		if (fh1 == 8) {
			document.getElementById("notewidth").focus();
		}
		if (fh1 == 9) {
			document.getElementById("sound").focus();
		}
		if (fh1 == 10) {
			document.getElementById("reverse").focus();
			document.getElementById('soundup').style.backgroundColor = "#FB7299";
			document.getElementById('soundup').style.color = "#fff";
			document.getElementById('sounddown').style.backgroundColor = "#FB7299";
			document.getElementById('sounddown').style.color = "#fff";
		}
		if (fh1 == 11) {
			document.getElementById("soundup").focus();
			document.getElementById('soundup').style.backgroundColor = "#72fbbb";
			document.getElementById('soundup').style.color = "#000";
			document.getElementById('sounddown').style.backgroundColor = "#FB7299";
			document.getElementById('sounddown').style.color = "#fff";
		}
		if (fh1 == 12) {
			document.getElementById("sounddown").focus();
			document.getElementById('sounddown').style.backgroundColor = "#72fbbb";
			document.getElementById('sounddown').style.color = "#000";
			document.getElementById('soundup').style.backgroundColor = "#FB7299";
			document.getElementById('soundup').style.color = "#fff";
			document.getElementById('vol').style.border = '1px solid #ddd';
		}
		if (fh1 == 13) {
			document.getElementById("vol").focus();
			document.getElementById('soundup').style.backgroundColor = "#FB7299";
			document.getElementById('soundup').style.color = "#fff";
			document.getElementById('sounddown').style.backgroundColor = "#FB7299";
			document.getElementById('sounddown').style.color = "#fff";
			document.getElementById('vol').style.border = '2px solid #444';
			vol2();
		}
		if (fh1 == 14) {
			document.getElementById("note8").focus();
			document.getElementById('vol').style.border = '1px solid #ddd';
		}
		if (fh1 == 15) {
			document.getElementById("note9").focus();
			document.getElementById('ok1').style.backgroundColor = "#fff";
			document.getElementById('ok1').style.color = "#555";
		}
		if (fh1 == 16) {
			document.getElementById("ok1").focus();
			document.getElementById('ok1').style.backgroundColor = "#FB7299";
			document.getElementById('ok1').style.color = "#fff";
		}
	}
	function ff2() {
		if (fi1 < 0) {
			fi1 = 0;
		}
		if (fi1 > 1) {
			fi1 = 1;
		}
		if (fi1 == 0 || fi1 == -1) {
			document.getElementById("boxoff2").focus();
			document.getElementById('boxoff2').style.backgroundColor = "#FB7299";
			document.getElementById('boxoff2').style.color = "#fff";
			document.getElementById('ok2').style.backgroundColor = "#fff";
			document.getElementById('ok2').style.color = "#555";
		}
		if (fi1 == 1) {
			document.getElementById('boxoff2').style.backgroundColor = "#fff";
			document.getElementById('boxoff2').style.color = "#555";
			document.getElementById("ok2").focus();
			document.getElementById('ok2').style.backgroundColor = "#FB7299";
			document.getElementById('ok2').style.color = "#fff";
		}
	}
	function fg2() {
		if (fj1 < 0) {
			fj1 = 0;
		}
		if (fj1 > 3) {
			fj1 = 3;
		}
		if (fj1 == 0 || fj1 == -1) {
			document.getElementById("boxoff3").focus();
			document.getElementById('boxoff3').style.backgroundColor = "#FB7299";
			document.getElementById('boxoff3').style.color = "#fff";
			document.getElementById('zh_cn').style.backgroundColor = "#fff";
			document.getElementById('zh_cn').style.color = "#555";
		}
		if (fj1 == 1) {
			document.getElementById("zh_cn").focus();
			document.getElementById('zh_cn').style.backgroundColor = "#76b9f8";
			document.getElementById('zh_cn').style.color = "#fff";
			document.getElementById('zh_tw').style.backgroundColor = "#fff";
			document.getElementById('zh_tw').style.color = "#555";
			document.getElementById('boxoff3').style.backgroundColor = "#fff";
			document.getElementById('boxoff3').style.color = "#555";
		}
		if (fj1 == 2) {
			document.getElementById("zh_tw").focus();
			document.getElementById('zh_tw').style.backgroundColor = "#76b9f8";
			document.getElementById('zh_tw').style.color = "#fff";
			document.getElementById('zh_cn').style.backgroundColor = "#fff";
			document.getElementById('zh_cn').style.color = "#555";
			document.getElementById('ok3').style.backgroundColor = "#fff";
			document.getElementById('ok3').style.color = "#555";
		}
		if (fj1 == 3) {
			document.getElementById("ok3").focus();
			document.getElementById('zh_tw').style.backgroundColor = "#fff";
			document.getElementById('zh_tw').style.color = "#555";
			document.getElementById('ok3').style.backgroundColor = "#FB7299";
			document.getElementById('ok3').style.color = "#fff";
		}
	}
	function fc2() {
		if (fc1 < 0) {
			fc1 = 0;
		}
		if (fc1 > 3) {
			fc1 = 3;
		}
		if (fc1 == 0) {
			fa1 = 0;
			fb1 = 0;
			document.getElementById("id16").focus();
			document.getElementById('id16').style.backgroundColor = "#72fbbb";
			document.getElementById('file').style.backgroundColor = "#FB7299";
			document.getElementById('file').style.color = "#fff";
			if (fd1 == 3) {
				document.getElementById('id16').style.backgroundColor = "#fb7299";
				document.getElementById("input").focus();
				fc1 = 2;
				fd1 = 2;
				fa1 = 1;
			}
		}
		if (fc1 == 1) {
			document.getElementById("file").focus();
			document.getElementById('id16').style.backgroundColor = "#FB7299";
			document.getElementById('file').style.backgroundColor = "#72fbbb";
			document.getElementById('file').style.color = "#000";
		}
		if (fc1 == 2) {
			document.getElementById("input").focus();
			document.getElementById('file').style.backgroundColor = "#FB7299";
			document.getElementById('file').style.color = "#fff";
			document.getElementById('id21').style.backgroundColor = "#FB7299";
			document.getElementById('id21').style.color = "#fff";
		}
		if (fc1 == 3) {
			document.getElementById("id21").focus();
			document.getElementById('id21').style.backgroundColor = "#72fbbb";
			document.getElementById('id21').style.color = "#000";
			if (fa1 == 3) {
				fc1 = 0;
			}
		}
	}
	function fd2() {
		if (fd1 < 0) {
			fd1 = 0;
		}
		if (fd1 > 3) {
			fd1 = 3;
		}
		if (fd1 == 0) {
			fa1 = 0;
			fb1 = 0;
			document.getElementById("id16").focus();
			document.getElementById('id16').style.backgroundColor = "#72fbbb";
			document.getElementById('id20').style.backgroundColor = "#FB7299";
			document.getElementById('id20').style.color = "#fff";
		}
		if (fd1 == 1) {
			document.getElementById("id20").focus();
			document.getElementById('id16').style.backgroundColor = "#FB7299";
			document.getElementById('id20').style.backgroundColor = "#72fbbb";
			document.getElementById('id20').style.color = "#000";
		}
		if (fd1 == 2) {
			document.getElementById("result").focus();
			document.getElementById('id20').style.backgroundColor = "#FB7299";
			document.getElementById('id20').style.color = "#fff";
			document.getElementById('id21').style.backgroundColor = "#FB7299";
			document.getElementById('id21').style.color = "#fff";
		}
		if (fd1 == 3) {
			document.getElementById("id21").focus();
			document.getElementById('id21').style.backgroundColor = "#72fbbb";
			document.getElementById('id21').style.color = "#000";
			if (fa1 == 1) {
				document.getElementById("id16").focus();
				document.getElementById('id16').style.backgroundColor = "#72fbbb";
				document.getElementById('id21').style.color = "#fff";
				document.getElementById('id21').style.backgroundColor = "#FB7299";
			}
			if (fa1 == 2 && fc1 == 2) {
				fc1 = 3;
			}
		}
	}
	function fa2() {
		if (fa1 < 0) {
			fa1 = 0;
		}
		if (fa1 > 3) {
			fa1 = 3;
		}
		if (fa1 == 0) {
			document.getElementById("id16").focus();
			fc1 = 1;
			fb1 = 0;
			fd1 = 1;
			document.getElementById('id16').style.backgroundColor = "#72fbbb";
			document.getElementById('file').style.backgroundColor = "#FB7299";
			document.getElementById('file').style.color = "#fff";
			document.getElementById('id21').style.backgroundColor = "#FB7299";
			document.getElementById('id21').style.color = "#fff";
		}
		if (fa1 == 1) {
			if (fd1 == 2) {
				document.getElementById("input").focus();
				document.getElementById('id16').style.backgroundColor = "#FB7299";
				document.getElementById('id16').style.color = "#fff";
				fc1 = 2;
			}
			if (fd1 == 1) {
				document.getElementById("file").focus();
				fc1 = 1;
				document.getElementById('id16').style.backgroundColor = "#FB7299";
				document.getElementById('id20').style.backgroundColor = "#FB7299";
				document.getElementById('file').style.backgroundColor = "#72fbbb";
				document.getElementById('file').style.color = "#000";
				document.getElementById('id20').style.color = "#fff";
			}
			if (fd1 == 3) {
				fd1 = 1;
				fc1 = 1;
				fa1 = 0;
				document.getElementById('id21').style.backgroundColor = "#FB7299";
				document.getElementById('id16').style.backgroundColor = "#72fbbb";
				document.getElementById('id21').style.color = "#fff";
				document.getElementById("id16").focus();
			}
		}
		if (fa1 == 2) {
			if (fc1 == 3 && fd1 == 3) {
				fa1 = 1;
				fc1 = 0;
			}
			if (fc1 == 0) {
				document.getElementById('id22').style.backgroundColor = '#fb7299';
				document.getElementById("id21").focus();
				document.getElementById('id21').style.color = "#000";
				document.getElementById('id21').style.backgroundColor = "#72fbbb";
			}
			if (fc1 == 2) {
				document.getElementById("result").focus();
				document.getElementById('id16').style.backgroundColor = "#FB7299";
				document.getElementById('id16').style.color = "#fff";
				fd1 = 2;
				document.getElementById('id22').style.backgroundColor = '#fb7299';
			}
			if (fc1 == 3) {
				document.getElementById('id21').style.backgroundColor = "#72fbbb";
				document.getElementById('id22').style.backgroundColor = '#fb7299';
				document.getElementById('id21').style.color = "#000";
				fa1 = 2;
				fd1 = 3;
				if (fa1 == 2) {
					fa1 = 3;
					fc1 = 0;
				}
			}
			if (fc1 == 1) {
				if (fd1 == 3) {
				} else {
					document.getElementById("id20").focus();
					fd1 = 1;
					document.getElementById('file').style.backgroundColor = "#FB7299";
					document.getElementById('id20').style.backgroundColor = "#72fbbb";
					document.getElementById('id22').style.backgroundColor = '#fb7299';
					document.getElementById('id20').style.color = "#000";
					document.getElementById('file').style.color = "#fff";
				}
			}
			if (fd1 == 3) {
				document.getElementById("id21").focus();
				document.getElementById('id21').style.backgroundColor = "#72fbbb";
				document.getElementById('id21').style.color = "#000";
				document.getElementById('id22').style.backgroundColor = "#FB7299";
			}
			if (fc1 == 3 && fd1 == 1) {
				fa1 = 3;
				fc1 = 1;
				fd1 = 1;
			}
		}
		if (fa1 == 3) {
			if (fc1 == 2 && fd1 == 2) {
				fc1 = 1;
				fd1 = 1;
			}
			document.getElementById('id22').style.backgroundColor = '#72fbbb';
			document.getElementById("id22").focus();
			document.getElementById('id21').style.backgroundColor = "#FB7299";
			document.getElementById('id21').style.color = "#fff";
			document.getElementById('id20').style.backgroundColor = "#FB7299";
			document.getElementById('id20').style.color = "#fff";
		}
	}
	function fb2() {
		if (fb1 < 0) {
			fb1 = 0;
		}
		if (fb1 > 13) {
			fb1 = 13;
		}
		switch (fb1) {
			case 0:
				document.getElementById("id16").focus();
				document.getElementById('move1').style.backgroundColor = "#66ccff";
				document.getElementById('move1').style.color = "#000";
				document.getElementById('id16').style.backgroundColor = "#72fbbb";
				fa1 = 0;
				fc1 = 1;
				fd1 = 1;
				break;
			case 1:
				document.getElementById("bpm").focus();
				document.getElementById('id16').style.backgroundColor = "#FB7299";
				document.getElementById('move1').style.color = "#FB7299";
				document.getElementById('move1').style.backgroundColor = "#aaddff";
				document.getElementById('move2').style.backgroundColor = "#66ccff";
				document.getElementById('move2').style.color = "#000";
				break;
			case 2:
				document.getElementById("beats").focus();
				document.getElementById('move2').style.color = "#FB7299";
				document.getElementById('move2').style.backgroundColor = "#aaddff";
				document.getElementById('move1').style.backgroundColor = "#66ccff";
				document.getElementById('move1').style.color = "#000";
				document.getElementById('move3').style.backgroundColor = "#66ccff";
				document.getElementById('move3').style.color = "#000";
				break;
			case 3:
				document.getElementById("acc").focus();
				document.getElementById('move3').style.color = "#FB7299";
				document.getElementById('move3').style.backgroundColor = "#aaddff";
				document.getElementById('move2').style.backgroundColor = "#66ccff";
				document.getElementById('move2').style.color = "#000";
				document.getElementById('move4').style.backgroundColor = "#66ccff";
				document.getElementById('move4').style.color = "#000";
				break;
			case 4:
				document.getElementById('move4').style.color = "#FB7299";
				document.getElementById("move4").focus();
				document.getElementById('move4').style.backgroundColor = "#aaddff";
				document.getElementById('move3').style.backgroundColor = "#66ccff";
				document.getElementById('move3').style.color = "#000";
				document.getElementById('move5').style.backgroundColor = "#66ccff";
				document.getElementById('move5').style.color = "#000";
				break;
			case 5:
				document.getElementById('move5').style.color = "#FB7299";
				document.getElementById("move5").focus();
				document.getElementById('move5').style.backgroundColor = "#aaddff";
				document.getElementById('move4').style.backgroundColor = "#66ccff";
				document.getElementById('move4').style.color = "#000";
				document.getElementById('move6').style.backgroundColor = "#66ccff";
				document.getElementById('move6').style.color = "#000";
				break;
			case 6:
				document.getElementById("move6").focus();
				document.getElementById('move6').style.color = "#FB7299";
				document.getElementById('move6').style.backgroundColor = "#aaddff";
				document.getElementById('move5').style.backgroundColor = "#66ccff";
				document.getElementById('move5').style.color = "#000";
				document.getElementById('move7').style.backgroundColor = "#66ccff";
				document.getElementById('move7').style.color = "#000";
				break;
			case 7:
				document.getElementById("move7").focus();
				document.getElementById('move7').style.color = "#FB7299";
				document.getElementById('move7').style.backgroundColor = "#aaddff";
				document.getElementById('move6').style.backgroundColor = "#66ccff";
				document.getElementById('move6').style.color = "#000";
				document.getElementById('move8').style.backgroundColor = "#66ccff";
				document.getElementById('move8').style.color = "#000";
				break;
			case 8:
				document.getElementById("move8").focus();
				document.getElementById('move8').style.color = "#FB7299";
				document.getElementById('move8').style.backgroundColor = "#aaddff";
				document.getElementById('move7').style.backgroundColor = "#66ccff";
				document.getElementById('move7').style.color = "#000";
				document.getElementById('move9').style.backgroundColor = "#66ccff";
				document.getElementById('move9').style.color = "#000";
				break;
			case 9:
				document.getElementById("move9").focus();
				document.getElementById('move9').style.color = "#FB7299";
				document.getElementById('move9').style.backgroundColor = "#aaddff";
				document.getElementById('move8').style.backgroundColor = "#66ccff";
				document.getElementById('move8').style.color = "#000";
				document.getElementById('move10').style.backgroundColor = "#66ccff";
				document.getElementById('move10').style.color = "#000";
				break;
			case 10:
				document.getElementById("move10").focus();
				document.getElementById('move10').style.color = "#FB7299";
				document.getElementById('move10').style.backgroundColor = "#aaddff";
				document.getElementById('move9').style.backgroundColor = "#66ccff";
				document.getElementById('move9').style.color = "#000";
				document.getElementById('isFull').style.backgroundColor = "#66ccff";
				document.getElementById('isFull').style.color = "#000";
				break;
			case 11:
				document.getElementById("isFull").focus();
				document.getElementById('isFull').style.color = "#FB7299";
				document.getElementById('isFull').style.backgroundColor = "#aaddff";
				document.getElementById('move10').style.backgroundColor = "#66ccff";
				document.getElementById('move10').style.color = "#000";
				document.getElementById('move11').style.backgroundColor = "#66ccff";
				document.getElementById('move11').style.color = "#000";
				break;
			case 12:
				document.getElementById("move11").focus();
				document.getElementById('move11').style.color = "#FB7299";
				document.getElementById('move11').style.backgroundColor = "#aaddff";
				document.getElementById('isFull').style.backgroundColor = "#66ccff";
				document.getElementById('isFull').style.color = "#000";
				document.getElementById('move12').style.backgroundColor = "#66ccff";
				document.getElementById('move12').style.color = "#000";
				break;
			case 13:
				document.getElementById("move12").focus();
				document.getElementById('move12').style.color = "#FB7299";
				document.getElementById('move12').style.backgroundColor = "#aaddff";
				document.getElementById('move11').style.backgroundColor = "#66ccff";
				document.getElementById('move11').style.color = "#000";
				break;
		}
	}
	function enter1() {
		switch (fh1) {
			case -1:
			case 0:
				hidder();
				break;
			case 1:
				if (document.getElementById('note1').checked == true) {
					var fh10 = document.getElementById('note1');
					fh10.checked = false;
				} else {
					var fh10 = document.getElementById('note1');
					fh10.checked = true;
				}
				break;
			case 2:
				if (document.getElementById('note2').checked == true) {
					var fh11 = document.getElementById('note2');
					fh11.checked = false;
				} else {
					var fh11 = document.getElementById('note2');
					fh11.checked = true;
				}
				break;
			case 3:
				if (document.getElementById('note3').checked == true) {
					var fh12 = document.getElementById('note3');
					fh12.checked = false;
				} else {
					var fh12 = document.getElementById('note3');
					fh12.checked = true;
				}
				break;
			case 4:
				if (document.getElementById('note4').checked == true) {
					var fh13 = document.getElementById('note4');
					fh13.checked = false;
				} else {
					var fh13 = document.getElementById('note4');
					fh13.checked = true;
				}
				break;
			case 5:
				if (document.getElementById('note5').checked == true) {
					var fh14 = document.getElementById('note5');
					fh14.checked = false;
				} else {
					var fh14 = document.getElementById('note5');
					fh14.checked = true;
				}
				break;
			case 6:
				if (document.getElementById('note6').checked == true) {
					var fh15 = document.getElementById('note6');
					fh15.checked = false;
				} else {
					var fh15 = document.getElementById('note6');
					fh15.checked = true;
				}
				break;
			case 7:
				if (document.getElementById('note7').checked == true) {
					var fh16 = document.getElementById('note7');
					fh16.checked = false;
				} else {
					var fh16 = document.getElementById('note7');
					fh16.checked = true;
				}
				break;
			case 8:
				fk1 = false;
				document.getElementById('warning').style.animation = 'warning_2 0.1s';
				document.getElementById('warning').style.width = '0%';
				document.getElementById('warning').style.height = '0px';
				document.getElementById('warning').style.left = '50%';
				warning.innerHTML = "";
				warnoff();
				break;
			case 9:
				if (document.getElementById('sound').checked == true) {
					var fh17 = document.getElementById('sound');
					fh17.checked = false;
				} else {
					var fh17 = document.getElementById('sound');
					fh17.checked = true;
				}
				break;
			case 13:
				if (document.getElementById('note8').checked == true) {
					var fh18 = document.getElementById('note8');
					fh18.checked = false;
				} else {
					var fh18 = document.getElementById('note8');
					fh18.checked = true;
				}
				break;
			case 14:
				if (document.getElementById('note9').checked == true) {
					var fh19 = document.getElementById('note9');
					fh19.checked = false;
				} else {
					var fh19 = document.getElementById('note9');
					fh19.checked = true;
				}
				break;
			case 15:
				hidder();
				break;
		}
	}
	function enter2() {
		switch (fi1) {
			case -1:
			case 0:
				hidder();
				break;
			case 1:
				hidder();
				break;
		}
	}
	function enter3() {
		switch (fj1) {
			case -1:
			case 0:
				hidder();
				break;
			case 1:
				zh_tran('s');
				break;
			case 2:
				zh_tran('t');
				break;
			case 3:
				hidder();
				break;
		}
	}
	function enter() {
		if (fa1 == 1 && fc1 == 2) {
			if (fk1 == false) {
				fk1 = true;
				lock();
			} else {
				fk1 = false;
				document.getElementById('warning').style.animation = 'warning_2 0.1s';
				document.getElementById('warning').style.width = '0%';
				document.getElementById('warning').style.height = '0px';
				document.getElementById('warning').style.left = '50%';
				warning.innerHTML = "";
				warnoff();
			}
		}
		if (fa1 == 2 && fd1 == 2) {
			if (fk1 == false) {
				fk1 = true;
				lock();
			} else {
				fk1 = false;
				document.getElementById('warning').style.animation = 'warning_2 0.1s';
				document.getElementById('warning').style.width = '0%';
				document.getElementById('warning').style.height = '0px';
				document.getElementById('warning').style.left = '50%';
				warning.innerHTML = "";
				warnoff();
			}
		}
		if (fa1 == 3) {
			document.getElementById("id22").focus();
		}
		switch (fb1) {
			case 1:
			case 2:
			case 3:
				if (fk1 == false) {
					fk1 = true;
					lock();
				} else {
					fk1 = false;
					document.getElementById('warning').style.animation = 'warning_2 0.1s';
					document.getElementById('warning').style.width = '0%';
					document.getElementById('warning').style.height = '0px';
					document.getElementById('warning').style.left = '50%';
					warning.innerHTML = "";
					warnoff();
				}
				break;
			case 4:
				if (fk1 == false) {
					fk1 = true;
					lock();
					document.getElementById("games").focus();
				} else {
					fk1 = false;
					document.getElementById('warning').style.animation = 'warning_2 0.1s';
					document.getElementById('warning').style.width = '0%';
					document.getElementById('warning').style.height = '0px';
					document.getElementById('warning').style.left = '50%';
					warning.innerHTML = "";
					warnoff();
					document.getElementById("move4").focus();
				}
				break;
			case 5:
				if (fk1 == false) {
					fk1 = true;
					lock();
					document.getElementById("key").focus();
				} else {
					fk1 = false;
					document.getElementById('warning').style.animation = 'warning_2 0.1s';
					document.getElementById('warning').style.width = '0%';
					document.getElementById('warning').style.height = '0px';
					document.getElementById('warning').style.left = '50%';
					warning.innerHTML = "";
					warnoff();
					document.getElementById("move5").focus();
				}
				break;
			case 6:
				if (document.getElementById('continue').checked == true) {
					var names = name.split(",")
					var inputs = document.getElementsByTagName('input')
					var id11 = 0;
					var id12 = 0;
					names[id12] === inputs[id11].id;
					inputs[id11].checked = false;
				} else {
					var names = name.split(",")
					var inputs = document.getElementsByTagName('input')
					var id11 = 0;
					var id12 = 0;
					names[id12] === inputs[id11].id;
					inputs[id11].checked = true;
				}
				break;
			case 7:
				if (document.getElementById('manual').checked == true) {
					var names = name.split(",")
					var inputs = document.getElementsByTagName('input')
					var id11 = 1;
					var id12 = 1;
					names[id12] === inputs[id11].id;
					inputs[id11].checked = false;
				} else {
					var names = name.split(",")
					var inputs = document.getElementsByTagName('input')
					var id11 = 1;
					var id12 = 1;
					names[id12] === inputs[id11].id;
					inputs[id11].checked = true;
				}
				break;
			case 8:
				note();
				fe1 = true;
				break;
			case 10:
				about();
				ff1 = true;
				break;
			case 11:
				isFull();
				break;
			case 12:
				id0();
				fg1 = true;
				break;
		}
	}
	//全屏部分
	var html = document.querySelector("html");
	function isFull() {
		if (document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement) {
			if (document.cancelFullscreen) {
				document.cancelFullscreen();
			} else if (document.webkitCancelFullScreen) {
				document.webkitCancelFullScreen();
			} else if (document.mozCancelFullScreen) {
				document.mozCancelFullScreen();
			} else if (document.msCancelFullScreen) {
				document.msCancelFullScreen();
			}
		} else {
			if (html.requestFullscreen) {
				html.requestFullscreen();
			} else if (html.webkitRequestFullScreen) {
				html.webkitRequestFullScreen();
			} else if (html.mozRequestFullScreen) {
				html.mozRequestFullScreen();
			} else if (html.msRequestFullScreen) {
				html.msRequestFullScreen();
			}
		}
	}
	var sound1 = 0;
	function soundup() {
		a = document.getElementById("result").value;
		//简写替换例如（例如d直接替换成#c）有可能导致转化混乱，故每一个音符逐一转换。虽然会使程序臃肿
		//midi最高音阶极限
		a = a.replace(/\/g6.mp3/g, "");
		a = a.replace(/\/#f6.mp3/g, "/g6.mp3");
		a = a.replace(/\/f6.mp3/g, "/#f6.mp3");
		a = a.replace(/\/e6.mp3/g, "/f6.mp3");
		a = a.replace(/\/#d6.mp3/g, "/e6.mp3");
		a = a.replace(/\/d6.mp3/g, "/#d6.mp3");
		a = a.replace(/\/#c6.mp3/g, "/d6.mp3");
		a = a.replace(/\/c6.mp3/g, "/#c6.mp3");
		a = a.replace(/\/b5.mp3/g, "/c6.mp3");
		a = a.replace(/\/#a5.mp3/g, "/b5.mp3");
		a = a.replace(/\/a5.mp3/g, "/#a5.mp3");
		a = a.replace(/\/#g5.mp3/g, "/a5.mp3");
		a = a.replace(/\/g5.mp3/g, "/#g5.mp3");
		a = a.replace(/\/#f5.mp3/g, "/g5.mp3");
		a = a.replace(/\/f5.mp3/g, "/#f5.mp3");
		a = a.replace(/\/e5.mp3/g, "/f5.mp3");
		a = a.replace(/\/#d5.mp3/g, "/e5.mp3");
		a = a.replace(/\/d5.mp3/g, "/#d5.mp3");
		a = a.replace(/\/#c5.mp3/g, "/d5.mp3");
		//正常的88个音阶的分界线
		a = a.replace(/\/c5.mp3/g, "/#c5.mp3");
		a = a.replace(/\/b4.mp3/g, "/c5.mp3");
		a = a.replace(/\/#a4.mp3/g, "/b4.mp3");
		a = a.replace(/\/a4.mp3/g, "/#a4.mp3");
		a = a.replace(/\/#g4.mp3/g, "/a4.mp3");
		a = a.replace(/\/g4.mp3/g, "/#g4.mp3");
		a = a.replace(/\/#f4.mp3/g, "/g4.mp3");
		a = a.replace(/\/f4.mp3/g, "/#f4.mp3");
		a = a.replace(/\/e4.mp3/g, "/f4.mp3");
		a = a.replace(/\/#d4.mp3/g, "/e4.mp3");
		a = a.replace(/\/d4.mp3/g, "/#d4.mp3");
		a = a.replace(/\/#c4.mp3/g, "/d4.mp3");
		a = a.replace(/\/c4.mp3/g, "/#c4.mp3");
		a = a.replace(/\/b3.mp3/g, "/c4.mp3");
		a = a.replace(/\/#a3.mp3/g, "/b3.mp3");
		a = a.replace(/\/a3.mp3/g, "/#a3.mp3");
		a = a.replace(/\/#g3.mp3/g, "/a3.mp3");
		a = a.replace(/\/g3.mp3/g, "/#g3.mp3");
		a = a.replace(/\/#f3.mp3/g, "/g3.mp3");
		a = a.replace(/\/f3.mp3/g, "/#f3.mp3");
		a = a.replace(/\/e3.mp3/g, "/f3.mp3");
		a = a.replace(/\/#d3.mp3/g, "/e3.mp3");
		a = a.replace(/\/d3.mp3/g, "/#d3.mp3");
		a = a.replace(/\/#c3.mp3/g, "/d3.mp3");
		a = a.replace(/\/c3.mp3/g, "/#c3.mp3");
		a = a.replace(/\/b2.mp3/g, "/c3.mp3");
		a = a.replace(/\/#a2.mp3/g, "/b2.mp3");
		a = a.replace(/\/a2.mp3/g, "/#a2.mp3");
		a = a.replace(/\/#g2.mp3/g, "/a2.mp3");
		a = a.replace(/\/g2.mp3/g, "/#g2.mp3");
		a = a.replace(/\/#f2.mp3/g, "/g2.mp3");
		a = a.replace(/\/f2.mp3/g, "/#f2.mp3");
		a = a.replace(/\/e2.mp3/g, "/f2.mp3");
		a = a.replace(/\/#d2.mp3/g, "/e2.mp3");
		a = a.replace(/\/d2.mp3/g, "/#d2.mp3");
		a = a.replace(/\/#c2.mp3/g, "/d2.mp3");
		a = a.replace(/\/c2.mp3/g, "/#c2.mp3");
		a = a.replace(/\/b1.mp3/g, "/c2.mp3");
		a = a.replace(/\/#a1.mp3/g, "/b1.mp3");
		a = a.replace(/\/a1.mp3/g, "/#a1.mp3");
		a = a.replace(/\/#g1.mp3/g, "/a1.mp3");
		a = a.replace(/\/g1.mp3/g, "/#g1.mp3");
		a = a.replace(/\/#f1.mp3/g, "/g1.mp3");
		a = a.replace(/\/f1.mp3/g, "/#f1.mp3");
		a = a.replace(/\/e1.mp3/g, "/f1.mp3");
		a = a.replace(/\/#d1.mp3/g, "/e1.mp3");
		a = a.replace(/\/d1.mp3/g, "/#d1.mp3");
		a = a.replace(/\/#c1.mp3/g, "/d1.mp3");
		a = a.replace(/\/c1.mp3/g, "/#c1.mp3");
		a = a.replace(/\/b.mp3/g, "/c1.mp3");
		a = a.replace(/\/#a.mp3/g, "/b.mp3");
		a = a.replace(/\/a.mp3/g, "/#a.mp3");
		a = a.replace(/\/#g.mp3/g, "/a.mp3");
		a = a.replace(/\/g.mp3/g, "/#g.mp3");
		a = a.replace(/\/#f.mp3/g, "/g.mp3");
		a = a.replace(/\/f.mp3/g, "/#f.mp3");
		a = a.replace(/\/e.mp3/g, "/f.mp3");
		a = a.replace(/\/#d.mp3/g, "/e.mp3");
		a = a.replace(/\/d.mp3/g, "/#d.mp3");
		a = a.replace(/\/#c.mp3/g, "/d.mp3");
		a = a.replace(/\/c.mp3/g, "/#c.mp3");
		a = a.replace(/\/B-1.mp3/g, "/c.mp3");
		a = a.replace(/\/#A-1.mp3/g, "/B-1.mp3");
		a = a.replace(/\/A-1.mp3/g, "/#A-1.mp3");
		a = a.replace(/\/#G-1.mp3/g, "/A-1.mp3");
		a = a.replace(/\/G-1.mp3/g, "/#G-1.mp3");
		a = a.replace(/\/#F-1.mp3/g, "/G-1.mp3");
		a = a.replace(/\/F-1.mp3/g, "/#F-1.mp3");
		a = a.replace(/\/E-1.mp3/g, "/F-1.mp3");
		a = a.replace(/\/#D-1.mp3/g, "/E-1.mp3");
		a = a.replace(/\/D-1.mp3/g, "/#D-1.mp3");
		a = a.replace(/\/#C-1.mp3/g, "/D-1.mp3");
		a = a.replace(/\/C-1.mp3/g, "/#C-1.mp3");
		a = a.replace(/\/B-2.mp3/g, "/C-1.mp3");
		a = a.replace(/\/#A-2.mp3/g, "/B-2.mp3");
		a = a.replace(/\/A-2.mp3/g, "/#A-2.mp3");
		a = a.replace(/\/#G-2.mp3/g, "/A-2.mp3");
		a = a.replace(/\/G-2.mp3/g, "/#G-2.mp3");
		a = a.replace(/\/#F-2.mp3/g, "/G-2.mp3");
		a = a.replace(/\/F-2.mp3/g, "/#F-2.mp3");
		a = a.replace(/\/E-2.mp3/g, "/F-2.mp3");
		a = a.replace(/\/#D-2.mp3/g, "/E-2.mp3");
		a = a.replace(/\/D-2.mp3/g, "/#D-2.mp3");
		a = a.replace(/\/#C-2.mp3/g, "/D-2.mp3");
		a = a.replace(/\/C-2.mp3/g, "/#C-2.mp3");
		a = a.replace(/\/B-3.mp3/g, "/C-2.mp3");
		a = a.replace(/\/#A-3.mp3/g, "/B-3.mp3");
		a = a.replace(/\/A-3.mp3/g, "/#A-3.mp3");
		//正常的88个音阶的分界线
		a = a.replace(/\/#G-3.mp3/g, "/A-3.mp3");
		a = a.replace(/\/G-3.mp3/g, "/#G-3.mp3");
		a = a.replace(/\/#F-3.mp3/g, "/G-3.mp3");
		a = a.replace(/\/F-3.mp3/g, "/#F-3.mp3");
		a = a.replace(/\/E-3.mp3/g, "/F-3.mp3");
		a = a.replace(/\/#D-3.mp3/g, "/E-3.mp3");
		a = a.replace(/\/D-3.mp3/g, "/#D-3.mp3");
		a = a.replace(/\/#C-3.mp3/g, "/D-3.mp3");
		a = a.replace(/\/C-3.mp3/g, "/#C-3.mp3");
		a = a.replace(/\/B-4.mp3/g, "/C-3.mp3");
		a = a.replace(/\/#A-4.mp3/g, "/B-4.mp3");
		a = a.replace(/\/A-4.mp3/g, "/#A-4.mp3");
		a = a.replace(/\/#G-4.mp3/g, "/A-4.mp3");
		a = a.replace(/\/G-4.mp3/g, "/#G-4.mp3");
		a = a.replace(/\/#F-4.mp3/g, "/G-4.mp3");
		a = a.replace(/\/F-4.mp3/g, "/#F-4.mp3");
		a = a.replace(/\/E-4.mp3/g, "/F-4.mp3");
		a = a.replace(/\/#D-4.mp3/g, "/E-4.mp3");
		a = a.replace(/\/D-4.mp3/g, "/#D-4.mp3");
		a = a.replace(/\/#C-4.mp3/g, "/D-4.mp3");
		a = a.replace(/\/C-4.mp3/g, "/#C-4.mp3");
		document.getElementById("result").value = a;
		sound1 = sound1 + 1;
		if (sound1 > 60) {
			sound1 = 60;
		}
		soundshow1();
	}
	function sounddown() {
		a = document.getElementById("result").value;
		//简写替换例如（例如d直接替换成#c）有可能导致转化混乱，故每一个音符逐一转换。虽然会使程序臃肿
		//midi最低音阶极限
		a = a.replace(/\/C-4.mp3/g, "");
		a = a.replace(/\/#C-4.mp3/g, "/C-4.mp3");
		a = a.replace(/\/D-4.mp3/g, "/#C-4.mp3");
		a = a.replace(/\/#D-4.mp3/g, "/D-4.mp3");
		a = a.replace(/\/E-4.mp3/g, "/#D-4.mp3");
		a = a.replace(/\/F-4.mp3/g, "/E-4.mp3");
		a = a.replace(/\/#F-4.mp3/g, "/F-4.mp3");
		a = a.replace(/\/G-4.mp3/g, "/#F-4.mp3");
		a = a.replace(/\/#G-4.mp3/g, "/G-4.mp3");
		a = a.replace(/\/A-4.mp3/g, "/#G-4.mp3");
		a = a.replace(/\/#A-4.mp3/g, "/A-4.mp3");
		a = a.replace(/\/B-4.mp3/g, "/#A-4.mp3");
		a = a.replace(/\/C-3.mp3/g, "/B-4.mp3");
		a = a.replace(/\/#C-3.mp3/g, "/C-3.mp3");
		a = a.replace(/\/D-3.mp3/g, "/#C-3.mp3");
		a = a.replace(/\/#D-3.mp3/g, "/D-3.mp3");
		a = a.replace(/\/E-3.mp3/g, "/#D-3.mp3");
		a = a.replace(/\/F-3.mp3/g, "/E-3.mp3");
		a = a.replace(/\/#F-3.mp3/g, "/F-3.mp3");
		a = a.replace(/\/G-3.mp3/g, "/#F-3.mp3");
		a = a.replace(/\/#G-3.mp3/g, "/G-3.mp3");
		//正常的88个音阶的分界线
		a = a.replace(/\/A-3.mp3/g, "/#G-3.mp3");
		a = a.replace(/\/#A-3.mp3/g, "/A-3.mp3");
		a = a.replace(/\/B-3.mp3/g, "/#A-3.mp3");
		a = a.replace(/\/C-2.mp3/g, "/B-3.mp3");
		a = a.replace(/\/#C-2.mp3/g, "/C-2.mp3");
		a = a.replace(/\/D-2.mp3/g, "/#C-2.mp3");
		a = a.replace(/\/#D-2.mp3/g, "/D-2.mp3");
		a = a.replace(/\/E-2.mp3/g, "/#D-2.mp3");
		a = a.replace(/\/F-2.mp3/g, "/E-2.mp3");
		a = a.replace(/\/#F-2.mp3/g, "/F-2.mp3");
		a = a.replace(/\/G-2.mp3/g, "/#F-2.mp3");
		a = a.replace(/\/#G-2.mp3/g, "/G-2.mp3");
		a = a.replace(/\/A-2.mp3/g, "/#G-2.mp3");
		a = a.replace(/\/#A-2.mp3/g, "/A-2.mp3");
		a = a.replace(/\/B-2.mp3/g, "/#A-2.mp3");
		a = a.replace(/\/C-1.mp3/g, "/B-2.mp3");
		a = a.replace(/\/#C-1.mp3/g, "/C-1.mp3");
		a = a.replace(/\/D-1.mp3/g, "/#C-1.mp3");
		a = a.replace(/\/#D-1.mp3/g, "/D-1.mp3");
		a = a.replace(/\/E-1.mp3/g, "/#D-1.mp3");
		a = a.replace(/\/F-1.mp3/g, "/E-1.mp3");
		a = a.replace(/\/#F-1.mp3/g, "/F-1.mp3");
		a = a.replace(/\/G-1.mp3/g, "/#F-1.mp3");
		a = a.replace(/\/#G-1.mp3/g, "/G-1.mp3");
		a = a.replace(/\/A-1.mp3/g, "/#G-1.mp3");
		a = a.replace(/\/#A-1.mp3/g, "/A-1.mp3");
		a = a.replace(/\/B-1.mp3/g, "/#A-1.mp3");
		a = a.replace(/\/c.mp3/g, "/B-1.mp3");
		a = a.replace(/\/#c.mp3/g, "/c.mp3");
		a = a.replace(/\/d.mp3/g, "/#c.mp3");
		a = a.replace(/\/#d.mp3/g, "/d.mp3");
		a = a.replace(/\/e.mp3/g, "/#d.mp3");
		a = a.replace(/\/f.mp3/g, "/e.mp3");
		a = a.replace(/\/#f.mp3/g, "/f.mp3");
		a = a.replace(/\/g.mp3/g, "/#f.mp3");
		a = a.replace(/\/#g.mp3/g, "/g.mp3");
		a = a.replace(/\/a.mp3/g, "/#g.mp3");
		a = a.replace(/\/#a.mp3/g, "/a.mp3");
		a = a.replace(/\/b.mp3/g, "/#a.mp3");
		a = a.replace(/\/c1.mp3/g, "/b.mp3");
		a = a.replace(/\/#c1.mp3/g, "/c1.mp3");
		a = a.replace(/\/d1.mp3/g, "/#c1.mp3");
		a = a.replace(/\/#d1.mp3/g, "/d1.mp3");
		a = a.replace(/\/e1.mp3/g, "/#d1.mp3");
		a = a.replace(/\/f1.mp3/g, "/e1.mp3");
		a = a.replace(/\/#f1.mp3/g, "/f1.mp3");
		a = a.replace(/\/g1.mp3/g, "/#f1.mp3");
		a = a.replace(/\/#g1.mp3/g, "/g1.mp3");
		a = a.replace(/\/a1.mp3/g, "/#g1.mp3");
		a = a.replace(/\/#a1.mp3/g, "/a1.mp3");
		a = a.replace(/\/b1.mp3/g, "/#a1.mp3");
		a = a.replace(/\/c2.mp3/g, "/b1.mp3");
		a = a.replace(/\/#c2.mp3/g, "/c2.mp3");
		a = a.replace(/\/d2.mp3/g, "/#c2.mp3");
		a = a.replace(/\/#d2.mp3/g, "/d2.mp3");
		a = a.replace(/\/e2.mp3/g, "/#d2.mp3");
		a = a.replace(/\/f2.mp3/g, "/e2.mp3");
		a = a.replace(/\/#f2.mp3/g, "/f2.mp3");
		a = a.replace(/\/g2.mp3/g, "/#f2.mp3");
		a = a.replace(/\/#g2.mp3/g, "/g2.mp3");
		a = a.replace(/\/a2.mp3/g, "/#g2.mp3");
		a = a.replace(/\/#a2.mp3/g, "/a2.mp3");
		a = a.replace(/\/b2.mp3/g, "/#a2.mp3");
		a = a.replace(/\/c3.mp3/g, "/b2.mp3");
		a = a.replace(/\/#c3.mp3/g, "/c3.mp3");
		a = a.replace(/\/d3.mp3/g, "/#c3.mp3");
		a = a.replace(/\/#d3.mp3/g, "/d3.mp3");
		a = a.replace(/\/e3.mp3/g, "/#d3.mp3");
		a = a.replace(/\/f3.mp3/g, "/e3.mp3");
		a = a.replace(/\/#f3.mp3/g, "/f3.mp3");
		a = a.replace(/\/g3.mp3/g, "/#f3.mp3");
		a = a.replace(/\/#g3.mp3/g, "/g3.mp3");
		a = a.replace(/\/a3.mp3/g, "/#g3.mp3");
		a = a.replace(/\/#a3.mp3/g, "/a3.mp3");
		a = a.replace(/\/b3.mp3/g, "/#a3.mp3");
		a = a.replace(/\/c4.mp3/g, "/b3.mp3");
		a = a.replace(/\/#c4.mp3/g, "/c4.mp3");
		a = a.replace(/\/d4.mp3/g, "/#c4.mp3");
		a = a.replace(/\/#d4.mp3/g, "/d4.mp3");
		a = a.replace(/\/e4.mp3/g, "/#d4.mp3");
		a = a.replace(/\/f4.mp3/g, "/e4.mp3");
		a = a.replace(/\/#f4.mp3/g, "/f4.mp3");
		a = a.replace(/\/g4.mp3/g, "/#f4.mp3");
		a = a.replace(/\/#g4.mp3/g, "/g4.mp3");
		a = a.replace(/\/a4.mp3/g, "/#g4.mp3");
		a = a.replace(/\/#a4.mp3/g, "/a4.mp3");
		a = a.replace(/\/b4.mp3/g, "/#a4.mp3");
		a = a.replace(/\/c5.mp3/g, "/b4.mp3");
		//正常的88个音阶的分界线
		a = a.replace(/\/#c5.mp3/g, "/c5.mp3");
		a = a.replace(/\/d5.mp3/g, "/#c5.mp3");
		a = a.replace(/\/#d5.mp3/g, "/d5.mp3");
		a = a.replace(/\/e5.mp3/g, "/#d5.mp3");
		a = a.replace(/\/f5.mp3/g, "/e5.mp3");
		a = a.replace(/\/#f5.mp3/g, "/f5.mp3");
		a = a.replace(/\/g5.mp3/g, "/#f5.mp3");
		a = a.replace(/\/#g5.mp3/g, "/g5.mp3");
		a = a.replace(/\/a5.mp3/g, "/#g5.mp3");
		a = a.replace(/\/#a5.mp3/g, "/a5.mp3");
		a = a.replace(/\/b5.mp3/g, "/#a5.mp3");
		a = a.replace(/\/c6.mp3/g, "/b5.mp3");
		a = a.replace(/\/#c6.mp3/g, "/c6.mp3");
		a = a.replace(/\/d6.mp3/g, "/#c6.mp3");
		a = a.replace(/\/#d6.mp3/g, "/d6.mp3");
		a = a.replace(/\/e6.mp3/g, "/#d6.mp3");
		a = a.replace(/\/f6.mp3/g, "/e6.mp3");
		a = a.replace(/\/#f6.mp3/g, "/f6.mp3");
		a = a.replace(/\/g6.mp3/g, "/#f6.mp3");
		//midi最高音阶极限
		document.getElementById("result").value = a;
		sound1 = sound1 - 1;
		if (sound1 < -60) {
			sound1 = -60;
		}
		soundshow1();
	}
	function soundshow1() {
		if (sound1 > 0) {
			soundshow.innerHTML = "▲音调升了" + sound1 + "个半音";
			document.getElementById('soundshow').style.color = '#00a1d6';
			document.getElementById("warning_sound").innerHTML = "♯*" + sound1 + "♩";
			document.getElementById("warning_sound").style.color = '#00a1d6';
		}
		if (sound1 == 0) {
			soundshow.innerHTML = "正常";
			document.getElementById('soundshow').style.color = '#555';
			document.getElementById("warning_sound").innerHTML = "♮正常";
			document.getElementById("warning_sound").style.color = '#555';
		}
		if (sound1 < 0) {
			sound2 = Math.abs(sound1);
			soundshow.innerHTML = "▼音调降了" + sound2 + "个半音";
			document.getElementById('soundshow').style.color = '#FB7299';
			document.getElementById("warning_sound").innerHTML = "♭*" + sound2 + "♩";
			document.getElementById("warning_sound").style.color = '#fb7299';
		}
		if (zh_choose == "t") {
			zh_tran('t');
		}
	}
	document.getElementById('vol').style.background = 'linear-gradient(to right, #32B0DA 0%, #32B0DA 100%,#eee 100%, #eee)';
	var vol1 = document.getElementById("vol").value;
	document.getElementById("volshow").innerHTML = vol1 + "%";
	function vol2() {
		var vol1 = document.getElementById("vol").value;
		document.getElementById("volshow").innerHTML = vol1 + "%";
		var vol3 = vol1 + "%";
		document.getElementById('vol').style.background = 'linear-gradient(to right, #32B0DA 0%, #32B0DA ' + vol3 + ',#eee ' + vol3 + ', #eee)';
		//鼠标移动
		window.onmousemove = function (movee) {
			note();
			return;
		}
	}
	//光标锁定
	function lock() {
		fk1 = true;
		document.getElementById('warning').style.display = 'inline';
		document.getElementById('warning').style.animation = 'warning_1 0.1s';
		document.getElementById('warning').style.width = '60%';
		document.getElementById('warning').style.height = 'auto';
		document.getElementById('warning').style.left = '20%';
		setTimeout(function () {
			warning.innerHTML = "<b>注意：焦点已锁定，如需进行其他地方的操作请再次按下确定键、菜单键或返回键，或点击此消息。</b>";
			if (zh_choose == "t") {
				zh_tran('t');
			}
		}, 100);
		sound3();
	}
	//操作系统识别
	var sUserAgent = navigator.userAgent;
	var isLinux = (String(navigator.platform).indexOf("Linux") > -1);
	var bIsAndroid = sUserAgent.toLowerCase().match(/android/i) == "android";
	//对苹果操作系统的识别
	var bIsMac = sUserAgent.toLowerCase().match(/Mac OS/i) == "mac os";
	var bIsiPhone = sUserAgent.toLowerCase().match(/iphone/i) == "iphone";
	var bIsiPod = sUserAgent.toLowerCase().match(/ipod/i) == "ipod";
	var bIsiPad = sUserAgent.toLowerCase().match(/ipad/i) == "ipad";
	var bIsWatch = sUserAgent.toLowerCase().match(/watch/i) == "watch";
	var bIsTV = sUserAgent.toLowerCase().match(/tv/i) == "tv";
	//Linux部分发行版的识别
	var bIsUbuntu = sUserAgent.toLowerCase().match(/ubuntu/i) == "ubuntu";
	var bIsDebian = sUserAgent.toLowerCase().match(/debian/i) == "debian";
	var bIsRHEL = sUserAgent.toLowerCase().match(/rhel/i) == "rhel";
	var bIsCentos = sUserAgent.toLowerCase().match(/centos/i) == "centos";
	var bIsSlackware = sUserAgent.toLowerCase().match(/slackware/i) == "slackware";
	var bIsArch = sUserAgent.toLowerCase().match(/arch/i) == "arch";
	var bIsKali = sUserAgent.toLowerCase().match(/kali/i) == "kali";
	var bIsUOS = sUserAgent.toLowerCase().match(/uos/i) == "uos";
	var bIsDeepin = sUserAgent.toLowerCase().match(/deepin/i) == "deepin";
	var bIsSUSE = sUserAgent.toLowerCase().match(/suse/i) == "suse";
	var bIsFedora = sUserAgent.toLowerCase().match(/fedora/i) == "fedora";
	var bIsMint = sUserAgent.toLowerCase().match(/mint/i) == "mint";
	var bIsMageia = sUserAgent.toLowerCase().match(/mageia/i) == "mageia";
	var bIsManjaro = sUserAgent.toLowerCase().match(/manjaro/i) == "manjaro";
	var bIsGentoo = sUserAgent.toLowerCase().match(/gentoo/i) == "gentoo";
	if (isLinux) {
		if (bIsAndroid) detectos.innerHTML = "Android";
		else if (bIsUbuntu) detectos.innerHTML = "Ubuntu";
		else if (bIsDebian) detectos.innerHTML = "Debian";
		else if (bIsRHEL) detectos.innerHTML = "RHEL";
		else if (bIsCentos) detectos.innerHTML = "Centos";
		else if (bIsSlackware) detectos.innerHTML = "Slackware";
		else if (bIsArch) detectos.innerHTML = "Arch Linux";
		else if (bIsKali) detectos.innerHTML = "Kali Linux";
		else if (bIsSUSE) detectos.innerHTML = "Open SUSE";
		else if (bIsFedora) detectos.innerHTML = "Fedora";
		else if (bIsMint) detectos.innerHTML = "Linux Mint";
		else if (bIsMageia) detectos.innerHTML = "Mageia";
		else if (bIsManjaro) detectos.innerHTML = "Manjaro";
		else if (bIsGentoo) detectos.innerHTML = "Gentoo";
		else if (bIsUOS) detectos.innerHTML = "China Unity Operating System";
		else if (bIsDeepin) detectos.innerHTML = "China Deepin";
		else if (bIsiPhone) detectos.innerHTML = "Apple iPhone Operating System";
		else if (bIsiPod) detectos.innerHTML = "Apple iPhone Operating System";
		else if (bIsiPad) detectos.innerHTML = "Apple iPad Operating System";
		else if (bIsWatch) detectos.innerHTML = "Apple Watch Operating System";
		else if (bIsTV) detectos.innerHTML = "Apple TV Operating System";
		else if (bIsMac) detectos.innerHTML = "Apple Mac OS X";
		else detectos.innerHTML = "GNU/Linux";
	}
	else detectos.innerHTML = "Unknown Unix";
	if (String(navigator.userAgent).indexOf("Windows") > -1) detectos.innerHTML = "Microsoft Windows";
	if (String(navigator.platform).indexOf("Harmony") > -1) detectos.innerHTML = "Huawei Harmony";
	if (String(navigator.platform).indexOf("Fuchsia") > -1) detectos.innerHTML = "Google Fuchsia";
	if (String(navigator.userAgent).indexOf("CrOS") > -1) detectos.innerHTML = "Google Chrome Operating System";
	if (String(navigator.userAgent).indexOf("Solaris") > -1) detectos.innerHTML = "Solaris";
	if (String(navigator.platform).indexOf("FreeBSD") > -1) detectos.innerHTML = "FreeBSD";
	if (String(navigator.platform).indexOf("OpenBSD") > -1) detectos.innerHTML = "OpenBSD";
	if (String(navigator.platform).indexOf("NetBSD") > -1) detectos.innerHTML = "NetBSD";
	if (String(navigator.platform).indexOf("Haiku") > -1) detectos.innerHTML = "Haiku";
	if (/Firefox\/(\S+)/.test(navigator.userAgent)) {
		explorer.innerHTML = "Mozilla Firefox";
	}
	if (!/OPR/.test(navigator.userAgent)) {
		if (/Chrome\/(\S+)/.test(navigator.userAgent)) {
			explorer.innerHTML = "Google Chrome";
		}
		if (/Safari/.test(navigator.userAgent)) {
			if (/Version\/(\S+)/.test(navigator.userAgent)) {
				explorer.innerHTML = "Apple Safari";
			}
		}
	} else {
		explorer.innerHTML = "Opera";
	}
	if (/Edg\/(\S+)/.test(navigator.userAgent)) {
		explorer.innerHTML = "Microsoft Edge";
	}
	var agent = navigator.userAgent.toLowerCase();
	var isChrome = /chrome|crios/.test(agent) && ! /edge|opr\//.test(agent);
	var isBrave = isChrome && window.navigator.plugins.length === 0 && window.navigator.mimeTypes.length === 0;
	if (isBrave) {
		explorer.innerHTML = "Brave";
	}
	//禁止Windows10以下的系统访问此脚本
	if (String(navigator.userAgent).indexOf("Win95") > -1 || String(navigator.userAgent).indexOf("Win98") > -1 || String(navigator.userAgent).indexOf("Win 9x 4.90") > -1 || String(navigator.userAgent).indexOf("Windows NT 5") > -1 || String(navigator.userAgent).indexOf("Windows NT 6") > -1) {
		document.body.innerHTML = '';
		alert("警告！请升级你的 Windows 操作系统至 Windows 10 以上或转移其他的现代操作系统访问此脚本！");
	}
	//禁止Android5以下的系统访问此脚本
	if (String(navigator.userAgent).indexOf("Android 1.") > -1 || String(navigator.userAgent).indexOf("Android 2.") > -1 || String(navigator.userAgent).indexOf("Android 3.") > -1 || String(navigator.userAgent).indexOf("Android 4.") > -1 && String(navigator.userAgent).indexOf("Windows") == -1) {
		document.body.innerHTML = '';
		alert("警告！请升级你的 Android 操作系统至 Android 5 以上或使用其他设备访问此脚本！");
	}
	//禁止iOS10以下的系统访问此脚本
	if (String(navigator.userAgent).indexOf("OS 1_") > -1 || String(navigator.userAgent).indexOf("OS 2_") > -1 || String(navigator.userAgent).indexOf("OS 3_") > -1 || String(navigator.userAgent).indexOf("OS 4_") > -1 || String(navigator.userAgent).indexOf("OS 5_") > -1 || String(navigator.userAgent).indexOf("OS 6_") > -1 || String(navigator.userAgent).indexOf("OS 7_") > -1 || String(navigator.userAgent).indexOf("OS 8_") > -1 || String(navigator.userAgent).indexOf("OS 9_") > -1 && String(navigator.userAgent).indexOf("iPhone") > -1 && String(navigator.userAgent).indexOf("iPad") > -1) {
		document.body.innerHTML = '';
		alert("警告！请升级你的 iOS 操作系统至 iOS 10 以上或使用其他设备访问此脚本！");
	}
	//禁止Mac OS 10.11以下的系统访问此脚本
	if (String(navigator.userAgent).indexOf("10_0_") > -1 || String(navigator.userAgent).indexOf("10_1_") > -1 || String(navigator.userAgent).indexOf("10_2_") > -1 || String(navigator.userAgent).indexOf("10_3_") > -1 || String(navigator.userAgent).indexOf("10_4_") > -1 || String(navigator.userAgent).indexOf("10_5_") > -1 || String(navigator.userAgent).indexOf("10_6_") > -1 || String(navigator.userAgent).indexOf("10_7_") > -1 || String(navigator.userAgent).indexOf("10_8_") > -1 || String(navigator.userAgent).indexOf("10_9_") > -1 || String(navigator.userAgent).indexOf("10_10_") > -1) {
		if (String(navigator.userAgent).indexOf("iPhone") == -1 && String(navigator.userAgent).indexOf("iPad") == -1 && String(navigator.userAgent).indexOf("Mac OS") > -1) {
			document.body.innerHTML = '';
			alert("警告！请升级你的 Mac OS X 操作系统至 Mac OS X 10.11 以上或使用其他设备访问此脚本！");
		}
	}
	//禁用IE浏览器
	if (String(navigator.userAgent).indexOf("Trident") > -1) {
		alert("警告！请更新或使用 Chrome、Chromium、Firefox、Edge、Safari、Opera、Brave 等现代浏览器打开HTML文件！已禁用 Internet Explorer 浏览器访问此脚本！");
		document.location("about:blank");
	};
	windowmax = false;
	function window_max() {
		if (windowmax == false) {
			windowmax = true;
			view_window();
			boxmax2.innerHTML = '<b style="z-index: 1;">□</b><div style="z-index: 2;background:#fff;height:11px;width: 11px;position: absolute;top:9px;right: 14px;"></div><b class="boxmax1">□</b>';
			document.getElementById('view_window').style.width = '100%';
			document.getElementById('view_window').style.height = '100%';
			document.getElementById('view_window').style.left = '0px';
			document.getElementById('view_window').style.top = '0px';
			document.getElementById('view_window').style.borderRadius = '0px 0px 0px 0px';
		} else {
			windowmax = false;
			view_window();
			boxmax2.innerHTML = '□';
			document.getElementById('view_window').style.width = '60%';
			document.getElementById('view_window').style.height = '60%';
			document.getElementById('view_window').style.left = '20%';
			document.getElementById('view_window').style.top = '20%';
			document.getElementById('view_window').style.borderRadius = '5px 5px 0px 0px';
		}
	}
	bodywidthtest();
	function key_select() {
		games_type = games.value;
		switch (games_type) {
			case "mak":
				document.getElementById('key').innerHTML = '<option value="4k" class="button2">4Key</option ><option value="5k" class="button1"> 5Key</option><option value="6k" class="button2"> 6Key</option><option value="7k" class="button1">7Key</option><option value="8k" class="button2">8Key</option><option value="9k" class="button1">9Key</option><option value="10k" class="button2">10Key</option>'
				break;
			case "mas":
				document.getElementById('key').innerHTML = '<option class="button2">轨道选择不适用</option >'
				break;
			case "om":
				document.getElementById('key').innerHTML = '<option value="1k" class="button1">1Key</option ><option value="2k" class="button2">2Key</option ><option value="3k" class="button1">3Key</option ><option value="4k" class="button2">4Key</option ><option value="5k" class="button1"> 5Key</option><option value="6k" class="button2"> 6Key</option><option value="7k" class="button1">7Key</option><option value="8k" class="button2">8Key</option><option value="9k" class="button1">9Key</option><option value="10k" class="button2">10Key(coop)</option><option value="11k" class="button1">11Key(coop)</option><option value="12k" class="button2">12Key(coop)</option><option value="13k" class="button1">13Key(coop)</option><option value="14k" class="button2">14Key(coop)</option><option value="15k" class="button1">15Key(coop)</option><option value="16k" class="button2">16Key(coop)</option><option value="17k" class="button1">17Key(coop)</option><option value="18k" class="button2">18Key(coop)</option>'
				break;
		}
	}
	//适应不同设备或窗口规格
	function bodywidthtest() {
		if (window.screen.height < 500 || window.screen.width < 500) {
			document.getElementById('bodyid').style.overflowY = "auto";
		} else {
			document.getElementById('bodyid').style.overflowY = "hidden";
		}
		if (document.body.clientWidth < 400) {
			document.getElementById("progress3").style.marginLeft = "-25%";
		}
		if (document.body.clientWidth < 482 && document.body.clientWidth > 400) {
			document.getElementById("progress3").style.marginLeft = "-20%";
		}
		if (document.body.clientWidth > 482 && document.body.clientWidth < 550) {
			document.getElementById("progress3").style.marginLeft = "-15%";
		}
		if (document.body.clientWidth > 550 && document.body.clientWidth < 650) {
			document.getElementById("progress3").style.marginLeft = "-10%";
		}
		if (document.body.clientWidth > 650 && document.body.clientWidth < 720) {
			document.getElementById("progress3").style.marginLeft = "-8%";
		}
		if (document.body.clientWidth > 720 && document.body.clientWidth < 820) {
			document.getElementById("progress3").style.marginLeft = "-6%";
		}
		if (document.body.clientWidth > 820) {
			document.getElementById("progress3").style.marginLeft = "-5%";
		}
		if (document.body.clientWidth > 482) {
			document.getElementById("title").style.fontSize = "20px";
		} else {
			document.getElementById("title").style.fontSize = "";
		}
		setTimeout(function () { bodywidthtest(); }, 200);
	}
	explore.innerHTML = navigator.userAgent;

	//感谢https://www.zhangxinxu.com/wordpress/2017/06/html5-web-audio-api-js-ux-voice/网站给声音加载代码带来了参考
	//以后会使用这段代码进行midi音频播放
	window.AudioContext = window.AudioContext || window.webkitAudioContext;
	(function () {
		if (!window.AudioContext) {
			alert('警告！当前浏览器不支持Web Audio API，请使用Chrome、Chromium、Firefox、Edge、Safari、Opera 等现代浏览器打开HTML文件！已禁用此浏览器访问此脚本！');
			document.location("about:blank");
			return;
		}
		// 按钮元素
		var eleButton = document.getElementById('vol');
		// 音调依次递增或者递减处理需要的参数
		eleButton.addEventListener('mouseup', sound3);
		eleButton.addEventListener('keyup', sound3);
		eleButton.addEventListener('touchend', sound3);
	})();
	function sound3() {
		// 创建新的音频上下文接口
		var audioCtx = new AudioContext();
		// 发出的声音频率数据，表现为音调的高低
		var arrFrequency = [440.00];
		var start = 0, direction = 1;
		// 当前频率
		var frequency = arrFrequency[start];
		// 如果到头，改变音调的变化规则（增减切换）
		if (!frequency) {
			direction = -1 * direction;
			start = start + 2 * direction;
			frequency = arrFrequency[start];
		}
		start = start + direction;
		// 创建一个OscillatorNode, 它表示一个周期性波形（振荡），基本上来说创造了一个音调
		var oscillator = audioCtx.createOscillator();
		// 创建一个GainNode,它可以控制音频的总音量
		var gainNode = audioCtx.createGain();
		// 把音量，音调和终节点进行关联
		oscillator.connect(gainNode);
		// audioCtx.destination返回AudioDestinationNode对象，表示当前audio context中所有节点的最终节点，一般表示音频渲染设备
		gainNode.connect(audioCtx.destination);
		// 指定音调的类型，其他还有square|triangle|sawtooth
		oscillator.type = 'sine';
		vol4 = document.getElementById("vol").value / 100;
		// 音量为1
		gainNode.gain.linearRampToValueAtTime(vol4, audioCtx.currentTime);
		// 音调从当前时间开始播放
		oscillator.start(audioCtx.currentTime);
		// 1秒内声音慢慢降低，是个不错的停止声音的方法
		gainNode.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 1);
		// 1秒后完全停止声音
		oscillator.stop(audioCtx.currentTime + 1);
	}
	function warnoff() {
		sound3();
		setTimeout(function () { document.getElementById('warning').style.display = "none"; }, 100);
	}
	function progressoff() {
		document.getElementById('progress').style.animation = 'warning_3 0.1s';
		setTimeout(function () { document.getElementById('progress').style.display = 'none'; }, 100);
		document.getElementById('progress').style.width = '0%';
		document.getElementById('progress').style.height = '0px';
		document.getElementById('progress').style.left = '50%';
		document.getElementById('progress3').style.display = 'none'
		sound3();
	}
	//保存文件
	function outputfile(){
		games_type = games.value;
		switch (games_type) {
			case "mak":
			case "mas":
			saveAs(new Blob([document.getElementById('result').value],{
				type:'text/plain;charset=utf-8'
			}),`${Date.now()}.mc`)
				break;
			case "om":
			saveAs(new Blob([document.getElementById('result').value],{
				type:'text/plain;charset=utf-8'
			}),`${Date.now()}.osu`)
				break;
		}

		
	}
/*保存文件使用 FileSaver.js，注释已翻译，尊重此作者的劳动成果
*这里是saveAs()函数的代码块，以实现文件保存
*作者信息：
* By Eli Grey, http://eligrey.com
*
* License : https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md (MIT) （许可证）
* source  : http://purl.eligrey.com/github/FileSaver.js （脚本来源）
*/
//想了解JavaScript如何获取全局对象，请点击下面注释链接
// https://stackoverflow.com/q/3277182/1008999
var _global = typeof window === 'object' && window.window === window
  ? window : typeof self === 'object' && self.self === self
  ? self : typeof global === 'object' && global.global === global
  ? global
  : this

function bom (blob, opts) {
  if (typeof opts === 'undefined') opts = { autoBom: false }
  else if (typeof opts !== 'object') {
    console.warn('Deprecated: Expected third argument to be a object')
    opts = { autoBom: !opts }
  }

  //为UTF-8、XML和其他文本类型（包括HTML）添加BOM
  //注意：你的浏览器将自动转换UTF-16 U+FEFF到EF BB BF
  if (opts.autoBom && /^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(blob.type)) {
    return new Blob([String.fromCharCode(0xFEFF), blob], { type: blob.type })
  }
  return blob
}

function download (url, name, opts) {
  var xhr = new XMLHttpRequest()
  xhr.open('GET', url)
  xhr.responseType = 'blob'
  xhr.onload = function () {
    saveAs(xhr.response, name, opts)
  }
  xhr.onerror = function () {
    console.error('could not download file')
  }
  xhr.send()
}

function corsEnabled (url) {
  var xhr = new XMLHttpRequest()
  //使用sync数据同步避免下载弹窗阻止脚本继续执行
  xhr.open('HEAD', url, false)
  try {
    xhr.send()
  } catch (e) {}
  return xhr.status >= 200 && xhr.status <= 299
}

// a.click()不适用于所有浏览器(#465)
function click (node) {
  try {
    node.dispatchEvent(new MouseEvent('click'))
  } catch (e) {
    var evt = document.createEvent('MouseEvents')
    evt.initMouseEvent('click', true, true, window, 0, 0, 0, 80,
                          20, false, false, false, false, 0, null)
    node.dispatchEvent(evt)
  }
}

var saveAs = _global.saveAs || (
  //这段代码可能适用在某些浏览器工作上
  (typeof window !== 'object' || window !== _global)
    ? function saveAs () { /*空操作*/ }

  // 如果可能，首先使用其下载属性（#193（诺基亚Lumia手机……啊这……）） 
  : 'download' in HTMLAnchorElement.prototype
  ? function saveAs (blob, name, opts) {
    var URL = _global.URL || _global.webkitURL
    var a = document.createElement('a')
    name = name || blob.name || 'download'

    a.download = name
    a.rel = 'noopener' //tabnabbing（钓鱼标签，想了解自行搜索）

    //检测chrome浏览器的扩展和打包应用程序
    // a.target = '_blank'

    if (typeof blob === 'string') {
      //支持常规链接 
      a.href = blob
      if (a.origin !== location.origin) {
        corsEnabled(a.href)
          ? download(blob, name, opts)
          : click(a, a.target = '_blank')
      } else {
        click(a)
      }
    } else {
      //使用blob接口
      a.href = URL.createObjectURL(blob)
      setTimeout(function () { URL.revokeObjectURL(a.href) }, 4E4) //延迟40秒后执行
      setTimeout(function () { click(a) }, 0)
    }
  }

  //使用msSaveOrOpenBlob作为第二种方法 
  : 'msSaveOrOpenBlob' in navigator
  ? function saveAs (blob, name, opts) {
    name = name || blob.name || 'download'

    if (typeof blob === 'string') {
      if (corsEnabled(blob)) {
        download(blob, name, opts)
      } else {
        var a = document.createElement('a')
        a.href = blob
        a.target = '_blank'
        setTimeout(function () { click(a) })
      }
    } else {
      navigator.msSaveOrOpenBlob(bom(blob, opts), name)
    }
  }

  //退回到使用FileReader和弹出窗口
  : function saveAs (blob, name, opts, popup) {
    //立即打开弹窗，跳过弹窗拦截
    //大多数情况下仅在用户交互时可用，并且fileReader是异步的，因此……（啥？）
    popup = popup || open('', '_blank')
    if (popup) {
      popup.document.title =
      popup.document.body.innerText = 'downloading...'
    }

    if (typeof blob === 'string') return download(blob, name, opts)

    var force = blob.type === 'application/octet-stream'
    var isSafari = /constructor/i.test(_global.HTMLElement) || _global.safari
    var isChromeIOS = /CriOS\/[\d]+/.test(navigator.userAgent)

    if ((isChromeIOS || (force && isSafari)) && typeof FileReader !== 'undefined') {
      //Safari不允许下载blob URL（苹果……）
      var reader = new FileReader()
      reader.onloadend = function () {
        var url = reader.result
        url = isChromeIOS ? url : url.replace(/^data:[^;]*;/, 'data:attachment/file;')
        if (popup) popup.location.href = url
        else location = url
        popup = null //反向tabnabbing(#460)
      }
      reader.readAsDataURL(blob)
    } else {
      var URL = _global.URL || _global.webkitURL
      var url = URL.createObjectURL(blob)
      if (popup) popup.location = url
      else location.href = url
      popup = null //反向tabnabbing(#460)
      setTimeout(function () { URL.revokeObjectURL(url) }, 4E4)//延迟40秒后执行
    }
  }
)

_global.saveAs = saveAs.saveAs = saveAs

if (typeof module !== 'undefined') {
  module.exports = saveAs;
}
</script>
